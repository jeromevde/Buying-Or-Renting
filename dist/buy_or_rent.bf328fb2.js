!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("HyperFormula",[],t):"object"==typeof exports?exports.HyperFormula=t():e.HyperFormula=t()}("undefined"!=typeof self?self:this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,(function(t){return e[t]}).bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(1);t.ArraySize=n.ArraySize;var i=r(73);t.CellError=i.CellError,t.CellType=i.CellType,t.CellValueDetailedType=i.CellValueDetailedType,t.CellValueType=i.CellValueType,t.ErrorType=i.ErrorType;var a=r(170);t.DetailedCellError=a.DetailedCellError;var s=r(171),o=r(175);t.AlwaysDense=o.AlwaysDense,t.AlwaysSparse=o.AlwaysSparse,t.DenseSparseChooseBasedOnThreshold=o.DenseSparseChooseBasedOnThreshold;var u=r(147);t.ConfigValueTooBigError=u.ConfigValueTooBigError,t.ConfigValueTooSmallError=u.ConfigValueTooSmallError,t.EvaluationSuspendedError=u.EvaluationSuspendedError,t.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,t.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,t.FunctionPluginValidationError=u.FunctionPluginValidationError,t.InvalidAddressError=u.InvalidAddressError,t.InvalidArgumentsError=u.InvalidArgumentsError,t.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,t.LanguageNotRegisteredError=u.LanguageNotRegisteredError,t.MissingTranslationError=u.MissingTranslationError,t.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,t.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,t.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,t.NoOperationToRedoError=u.NoOperationToRedoError,t.NoOperationToUndoError=u.NoOperationToUndoError,t.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,t.NoSheetWithIdError=u.NoSheetWithIdError,t.NoSheetWithNameError=u.NoSheetWithNameError,t.NotAFormulaError=u.NotAFormulaError,t.NothingToPasteError=u.NothingToPasteError,t.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,t.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,t.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,t.SourceLocationHasArrayError=u.SourceLocationHasArrayError,t.TargetLocationHasArrayError=u.TargetLocationHasArrayError,t.UnableToParseError=u.UnableToParseError;var l=r(198);t.ExportedCellChange=l.ExportedCellChange,t.ExportedNamedExpressionChange=l.ExportedNamedExpressionChange;var c=r(180);t.HyperFormula=c.HyperFormula;var h,d=(h=r(216))&&h.__esModule?h:{default:h},p=r(166);t.FunctionPlugin=p.FunctionPlugin,t.FunctionArgumentType=p.FunctionArgumentType,t.EmptyValue=p.EmptyValue;var m=function(e,t){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var r=f(void 0);if(r&&r.has(e))return r.get(e);var n={__proto__:null},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&({}).hasOwnProperty.call(e,a)){var s=i?Object.getOwnPropertyDescriptor(e,a):null;s&&(s.get||s.set)?Object.defineProperty(n,a,s):n[a]=e[a]}return n.default=e,r&&r.set(e,n),n}(r(217)),g=r(139);function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,r=new WeakMap;return(f=function(e){return e?r:t})(e)}t.SimpleRangeValue=g.SimpleRangeValue;class E extends c.HyperFormula{}E.HyperFormula=c.HyperFormula,E.ErrorType=i.ErrorType,E.CellError=i.CellError,E.CellType=i.CellType,E.CellValueType=i.CellValueType,E.CellValueDetailedType=i.CellValueDetailedType,E.DetailedCellError=a.DetailedCellError,E.ExportedCellChange=l.ExportedCellChange,E.ExportedNamedExpressionChange=l.ExportedNamedExpressionChange,E.ConfigValueTooBigError=u.ConfigValueTooBigError,E.ConfigValueTooSmallError=u.ConfigValueTooSmallError,E.EvaluationSuspendedError=u.EvaluationSuspendedError,E.ExpectedOneOfValuesError=u.ExpectedOneOfValuesError,E.ExpectedValueOfTypeError=u.ExpectedValueOfTypeError,E.ArraySize=n.ArraySize,E.SimpleRangeValue=g.SimpleRangeValue,E.EmptyValue=p.EmptyValue,E.FunctionPlugin=p.FunctionPlugin,E.FunctionArgumentType=p.FunctionArgumentType,E.FunctionPluginValidationError=u.FunctionPluginValidationError,E.InvalidAddressError=u.InvalidAddressError,E.InvalidArgumentsError=u.InvalidArgumentsError,E.LanguageNotRegisteredError=u.LanguageNotRegisteredError,E.LanguageAlreadyRegisteredError=u.LanguageAlreadyRegisteredError,E.MissingTranslationError=u.MissingTranslationError,E.NamedExpressionDoesNotExistError=u.NamedExpressionDoesNotExistError,E.NamedExpressionNameIsAlreadyTakenError=u.NamedExpressionNameIsAlreadyTakenError,E.NamedExpressionNameIsInvalidError=u.NamedExpressionNameIsInvalidError,E.NoOperationToRedoError=u.NoOperationToRedoError,E.NoOperationToUndoError=u.NoOperationToUndoError,E.NoRelativeAddressesAllowedError=u.NoRelativeAddressesAllowedError,E.NoSheetWithIdError=u.NoSheetWithIdError,E.NoSheetWithNameError=u.NoSheetWithNameError,E.NotAFormulaError=u.NotAFormulaError,E.NothingToPasteError=u.NothingToPasteError,E.ProtectedFunctionTranslationError=u.ProtectedFunctionTranslationError,E.SheetNameAlreadyTakenError=u.SheetNameAlreadyTakenError,E.SheetSizeLimitExceededError=u.SheetSizeLimitExceededError,E.SourceLocationHasArrayError=u.SourceLocationHasArrayError,E.TargetLocationHasArrayError=u.TargetLocationHasArrayError,E.UnableToParseError=u.UnableToParseError;let T=s.Config.defaultConfig.language;for(let e of(c.HyperFormula.registerLanguage(T,d.default),c.HyperFormula.languages[d.default.langCode]=d.default,Object.getOwnPropertyNames(m)))e.startsWith("_")||c.HyperFormula.registerFunctionPlugin(m[e]);t.default=E},function(e,t,r){"use strict";t.__esModule=!0,t.ArraySizePredictor=t.ArraySize=void 0,r(2);var n=r(72),i=r(165),a=r(166),s=r(77);class o{constructor(e,t,r=!1){this.width=e,this.height=t,this.isRef=r}static error(){return new o(1,1,!0)}static scalar(){return new o(1,1,!1)}isScalar(){return 1===this.width&&1===this.height||this.isRef}}t.ArraySize=o,t.ArraySizePredictor=class{constructor(e,t){this.config=e,this.functionRegistry=t}checkArraySize(e,t){return this.checkArraySizeForAst(e,{formulaAddress:t,arraysFlag:this.config.useArrayArithmetic})}checkArraySizeForAst(e,t){switch(e.type){case s.AstNodeType.FUNCTION_CALL:return this.checkArraySizeForFunction(e,t);case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:{let r=n.AbsoluteCellRange.fromAstOrUndef(e,t.formulaAddress);return void 0===r?o.error():new o(r.width(),r.height(),!0)}case s.AstNodeType.ARRAY:{let r=[],n=[];for(let i of e.args){let e=i.map(e=>this.checkArraySizeForAst(e,t)),a=Math.min(...e.map(e=>e.height)),s=e.reduce((e,t)=>e+t.width,0);r.push(a),n.push(s)}return new o(Math.min(...n),r.reduce((e,t)=>e+t,0))}case s.AstNodeType.STRING:case s.AstNodeType.NUMBER:return o.scalar();case s.AstNodeType.CELL_REFERENCE:return new o(1,1,!0);case s.AstNodeType.DIV_OP:case s.AstNodeType.CONCATENATE_OP:case s.AstNodeType.EQUALS_OP:case s.AstNodeType.GREATER_THAN_OP:case s.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case s.AstNodeType.LESS_THAN_OP:case s.AstNodeType.LESS_THAN_OR_EQUAL_OP:case s.AstNodeType.MINUS_OP:case s.AstNodeType.NOT_EQUAL_OP:case s.AstNodeType.PLUS_OP:case s.AstNodeType.POWER_OP:case s.AstNodeType.TIMES_OP:{let r=this.checkArraySizeForAst(e.left,t),n=this.checkArraySizeForAst(e.right,t);return!t.arraysFlag&&(r.height>1||r.width>1||n.height>1||n.width>1)?o.error():new o(Math.max(r.width,n.width),Math.max(r.height,n.height))}case s.AstNodeType.MINUS_UNARY_OP:case s.AstNodeType.PLUS_UNARY_OP:case s.AstNodeType.PERCENT_OP:{let r=this.checkArraySizeForAst(e.value,t);return!t.arraysFlag&&(r.height>1||r.width>1)?o.error():new o(r.width,r.height)}case s.AstNodeType.PARENTHESIS:return this.checkArraySizeForAst(e.expression,t);case s.AstNodeType.EMPTY:default:return o.error()}}checkArraySizeForFunction(e,t){let r=this.functionRegistry.getArraySizeFunction(e.procedureName);if(void 0!==r)return r(e,t);let n=this.functionRegistry.getMetadata(e.procedureName);if(void 0===n||n.expandRanges||!t.arraysFlag||n.vectorizationForbidden||void 0===n.parameters)return new o(1,1);let s=e.args.map(e=>{var r;return this.checkArraySizeForAst(e,new i.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(r=null==n?void 0:n.arrayFunction)&&r))}),u=[...n.parameters];if(void 0!==n.repeatLastArgs&&u.length<s.length&&(s.length-u.length)%n.repeatLastArgs!=0)return o.error();for(;u.length<s.length;){if(void 0===n.repeatLastArgs)return o.error();u.push(...u.slice(u.length-n.repeatLastArgs))}let l=1,c=1;for(let e=0;e<s.length;e++)u[e].argumentType!==a.FunctionArgumentType.RANGE&&u[e].argumentType!==a.FunctionArgumentType.ANY&&(c=Math.max(c,s[e].height),l=Math.max(l,s[e].width));return new o(l,c)}}},function(e,t,r){"use strict";var n=r(3),i=r(40),a=r(64),s=r(69),o=r(71);n({target:"Array",proto:!0,arity:1,forced:r(8)(function(){return 0x100000001!==[].push.call({length:0x100000000},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=i(this),r=a(t),n=arguments.length;o(r+n);for(var u=0;u<n;u++)t[r]=arguments[u],r++;return s(t,r),r}})},function(e,t,r){"use strict";var n=r(4),i=r(6).f,a=r(44),s=r(48),o=r(38),u=r(56),l=r(68);e.exports=function(e,t){var r,c,h,d,p,m=e.target,g=e.global,f=e.stat;if(r=g?n:f?n[m]||o(m,{}):n[m]&&n[m].prototype)for(c in t){if(d=t[c],h=e.dontCallGetSet?(p=i(r,c))&&p.value:r[c],!l(g?c:m+(f?".":"#")+c,e.forced)&&void 0!==h){if(typeof d==typeof h)continue;u(d,h)}(e.sham||h&&h.sham)&&a(d,"sham",!0),s(r,c,d,e)}}},function(e,t,r){"use strict";(function(t){var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof t&&t)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()}).call(this,r(5))},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";var n=r(7),i=r(9),a=r(11),s=r(12),o=r(13),u=r(19),l=r(39),c=r(42),h=Object.getOwnPropertyDescriptor;t.f=n?h:function(e,t){if(e=o(e),t=u(t),c)try{return h(e,t)}catch(e){}if(l(e,t))return s(!i(a.f,e,t),e[t])}},function(e,t,r){"use strict";e.exports=!r(8)(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},function(e,t,r){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,r){"use strict";var n=r(10),i=Function.prototype.call;e.exports=n?i.bind(i):function(){return i.apply(i,arguments)}},function(e,t,r){"use strict";e.exports=!r(8)(function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},function(e,t,r){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor;t.f=i&&!n.call({1:2},1)?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t,r){"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){"use strict";var n=r(14),i=r(17);e.exports=function(e){return n(i(e))}},function(e,t,r){"use strict";var n=r(15),i=r(8),a=r(16),s=Object,o=n("".split);e.exports=i(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"===a(e)?o(e,""):s(e)}:s},function(e,t,r){"use strict";var n=r(10),i=Function.prototype,a=i.call,s=n&&i.bind.bind(a,a);e.exports=n?s:function(e){return function(){return a.apply(e,arguments)}}},function(e,t,r){"use strict";var n=r(15),i=n({}.toString),a=n("".slice);e.exports=function(e){return a(i(e),8,-1)}},function(e,t,r){"use strict";var n=r(18),i=TypeError;e.exports=function(e){if(n(e))throw new i("Can't call method on "+e);return e}},function(e,t,r){"use strict";e.exports=function(e){return null==e}},function(e,t,r){"use strict";var n=r(20),i=r(23);e.exports=function(e){var t=n(e,"string");return i(t)?t:t+""}},function(e,t,r){"use strict";var n=r(9),i=r(21),a=r(23),s=r(30),o=r(33),u=r(34),l=TypeError,c=u("toPrimitive");e.exports=function(e,t){if(!i(e)||a(e))return e;var r,u=s(e,c);if(u){if(void 0===t&&(t="default"),!i(r=n(u,e,t))||a(r))return r;throw new l("Can't convert object to primitive value")}return void 0===t&&(t="number"),o(e,t)}},function(e,t,r){"use strict";var n=r(22);e.exports=function(e){return"object"==typeof e?null!==e:n(e)}},function(e,t,r){"use strict";var n="object"==typeof document&&document.all;e.exports=void 0===n&&void 0!==n?function(e){return"function"==typeof e||e===n}:function(e){return"function"==typeof e}},function(e,t,r){"use strict";var n=r(24),i=r(22),a=r(25),s=r(26),o=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=n("Symbol");return i(t)&&a(t.prototype,o(e))}},function(e,t,r){"use strict";var n=r(4),i=r(22);e.exports=function(e,t){var r;return arguments.length<2?i(r=n[e])?r:void 0:n[e]&&n[e][t]}},function(e,t,r){"use strict";e.exports=r(15)({}.isPrototypeOf)},function(e,t,r){"use strict";e.exports=r(27)&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,t,r){"use strict";var n=r(28),i=r(8),a=r(4).String;e.exports=!!Object.getOwnPropertySymbols&&!i(function(){var e=Symbol("symbol detection");return!a(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&n&&n<41})},function(e,t,r){"use strict";var n,i,a=r(4),s=r(29),o=a.process,u=a.Deno,l=o&&o.versions||u&&u.version,c=l&&l.v8;c&&(i=(n=c.split("."))[0]>0&&n[0]<4?1:+(n[0]+n[1])),!i&&s&&(!(n=s.match(/Edge\/(\d+)/))||n[1]>=74)&&(n=s.match(/Chrome\/(\d+)/))&&(i=+n[1]),e.exports=i},function(e,t,r){"use strict";e.exports="undefined"!=typeof navigator&&String(navigator.userAgent)||""},function(e,t,r){"use strict";var n=r(31),i=r(18);e.exports=function(e,t){var r=e[t];return i(r)?void 0:n(r)}},function(e,t,r){"use strict";var n=r(22),i=r(32),a=TypeError;e.exports=function(e){if(n(e))return e;throw new a(i(e)+" is not a function")}},function(e,t,r){"use strict";var n=String;e.exports=function(e){try{return n(e)}catch(e){return"Object"}}},function(e,t,r){"use strict";var n=r(9),i=r(22),a=r(21),s=TypeError;e.exports=function(e,t){var r,o;if("string"===t&&i(r=e.toString)&&!a(o=n(r,e))||i(r=e.valueOf)&&!a(o=n(r,e))||"string"!==t&&i(r=e.toString)&&!a(o=n(r,e)))return o;throw new s("Can't convert object to primitive value")}},function(e,t,r){"use strict";var n=r(4),i=r(35),a=r(39),s=r(41),o=r(27),u=r(26),l=n.Symbol,c=i("wks"),h=u?l.for||l:l&&l.withoutSetter||s;e.exports=function(e){return a(c,e)||(c[e]=o&&a(l,e)?l[e]:h("Symbol."+e)),c[e]}},function(e,t,r){"use strict";var n=r(36);e.exports=function(e,t){return n[e]||(n[e]=t||{})}},function(e,t,r){"use strict";var n=r(37),i=r(4),a=r(38),s=e.exports=i["__core-js_shared__"]||a("__core-js_shared__",{});(s.versions||(s.versions=[])).push({version:"3.37.1",mode:n?"pure":"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.37.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,t,r){"use strict";e.exports=!1},function(e,t,r){"use strict";var n=r(4),i=Object.defineProperty;e.exports=function(e,t){try{i(n,e,{value:t,configurable:!0,writable:!0})}catch(r){n[e]=t}return t}},function(e,t,r){"use strict";var n=r(15),i=r(40),a=n({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return a(i(e),t)}},function(e,t,r){"use strict";var n=r(17),i=Object;e.exports=function(e){return i(n(e))}},function(e,t,r){"use strict";var n=r(15),i=0,a=Math.random(),s=n(1..toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++i+a,36)}},function(e,t,r){"use strict";var n=r(7),i=r(8),a=r(43);e.exports=!n&&!i(function(){return 7!==Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){"use strict";var n=r(4),i=r(21),a=n.document,s=i(a)&&i(a.createElement);e.exports=function(e){return s?a.createElement(e):{}}},function(e,t,r){"use strict";var n=r(7),i=r(45),a=r(12);e.exports=n?function(e,t,r){return i.f(e,t,a(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){"use strict";var n=r(7),i=r(42),a=r(46),s=r(47),o=r(19),u=TypeError,l=Object.defineProperty,c=Object.getOwnPropertyDescriptor;t.f=n?a?function(e,t,r){if(s(e),t=o(t),s(r),"function"==typeof e&&"prototype"===t&&"value"in r&&"writable"in r&&!r.writable){var n=c(e,t);n&&n.writable&&(e[t]=r.value,r={configurable:"configurable"in r?r.configurable:n.configurable,enumerable:"enumerable"in r?r.enumerable:n.enumerable,writable:!1})}return l(e,t,r)}:l:function(e,t,r){if(s(e),t=o(t),s(r),i)try{return l(e,t,r)}catch(e){}if("get"in r||"set"in r)throw new u("Accessors not supported");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){"use strict";var n=r(7),i=r(8);e.exports=n&&i(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},function(e,t,r){"use strict";var n=r(21),i=String,a=TypeError;e.exports=function(e){if(n(e))return e;throw new a(i(e)+" is not an object")}},function(e,t,r){"use strict";var n=r(22),i=r(45),a=r(49),s=r(38);e.exports=function(e,t,r,o){o||(o={});var u=o.enumerable,l=void 0!==o.name?o.name:t;if(n(r)&&a(r,l,o),o.global)u?e[t]=r:s(t,r);else{try{o.unsafe?e[t]&&(u=!0):delete e[t]}catch(e){}u?e[t]=r:i.f(e,t,{value:r,enumerable:!1,configurable:!o.nonConfigurable,writable:!o.nonWritable})}return e}},function(e,t,r){"use strict";var n=r(15),i=r(8),a=r(22),s=r(39),o=r(7),u=r(50).CONFIGURABLE,l=r(51),c=r(52),h=c.enforce,d=c.get,p=String,m=Object.defineProperty,g=n("".slice),f=n("".replace),E=n([].join),T=o&&!i(function(){return 8!==m(function(){},"length",{value:8}).length}),y=String(String).split("String"),A=e.exports=function(e,t,r){"Symbol("===g(p(t),0,7)&&(t="["+f(p(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!s(e,"name")||u&&e.name!==t)&&(o?m(e,"name",{value:t,configurable:!0}):e.name=t),T&&r&&s(r,"arity")&&e.length!==r.arity&&m(e,"length",{value:r.arity});try{r&&s(r,"constructor")&&r.constructor?o&&m(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var n=h(e);return s(n,"source")||(n.source=E(y,"string"==typeof t?t:"")),e};Function.prototype.toString=A(function(){return a(this)&&d(this).source||l(this)},"toString")},function(e,t,r){"use strict";var n=r(7),i=r(39),a=Function.prototype,s=n&&Object.getOwnPropertyDescriptor,o=i(a,"name"),u=o&&(!n||n&&s(a,"name").configurable);e.exports={EXISTS:o,PROPER:o&&"something"===(function(){}).name,CONFIGURABLE:u}},function(e,t,r){"use strict";var n=r(15),i=r(22),a=r(36),s=n(Function.toString);i(a.inspectSource)||(a.inspectSource=function(e){return s(e)}),e.exports=a.inspectSource},function(e,t,r){"use strict";var n,i,a,s=r(53),o=r(4),u=r(21),l=r(44),c=r(39),h=r(36),d=r(54),p=r(55),m=o.TypeError,g=o.WeakMap;if(s||h.state){var f=h.state||(h.state=new g);f.get=f.get,f.has=f.has,f.set=f.set,n=function(e,t){if(f.has(e))throw new m("Object already initialized");return t.facade=e,f.set(e,t),t},i=function(e){return f.get(e)||{}},a=function(e){return f.has(e)}}else{var E=d("state");p[E]=!0,n=function(e,t){if(c(e,E))throw new m("Object already initialized");return t.facade=e,l(e,E,t),t},i=function(e){return c(e,E)?e[E]:{}},a=function(e){return c(e,E)}}e.exports={set:n,get:i,has:a,enforce:function(e){return a(e)?i(e):n(e,{})},getterFor:function(e){return function(t){var r;if(!u(t)||(r=i(t)).type!==e)throw new m("Incompatible receiver, "+e+" required");return r}}}},function(e,t,r){"use strict";var n=r(4),i=r(22),a=n.WeakMap;e.exports=i(a)&&/native code/.test(String(a))},function(e,t,r){"use strict";var n=r(35),i=r(41),a=n("keys");e.exports=function(e){return a[e]||(a[e]=i(e))}},function(e,t,r){"use strict";e.exports={}},function(e,t,r){"use strict";var n=r(39),i=r(57),a=r(6),s=r(45);e.exports=function(e,t,r){for(var o=i(t),u=s.f,l=a.f,c=0;c<o.length;c++){var h=o[c];n(e,h)||r&&n(r,h)||u(e,h,l(t,h))}}},function(e,t,r){"use strict";var n=r(24),i=r(15),a=r(58),s=r(67),o=r(47),u=i([].concat);e.exports=n("Reflect","ownKeys")||function(e){var t=a.f(o(e)),r=s.f;return r?u(t,r(e)):t}},function(e,t,r){"use strict";var n=r(59),i=r(66).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return n(e,i)}},function(e,t,r){"use strict";var n=r(15),i=r(39),a=r(13),s=r(60).indexOf,o=r(55),u=n([].push);e.exports=function(e,t){var r,n=a(e),l=0,c=[];for(r in n)!i(o,r)&&i(n,r)&&u(c,r);for(;t.length>l;)i(n,r=t[l++])&&(~s(c,r)||u(c,r));return c}},function(e,t,r){"use strict";var n=r(13),i=r(61),a=r(64),s=function(e){return function(t,r,s){var o=n(t),u=a(o);if(0===u)return!e&&-1;var l,c=i(s,u);if(e&&r!=r){for(;u>c;)if((l=o[c++])!=l)return!0}else for(;u>c;c++)if((e||c in o)&&o[c]===r)return e||c||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},function(e,t,r){"use strict";var n=r(62),i=Math.max,a=Math.min;e.exports=function(e,t){var r=n(e);return r<0?i(r+t,0):a(r,t)}},function(e,t,r){"use strict";var n=r(63);e.exports=function(e){var t=+e;return t!=t||0===t?0:n(t)}},function(e,t,r){"use strict";var n=Math.ceil,i=Math.floor;e.exports=Math.trunc||function(e){var t=+e;return(t>0?i:n)(t)}},function(e,t,r){"use strict";var n=r(65);e.exports=function(e){return n(e.length)}},function(e,t,r){"use strict";var n=r(62),i=Math.min;e.exports=function(e){var t=n(e);return t>0?i(t,0x1fffffffffffff):0}},function(e,t,r){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,t,r){"use strict";t.f=Object.getOwnPropertySymbols},function(e,t,r){"use strict";var n=r(8),i=r(22),a=/#|\.prototype\./,s=function(e,t){var r=u[o(e)];return r===c||r!==l&&(i(t)?n(t):!!t)},o=s.normalize=function(e){return String(e).replace(a,".").toLowerCase()},u=s.data={},l=s.NATIVE="N",c=s.POLYFILL="P";e.exports=s},function(e,t,r){"use strict";var n=r(7),i=r(70),a=TypeError,s=Object.getOwnPropertyDescriptor;e.exports=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}()?function(e,t){if(i(e)&&!s(e,"length").writable)throw new a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},function(e,t,r){"use strict";var n=r(16);e.exports=Array.isArray||function(e){return"Array"===n(e)}},function(e,t,r){"use strict";var n=TypeError;e.exports=function(e){if(e>0x1fffffffffffff)throw n("Maximum allowed index exceeded");return e}},function(e,t,r){"use strict";t.__esModule=!0,t.WRONG_RANGE_SIZE=t.AbsoluteRowRange=t.AbsoluteColumnRange=t.AbsoluteCellRange=void 0,t.isSimpleCellRange=function(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"start"in e&&(0,n.isSimpleCellAddress)(e.start)&&"end"in e&&(0,n.isSimpleCellAddress)(e.end)},t.simpleCellRange=void 0,r(2);var n=r(73),i=r(147),a=r(77),s=r(141);let o=t.WRONG_RANGE_SIZE="AbsoluteCellRange: Wrong range size";t.simpleCellRange=(e,t)=>({start:e,end:t});class u{constructor(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);this.start=(0,n.simpleCellAddress)(e.sheet,e.col,e.row),this.end=(0,n.simpleCellAddress)(t.sheet,t.col,t.row)}get sheet(){return this.start.sheet}static fromSimpleCellAddresses(e,t){if(e.sheet!==t.sheet)throw new i.SheetsNotEqual(e.sheet,t.sheet);let r=t.col-e.col,n=t.row-e.row;return Number.isFinite(n)&&Number.isFinite(r)?new u(e,t):Number.isFinite(n)?new c(e.sheet,e.row,t.row):new l(e.sheet,e.col,t.col)}static fromAst(e,t){return e.type===a.AstNodeType.CELL_RANGE?u.fromCellRange(e,t):e.type===a.AstNodeType.COLUMN_RANGE?l.fromColumnRange(e,t):c.fromRowRangeAst(e,t)}static fromAstOrUndef(e,t){try{return u.fromAst(e,t)}catch(e){return}}static fromCellRange(e,t){return new u(e.start.toSimpleCellAddress(t),e.end.toSimpleCellAddress(t))}static spanFrom(e,t,r){let n=u.spanFromOrUndef(e,t,r);if(void 0===n)throw Error(o);return n}static spanFromOrUndef(e,t,r){if(!Number.isFinite(t)&&Number.isFinite(r)){if(0!==e.col)return;return new c(e.sheet,e.row,e.row+r-1)}if(!Number.isFinite(r)&&Number.isFinite(t)){if(0!==e.row)return;return new l(e.sheet,e.col,e.col+t-1)}if(Number.isFinite(r)&&Number.isFinite(t))return new u(e,(0,n.simpleCellAddress)(e.sheet,e.col+t-1,e.row+r-1))}static fromCoordinates(e,t,r,i,a){return new u((0,n.simpleCellAddress)(e,t,r),(0,n.simpleCellAddress)(e,i,a))}isFinite(){return Number.isFinite(this.size())}doesOverlap(e){return this.start.sheet==e.start.sheet&&!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col)}addressInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col}columnInRange(e){return this.sheet===e.sheet&&this.start.col<=e.col&&this.end.col>=e.col}rowInRange(e){return this.sheet===e.sheet&&this.start.row<=e.row&&this.end.row>=e.row}containsRange(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}intersectionWith(e){if(this.sheet!==e.start.sheet)return;let t=Math.max(this.start.row,e.start.row),r=Math.min(this.end.row,e.end.row),i=Math.max(this.start.col,e.start.col),a=Math.min(this.end.col,e.end.col);return t>r||i>a?void 0:new u((0,n.simpleCellAddress)(this.sheet,i,t),(0,n.simpleCellAddress)(this.sheet,a,r))}includesRow(e){return this.start.row<e&&this.end.row>=e}includesColumn(e){return this.start.col<e&&this.end.col>=e}shiftByRows(e){this.start.row+=e,this.end.row+=e}expandByRows(e){this.end.row+=e}shiftByColumns(e){this.start.col+=e,this.end.col+=e}shifted(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col+e,this.start.row+t),this.width(),this.height())}expandByColumns(e){this.end.col+=e}moveToSheet(e){this.start.sheet=e,this.end.sheet=e}removeSpan(e){e instanceof s.RowsSpan?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}shouldBeRemoved(){return 0>=this.width()||0>=this.height()}rangeWithSameWidth(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,this.start.col,e),this.width(),t)}rangeWithSameHeight(e,t){return u.spanFrom((0,n.simpleCellAddress)(this.sheet,e,this.start.row),t,this.height())}toString(){return`${this.start.sheet},${this.start.col},${this.start.row},${this.end.col},${this.end.row}`}width(){return this.end.col-this.start.col+1}height(){return this.end.row-this.start.row+1}size(){return this.height()*this.width()}arrayOfAddressesInRange(){let e=[];for(let t=0;t<this.height();++t){e[t]=[];for(let r=0;r<this.width();++r){let i=(0,n.simpleCellAddress)(this.sheet,this.start.col+r,this.start.row+t);e[t].push(i)}}return e}withStart(e){return new u(e,this.end)}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}sameAs(e){return(0,n.equalSimpleCellAddress)(this.start,e.start)&&(0,n.equalSimpleCellAddress)(this.end,e.end)}addressesArrayMap(e,t){let r=[],i=this.start.row;for(;i<=this.effectiveEndRow(e);){let a=this.start.col,s=[];for(;a<=this.effectiveEndColumn(e);)s.push(t((0,n.simpleCellAddress)(this.start.sheet,a,i))),a++;r.push(s),i++}return r}addresses(e){let t=[],r=this.start.row,i=this.effectiveEndRow(e),a=this.effectiveEndColumn(e);for(;r<=i;){let e=this.start.col;for(;e<=a;)t.push((0,n.simpleCellAddress)(this.start.sheet,e,r)),e++;r++}return t}*addressesWithDirection(e,t,r){if(e>0)if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t-=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.effectiveEndColumn(r);for(;t>=this.start.col;)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t-=1;e+=1}}else if(t>0){let e=this.effectiveEndRow(r);for(;e>=this.start.row;){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t+=1;e-=1}}else{let e=this.start.row;for(;e<=this.effectiveEndRow(r);){let t=this.start.col;for(;t<=this.effectiveEndColumn(r);)yield(0,n.simpleCellAddress)(this.start.sheet,t,e),t+=1;e+=1}}}getAddress(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return(0,n.simpleCellAddress)(this.start.sheet,this.start.col+e,this.start.row+t)}exceedsSheetSizeLimits(e,t){return this.end.col>=e||this.end.row>=t}effectiveEndColumn(e){return this.end.col}effectiveEndRow(e){return this.end.row}effectiveWidth(e){return this.width()}effectiveHeight(e){return this.height()}removeRows(e,t){if(!(e>this.end.row)){if(t<this.start.row)return this.shiftByRows(-(t-e+1));e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}removeColumns(e,t){if(!(e>this.end.col)){if(t<this.start.col)return this.shiftByColumns(-(t-e+1));e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}}t.AbsoluteCellRange=u;class l extends u{constructor(e,t,r){super((0,n.simpleCellAddress)(e,t,0),(0,n.simpleCellAddress)(e,r,Number.POSITIVE_INFINITY))}static fromColumnRange(e,t){let r=e.start.toSimpleColumnAddress(t),n=e.end.toSimpleColumnAddress(t);if(r.sheet!==n.sheet)throw new i.SheetsNotEqual(r.sheet,n.sheet);return new l(r.sheet,r.col,n.col)}shouldBeRemoved(){return 0>=this.width()}shiftByRows(e){}expandByRows(e){}shifted(e,t){return new l(this.sheet,this.start.col+e,this.end.col+e)}rangeWithSameHeight(e,t){return new l(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.col>=e}effectiveEndRow(e){return this.effectiveHeight(e)-1}effectiveHeight(e){return e.getSheetHeight(this.sheet)}removeRows(e,t){}}t.AbsoluteColumnRange=l;class c extends u{constructor(e,t,r){super((0,n.simpleCellAddress)(e,0,t),(0,n.simpleCellAddress)(e,Number.POSITIVE_INFINITY,r))}static fromRowRangeAst(e,t){let r=e.start.toSimpleRowAddress(t),n=e.end.toSimpleRowAddress(t);if(r.sheet!==n.sheet)throw new i.SheetsNotEqual(r.sheet,n.sheet);return new c(r.sheet,r.row,n.row)}shouldBeRemoved(){return 0>=this.height()}shiftByColumns(e){}expandByColumns(e){}shifted(e,t){return new c(this.sheet,this.start.row+t,this.end.row+t)}rangeWithSameWidth(e,t){return new c(this.sheet,e,e+t-1)}exceedsSheetSizeLimits(e,t){return this.end.row>=t}effectiveEndColumn(e){return this.effectiveWidth(e)-1}effectiveWidth(e){return e.getSheetWidth(this.sheet)}removeColumns(e,t){}}t.AbsoluteRowRange=c},function(e,t,r){"use strict";t.__esModule=!0,t.invalidSimpleRowAddress=t.invalidSimpleColumnAddress=t.invalidSimpleCellAddress=t.getCellValueType=t.getCellValueFormat=t.getCellValueDetailedType=t.getCellType=t.equalSimpleCellAddress=t.addressKey=t.absoluteSheetReference=t.ErrorType=t.CellValueTypeOrd=t.CellValueType=t.CellValueNoNumber=t.CellValueJustNumber=t.CellValueDetailedType=t.CellType=t.CellError=void 0,t.isSimpleCellAddress=function(e){return e&&("object"==typeof e||"function"==typeof e)&&"number"==typeof(null==e?void 0:e.sheet)&&"number"==typeof(null==e?void 0:e.col)&&"number"==typeof(null==e?void 0:e.row)},t.simpleRowAddress=t.simpleColumnAddress=t.simpleCellAddress=t.movedSimpleCellAddress=void 0;var n,i,a,s,o,u,l,c=r(74),h=r(131),d=r(140),p=r(139);(n=u||(t.ErrorType=u={})).DIV_BY_ZERO="DIV_BY_ZERO",n.NAME="NAME",n.VALUE="VALUE",n.NUM="NUM",n.NA="NA",n.CYCLE="CYCLE",n.REF="REF",n.SPILL="SPILL",n.LIC="LIC",n.ERROR="ERROR",(i=l||(t.CellType=l={})).FORMULA="FORMULA",i.VALUE="VALUE",i.ARRAY="ARRAY",i.EMPTY="EMPTY",i.ARRAYFORMULA="ARRAYFORMULA",t.getCellType=(e,t)=>e instanceof c.ArrayVertex?e.isLeftCorner(t)?l.ARRAYFORMULA:l.ARRAY:e instanceof c.FormulaCellVertex||e instanceof c.ParsingErrorVertex?l.FORMULA:e instanceof c.ValueCellVertex?l.VALUE:l.EMPTY,(a=s||(t.CellValueNoNumber=s={})).EMPTY="EMPTY",a.NUMBER="NUMBER",a.STRING="STRING",a.BOOLEAN="BOOLEAN",a.ERROR="ERROR",(o||(t.CellValueJustNumber=o={})).NUMBER="NUMBER";let m=t.CellValueType=Object.assign(Object.assign({},s),o);t.CellValueDetailedType=Object.assign(Object.assign({},s),d.NumberType),t.CellValueTypeOrd=e=>{switch(e){case m.EMPTY:return 0;case m.NUMBER:return 1;case m.STRING:return 2;case m.BOOLEAN:return 3;case m.ERROR:return 4}throw Error("Cell value not computed")};let g=e=>{if(e===d.EmptyValue)return m.EMPTY;if(e instanceof f||e instanceof p.SimpleRangeValue)return m.ERROR;if("string"==typeof e)return m.STRING;if((0,d.isExtendedNumber)(e))return m.NUMBER;if("boolean"==typeof e)return m.BOOLEAN;throw Error("Cell value not computed")};t.getCellValueType=g,t.getCellValueDetailedType=e=>(0,d.isExtendedNumber)(e)?(0,d.getTypeOfExtendedNumber)(e):g(e),t.getCellValueFormat=e=>(0,d.isExtendedNumber)(e)?(0,d.getFormatOfExtendedNumber)(e):void 0;class f{constructor(e,t,r){this.type=e,this.message=t,this.root=r}static parsingError(e){return new f(u.ERROR,`${h.ErrorMessage.ParseError}${e?" "+e:""}`)}attachRootVertex(e){return void 0===this.root?new f(this.type,this.message,e):this}}t.CellError=f,t.simpleRowAddress=(e,t)=>({sheet:e,row:t}),t.invalidSimpleRowAddress=e=>e.row<0,t.simpleColumnAddress=(e,t)=>({sheet:e,col:t}),t.invalidSimpleColumnAddress=e=>e.col<0;let E=(e,t,r)=>({sheet:e,col:t,row:r});t.simpleCellAddress=E,t.invalidSimpleCellAddress=e=>e.col<0||e.row<0,t.movedSimpleCellAddress=(e,t,r,n)=>E(t,e.col+r,e.row+n),t.addressKey=e=>`${e.sheet},${e.row},${e.col}`,t.absoluteSheetReference=(e,t)=>{var r;return null!=(r=e.sheet)?r:t.sheet},t.equalSimpleCellAddress=(e,t)=>e.sheet===t.sheet&&e.col===t.col&&e.row===t.row},function(e,t,r){"use strict";t.__esModule=!0,t.ValueCellVertex=t.TopSort=t.SparseStrategy=t.SheetMapping=t.RangeVertex=t.RangeMapping=t.ParsingErrorVertex=t.Graph=t.FormulaCellVertex=t.EmptyCellVertex=t.DependencyGraph=t.DenseStrategy=t.ArrayVertex=t.ArrayMapping=t.AddressMapping=void 0,t.DependencyGraph=r(75).DependencyGraph,t.AddressMapping=r(146).AddressMapping,t.Graph=r(153).Graph,t.TopSort=r(154).TopSort,t.RangeMapping=r(156).RangeMapping,t.SheetMapping=r(157).SheetMapping,t.ArrayMapping=r(148).ArrayMapping;var n=r(150);t.FormulaCellVertex=n.FormulaCellVertex,t.ArrayVertex=n.ArrayVertex,t.EmptyCellVertex=r(160).EmptyCellVertex,t.ValueCellVertex=r(161).ValueCellVertex,t.ParsingErrorVertex=r(162).ParsingErrorVertex,t.RangeVertex=r(152).RangeVertex,t.SparseStrategy=r(163).SparseStrategy,t.DenseStrategy=r(164).DenseStrategy},function(e,t,r){"use strict";t.__esModule=!0,t.DependencyGraph=void 0,r(2);var n=r(72),i=r(76),a=r(73),s=r(138),o=r(131),u=r(140),l=r(139),c=r(77),h=r(141),d=r(142),p=r(74),m=r(146),g=r(148),f=r(149),E=r(150),T=r(153),y=r(156),A=r(157);class R{constructor(e,t,r,o,u,l,h,d){this.addressMapping=e,this.rangeMapping=t,this.sheetMapping=r,this.arrayMapping=o,this.stats=u,this.lazilyTransformingAstService=l,this.functionRegistry=h,this.namedExpressions=d,this.changes=s.ContentChanges.empty(),this.dependencyQueryAddresses=e=>{if(e instanceof p.RangeVertex)return this.rangeDependencyQuery(e).map(([e,t])=>e);{let t=this.formulaDependencyQuery(e);if(void 0!==t){let[e,r]=t;return r.map(t=>t instanceof c.NamedExpressionDependency?this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet).address:(0,a.isSimpleCellAddress)(t)?t:(0,n.simpleCellRange)(t.start,t.end))}return[]}},this.dependencyQueryVertices=e=>{if(e instanceof p.RangeVertex)return this.rangeDependencyQuery(e);{let t=this.formulaDependencyQuery(e);if(void 0!==t){let[e,r]=t;return r.map(t=>{if(t instanceof n.AbsoluteCellRange)return[t.start,this.rangeMapping.fetchRange(t.start,t.end)];if(t instanceof c.NamedExpressionDependency){let r=this.namedExpressions.namedExpressionOrPlaceholder(t.name,e.sheet);return[r.address,this.addressMapping.fetchCell(r.address)]}return[t,this.addressMapping.fetchCell(t)]})}return[]}},this.rangeDependencyQuery=e=>{let t,r=[],{smallerRangeVertex:i,restRange:a}=this.rangeMapping.findSmallerRange(e.range);for(let s of(void 0!==i&&this.graph.adjacentNodes(i).has(e)?(t=a,r.push([new n.AbsoluteCellRange(i.start,i.end),i])):t=e.range,t.addresses(this))){let e=this.addressMapping.getCell(s);void 0!==e&&r.push([s,e])}return r},this.formulaDependencyQuery=e=>{let t,r;if(!(e instanceof E.FormulaVertex))return;r=e.getAddress(this.lazilyTransformingAstService),t=e.getFormula(this.lazilyTransformingAstService);let n=(0,c.collectDependencies)(t,this.functionRegistry);return[r,(0,i.absolutizeDependencies)(n,r)]},this.graph=new T.Graph(this.dependencyQueryVertices)}static buildEmpty(e,t,r,n,i){return new R(new m.AddressMapping(t.chooseAddressMappingPolicy),new y.RangeMapping,new A.SheetMapping(t.translationPackage),new g.ArrayMapping,i,e,r,n)}setFormulaToCell(e,t,r,n,i,a){let s=E.FormulaVertex.fromAst(t,e,n,this.lazilyTransformingAstService.version());return this.exchangeOrAddFormulaVertex(s),this.processCellDependencies(r,s),this.graph.markNodeAsDirty(s),i&&this.markAsVolatile(s),a&&this.markAsDependentOnStructureChange(s),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setParsingErrorToCell(e,t){let r=this.shrinkPossibleArrayAndGetCell(e);return this.exchangeOrAddGraphNode(r,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t),this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setValueToCell(e,t){let r=this.shrinkPossibleArrayAndGetCell(e);if(r instanceof p.ArrayVertex&&this.arrayMapping.removeArray(r.getRange()),r instanceof p.ValueCellVertex)r.getValues().rawValue!==t.rawValue&&(r.setValues(t),this.graph.markNodeAsDirty(r));else{let n=new p.ValueCellVertex(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(r,n),this.addressMapping.setCell(e,n),this.graph.markNodeAsDirty(n)}return this.correctInfiniteRangesDependency(e),this.getAndClearContentChanges()}setCellEmpty(e){let t=this.shrinkPossibleArrayAndGetCell(e);if(void 0===t)return s.ContentChanges.empty();if(this.graph.adjacentNodes(t).size>0){let r=new p.EmptyCellVertex;this.exchangeGraphNode(t,r),0===this.graph.adjacentNodesCount(r)?(this.removeVertex(r),this.addressMapping.removeCell(e)):(this.graph.markNodeAsDirty(r),this.addressMapping.setCell(e,r))}else this.removeVertex(t),this.addressMapping.removeCell(e);return this.getAndClearContentChanges()}clearDirtyVertices(){this.graph.clearDirtyNodes()}verticesToRecompute(){return this.graph.getDirtyAndVolatileNodes()}processCellDependencies(e,t){let r=this.graph.getNodeId(t);e.forEach(e=>{if(e instanceof n.AbsoluteCellRange){let t=this.getRange(e.start,e.end);void 0===t&&(t=new p.RangeVertex(e),this.rangeMapping.setRange(t)),this.graph.addNodeAndReturnId(t);let n=this.graph.getNodeId(t);e.isFinite()||this.graph.markNodeAsInfiniteRange(n);let{smallerRangeVertex:i,restRange:a}=this.rangeMapping.findSmallerRange(e);if(void 0!==i){if(this.graph.addEdge(i,n),t.bruteForce)for(let r of(t.bruteForce=!1,e.addresses(this)))this.graph.removeEdge(this.fetchCell(r),n)}else t.bruteForce=!0;let s=this.arrayMapping.getArray(a);if(void 0!==s)this.graph.addEdge(s,n);else for(let e of a.addresses(this)){let{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,n)}this.graph.addEdge(n,r),e.isFinite()&&this.correctInfiniteRangesDependenciesByRangeVertex(t)}else if(e instanceof c.NamedExpressionDependency){let n=t.getAddress(this.lazilyTransformingAstService).sheet,{vertex:i,id:a}=this.fetchNamedExpressionVertex(e.name,n);this.graph.addEdge(null!=a?a:i,r)}else{let{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r)}})}fetchNamedExpressionVertex(e,t){let r=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(r.address)}exchangeNode(e,t){let r=this.fetchCellOrCreateEmpty(e).vertex,n=this.fetchCellOrCreateEmpty(t).vertex;this.addressMapping.removeCell(e),this.exchangeGraphNode(r,n)}fetchCellOrCreateEmpty(e){let t=this.addressMapping.getCell(e);if(void 0!==t)return{vertex:t,id:void 0};let r=new p.EmptyCellVertex,n=this.graph.addNodeAndReturnId(r);return this.addressMapping.setCell(e,r),{vertex:r,id:n}}removeRows(e){this.stats.measure(d.StatType.ADJUSTING_GRAPH,()=>{for(let[t,r]of this.addressMapping.entriesFromRowsSpan(e)){for(let e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof p.ArrayVertex){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}}),this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeRows(e)});let t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{let t=this.truncateRanges(e,e=>e.row);return this.getArrayVerticesRelatedToRanges(t)});return this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterRemovingRows(e.sheet,e.rowStart,e.numberOfRows)}),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}removeSheet(e){for(let[t,r]of(this.clearSheet(e),this.addressMapping.sheetEntries(e))){for(let e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);this.removeVertex(r),this.addressMapping.removeCell(t)}this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{for(let t of this.rangeMapping.removeRangesInSheet(e))this.removeVertex(t);this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeSheet(e)})})}clearSheet(e){let t=new Set;for(let[r,n]of this.addressMapping.sheetEntries(e))n instanceof p.ArrayVertex?t.add(n):this.setCellEmpty(r);for(let e of t.values())this.setArrayEmpty(e);this.addStructuralNodesToChangeSet()}removeColumns(e){this.stats.measure(d.StatType.ADJUSTING_GRAPH,()=>{for(let[t,r]of this.addressMapping.entriesFromColumnsSpan(e)){for(let e of this.graph.adjacentNodes(r))this.graph.markNodeAsDirty(e);if(r instanceof p.ArrayVertex){if(!r.isLeftCorner(t))continue;this.shrinkArrayToCorner(r),this.arrayMapping.removeArray(r.getRange())}this.removeVertex(r)}}),this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.removeColumns(e)});let t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{let t=this.truncateRanges(e,e=>e.col);return this.getArrayVerticesRelatedToRanges(t)});return this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterRemovingColumns(e.sheet,e.columnStart,e.numberOfColumns)),this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}addRows(e){this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)});let t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{let t=this.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows);return this.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)});for(let t of(this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>{this.fixArraysAfterAddingRow(e.sheet,e.rowStart,e.numberOfRows)}),this.addressMapping.verticesFromRowsSpan(e)))this.graph.markNodeAsDirty(t);return this.addStructuralNodesToChangeSet(),{affectedArrays:t}}addColumns(e){this.stats.measure(d.StatType.ADJUSTING_ADDRESS_MAPPING,()=>{this.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)});let t=this.stats.measure(d.StatType.ADJUSTING_RANGES,()=>{let t=this.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns);return this.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns),this.getArrayVerticesRelatedToRanges(t.verticesWithChangedSize)});for(let t of(this.stats.measure(d.StatType.ADJUSTING_ARRAY_MAPPING,()=>this.fixArraysAfterAddingColumn(e.sheet,e.columnStart,e.numberOfColumns)),this.addressMapping.verticesFromColumnsSpan(e)))this.graph.markNodeAsDirty(t);return this.addStructuralNodesToChangeSet(),{affectedArrays:t,contentChanges:this.getAndClearContentChanges()}}isThereSpaceForArray(e){let t=e.getRangeOrUndef();if(void 0===t)return!1;for(let r of t.addresses(this)){let t=this.addressMapping.getCell(r);if(void 0!==t&&!(t instanceof p.EmptyCellVertex)&&t!==e)return!1}return!0}moveCells(e,t,r,n){for(let i of e.addressesWithDirection(t,r,this)){let s=(0,a.simpleCellAddress)(n,i.col+t,i.row+r),o=this.addressMapping.getCell(i),u=this.addressMapping.getCell(s);if(this.addressMapping.removeCell(i),void 0!==o){let t;for(let r of(this.graph.markNodeAsDirty(o),this.addressMapping.setCell(s,o),this.graph.adjacentNodes(o)))r instanceof p.RangeVertex&&!e.containsRange(r.range)&&(t=null!=t?t:this.fetchCellOrCreateEmpty(i).vertex,this.graph.addEdge(t,r),this.graph.removeEdge(o,r));t&&(this.graph.markNodeAsDirty(t),this.addressMapping.setCell(i,t))}if(void 0!==u){for(let e of(void 0===o&&this.addressMapping.removeCell(s),this.graph.adjacentNodes(u)))o=null!=o?o:this.fetchCellOrCreateEmpty(s).vertex,this.graph.addEdge(o,e),this.graph.markNodeAsDirty(o);this.removeVertex(u)}}for(let t of this.rangeMapping.rangeVerticesContainedInRange(e))for(let r of this.graph.adjacentNodes(t))if(r instanceof p.RangeVertex&&!e.containsRange(r.range))for(let e of(this.graph.removeEdge(t,r),t.range.addresses(this))){let{vertex:t,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:t,r),this.addressMapping.setCell(e,t),this.graph.markNodeAsDirty(t)}this.rangeMapping.moveRangesInsideSourceRange(e,t,r,n)}setArrayEmpty(e){let t=n.AbsoluteCellRange.spanFrom(e.getAddress(this.lazilyTransformingAstService),e.width,e.height),r=this.graph.adjacentNodes(e);for(let e of t.addresses(this))this.addressMapping.removeCell(e);for(let t of r.values()){let r=(0,f.collectAddressesDependentToRange)(this.functionRegistry,t,e.getRange(),this.lazilyTransformingAstService,this);for(let e of r){let{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t)}r.length>0&&this.graph.markNodeAsDirty(t)}this.removeVertex(e),this.arrayMapping.removeArray(e.getRange())}addVertex(e,t){this.graph.addNodeAndReturnId(t),this.addressMapping.setCell(e,t)}addArrayVertex(e,t){this.graph.addNodeAndReturnId(t),this.setAddressMappingForArrayVertex(t,e)}*arrayFormulaNodes(){for(let e of this.graph.getNodes())e instanceof p.ArrayVertex&&(yield e)}*entriesFromRowsSpan(e){yield*this.addressMapping.entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.addressMapping.entriesFromColumnsSpan(e)}fetchCell(e){return this.addressMapping.fetchCell(e)}getCell(e){return this.addressMapping.getCell(e)}getCellValue(e){return this.addressMapping.getCellValue(e)}getRawValue(e){return this.addressMapping.getRawValue(e)}getScalarValue(e){let t=this.addressMapping.getCellValue(e);return t instanceof l.SimpleRangeValue?new a.CellError(a.ErrorType.VALUE,o.ErrorMessage.ScalarExpected):t}existsEdge(e,t){return this.graph.existsEdge(e,t)}getSheetId(e){return this.sheetMapping.fetch(e)}getSheetHeight(e){return this.addressMapping.getHeight(e)}getSheetWidth(e){return this.addressMapping.getWidth(e)}getArray(e){return this.arrayMapping.getArray(e)}getRange(e,t){return this.rangeMapping.getRange(e,t)}topSortWithScc(){return this.graph.topSortWithScc()}markAsVolatile(e){this.graph.markNodeAsVolatile(e)}markAsDependentOnStructureChange(e){this.graph.markNodeAsChangingWithStructure(e)}forceApplyPostponedTransformations(){for(let e of this.graph.getNodes())e instanceof p.FormulaCellVertex&&e.ensureRecentData(this.lazilyTransformingAstService)}*rawValuesFromRange(e){for(let t of e.addresses(this)){let e=this.getScalarValue(t);e!==u.EmptyValue&&(yield[(0,u.getRawValue)(e),t])}}computeListOfValuesInRange(e){let t=[];for(let r of e.addresses(this)){let e=this.getScalarValue(r);t.push(e)}return t}shrinkArrayToCorner(e){for(let t of(this.cleanAddressMappingUnderArray(e),this.adjacentArrayVertices(e))){let r;r=t instanceof E.FormulaVertex?this.formulaDirectDependenciesToArray(t,e):this.rangeDirectDependenciesToArray(t,e);let n=!1;for(let[i,a]of r)e.isLeftCorner(i)&&(n=!0),this.graph.addEdge(a,t),this.graph.markNodeAsDirty(a);n||this.graph.removeEdge(e,t)}this.graph.markNodeAsDirty(e)}isArrayInternalCell(e){let t=this.getCell(e);return t instanceof p.ArrayVertex&&!t.isLeftCorner(e)}getAndClearContentChanges(){let e=this.changes;return this.changes=s.ContentChanges.empty(),e}getAdjacentNodesAddresses(e){let t=this.graph.adjacentNodes(e),r=[];return t.forEach(e=>{e instanceof p.RangeVertex?r.push((0,n.simpleCellRange)(e.start,e.end)):r.push(e.getAddress(this.lazilyTransformingAstService))}),r}exchangeGraphNode(e,t){this.graph.addNodeAndReturnId(t);let r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach(e=>{this.graph.hasNode(e)&&this.graph.addEdge(t,e)})}setArray(e,t){this.arrayMapping.setArray(e,t)}correctInfiniteRangesDependency(e){let t=this.graph.getInfiniteRanges().filter(({node:t})=>t.range.addressInRange(e));if(t.length<=0)return;let{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e),i=null!=n?n:this.graph.getNodeId(r);t.forEach(({id:e})=>{this.graph.addEdge(i,e)})}exchangeOrAddGraphNode(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNodeAndReturnId(t)}getArrayVerticesRelatedToRanges(e){let t=new Set;return e.forEach(e=>{this.graph.hasNode(e)&&this.graph.adjacentNodes(e).forEach(e=>{e instanceof p.ArrayVertex&&t.add(e)})}),t}correctInfiniteRangesDependenciesByRangeVertex(e){this.graph.getInfiniteRanges().forEach(({id:t,node:r})=>{let n=e.range.intersectionWith(r.range);void 0!==n&&n.addresses(this).forEach(e=>{let{vertex:r,id:n}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=n?n:r,t)})})}cleanAddressMappingUnderArray(e){for(let t of e.getRange().addresses(this)){let r=e.getArrayCellValue(t);this.getCell(t)===e?e.isLeftCorner(t)?this.changes.addChange(new a.CellError(a.ErrorType.REF),t,r):(this.addressMapping.removeCell(t),this.changes.addChange(u.EmptyValue,t,r)):this.changes.addChange(u.EmptyValue,t,r)}}*formulaDirectDependenciesToArray(e,t){var r;let[,i]=null!=(r=this.formulaDependencyQuery(e))?r:[];if(void 0!==i){for(let e of i)if(!(e instanceof c.NamedExpressionDependency||e instanceof n.AbsoluteCellRange)&&t.getRange().addressInRange(e)){let t=this.fetchCellOrCreateEmpty(e).vertex;yield[e,t]}}}*rangeDirectDependenciesToArray(e,t){let{restRange:r}=this.rangeMapping.findSmallerRange(e.range);for(let e of r.addresses(this))if(t.getRange().addressInRange(e)){let t=this.fetchCellOrCreateEmpty(e).vertex;yield[e,t]}}*adjacentArrayVertices(e){for(let t of this.graph.adjacentNodes(e))(t instanceof E.FormulaVertex||t instanceof p.RangeVertex)&&(yield t)}addStructuralNodesToChangeSet(){this.graph.markChangingWithStructureNodesAsDirty()}fixRangesWhenAddingRows(e,t,r){for(let i of Array.from(this.rangeMapping.rangesInSheet(e)))if(i.range.includesRow(t+r))if(i.bruteForce)for(let e of i.range.rangeWithSameWidth(t,r).addresses(this)){let{vertex:t,id:r}=this.fetchCellOrCreateEmpty(e);this.graph.addEdge(null!=r?r:t,i)}else{let e=i,t=this.rangeMapping.findSmallerRange(e.range);if(void 0!==t.smallerRangeVertex)continue;for(;void 0===t.smallerRangeVertex;){let r=new p.RangeVertex(n.AbsoluteCellRange.spanFrom(e.range.start,e.range.width(),e.range.height()-1));this.rangeMapping.setRange(r),this.graph.addNodeAndReturnId(r);let i=new n.AbsoluteCellRange((0,a.simpleCellAddress)(e.range.start.sheet,e.range.start.col,e.range.end.row),e.range.end);this.addAllFromRange(i,e),this.graph.addEdge(r,e),e=r,t=this.rangeMapping.findSmallerRange(e.range)}this.graph.addEdge(t.smallerRangeVertex,e),this.addAllFromRange(t.restRange,e),this.graph.removeEdge(t.smallerRangeVertex,i)}}addAllFromRange(e,t){for(let r of e.addresses(this)){let{vertex:e,id:n}=this.fetchCellOrCreateEmpty(r);this.graph.addEdge(null!=n?n:e,t)}}fixRangesWhenAddingColumns(e,t,r){for(let i of this.rangeMapping.rangesInSheet(e))if(i.range.includesColumn(t+r))for(let s of(i.bruteForce?i.range.rangeWithSameHeight(t,r):n.AbsoluteCellRange.spanFrom((0,a.simpleCellAddress)(e,t,i.range.end.row),r,1)).addresses(this)){let{vertex:e,id:t}=this.fetchCellOrCreateEmpty(s);this.graph.addEdge(null!=t?t:e,i)}}exchangeOrAddFormulaVertex(e){let t=e.getAddress(this.lazilyTransformingAstService),r=n.AbsoluteCellRange.spanFrom(t,e.width,e.height),i=this.shrinkPossibleArrayAndGetCell(t);if(e instanceof p.ArrayVertex&&this.setArray(r,e),this.exchangeOrAddGraphNode(i,e),this.addressMapping.setCell(t,e),e instanceof p.ArrayVertex){if(!this.isThereSpaceForArray(e))return;for(let t of r.addresses(this)){if(e.isLeftCorner(t))continue;let r=this.getCell(t);this.exchangeOrAddGraphNode(r,e)}}for(let t of r.addresses(this))this.addressMapping.setCell(t,e)}setAddressMappingForArrayVertex(e,t){if(this.addressMapping.setCell(t,e),!(e instanceof p.ArrayVertex))return;let r=n.AbsoluteCellRange.spanFromOrUndef(t,e.width,e.height);if(void 0!==r&&(this.setArray(r,e),this.isThereSpaceForArray(e)))for(let t of r.addresses(this))this.addressMapping.setCell(t,e)}truncateRanges(e,t){let{verticesToRemove:r,verticesToMerge:n,verticesWithChangedSize:i}=this.rangeMapping.truncateRanges(e,t);for(let[e,t]of n)this.mergeRangeVertices(e,t);for(let e of r)this.removeVertexAndCleanupDependencies(e);return i}fixArraysAfterAddingRow(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,r),!(t<=0))for(let[,n]of this.arrayMapping.arraysInRows(h.RowsSpan.fromRowStartAndEnd(e,t-1,t-1))){let i=n.getRange();for(let s=i.start.col;s<=i.end.col;++s)for(let o=t;o<=i.end.row;++o){let t=(0,a.simpleCellAddress)(e,s,o),i=(0,a.simpleCellAddress)(e,s,o+r),l=n.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(u.EmptyValue,i,l)}}}fixArraysAfterRemovingRows(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterRowByRows(e,t,-r),!(t<=0))for(let[,r]of this.arrayMapping.arraysInRows(h.RowsSpan.fromRowStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(let e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}fixArraysAfterAddingColumn(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,r),!(t<=0))for(let[,n]of this.arrayMapping.arraysInCols(h.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1))){let i=n.getRange();for(let s=i.start.row;s<=i.end.row;++s)for(let o=t;o<=i.end.col;++o){let t=(0,a.simpleCellAddress)(e,o,s),i=(0,a.simpleCellAddress)(e,o+r,s),l=n.getArrayCellValue(t);this.addressMapping.moveCell(i,t),this.changes.addChange(u.EmptyValue,i,l)}}}fixArraysAfterRemovingColumns(e,t,r){if(this.arrayMapping.moveArrayVerticesAfterColumnByColumns(e,t,-r),!(t<=0))for(let[,r]of this.arrayMapping.arraysInCols(h.ColumnsSpan.fromColumnStartAndEnd(e,t-1,t-1)))if(this.isThereSpaceForArray(r))for(let e of r.getRange().addresses(this))this.addressMapping.setCell(e,r);else this.setNoSpaceIfArray(r)}shrinkPossibleArrayAndGetCell(e){let t=this.getCell(e);return t instanceof p.ArrayVertex?(this.setNoSpaceIfArray(t),this.getCell(e)):t}setNoSpaceIfArray(e){e instanceof p.ArrayVertex&&(this.shrinkArrayToCorner(e),e.setNoSpace())}removeVertex(e){this.removeVertexAndCleanupDependencies(e),e instanceof p.RangeVertex&&this.rangeMapping.removeRange(e)}mergeRangeVertices(e,t){let r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.removeEdgeIfExists(e,t),r.forEach(t=>{this.graph.hasNode(t)&&this.graph.addEdge(e,t)})}removeVertexAndCleanupDependencies(e){let t=new Set(this.graph.removeNode(e));for(;t.size>0;){let e=t.values().next().value;t.delete(e);let[r,n]=e;this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof p.RangeVertex||n instanceof p.EmptyCellVertex)&&this.graph.removeNode(n).forEach(e=>t.add(e)),n instanceof p.RangeVertex?this.rangeMapping.removeRange(n):n instanceof p.EmptyCellVertex&&this.addressMapping.removeCell(r))}}}t.DependencyGraph=R},function(e,t,r){"use strict";t.__esModule=!0,t.filterDependenciesOutOfScope=t.absolutizeDependencies=void 0;var n=r(72),i=r(73),a=r(77);t.absolutizeDependencies=(e,t)=>e.map(e=>e.absolutize(t)),t.filterDependenciesOutOfScope=e=>e.filter(e=>e instanceof a.NamedExpressionDependency||(e instanceof n.AbsoluteCellRange?!((0,i.invalidSimpleCellAddress)(e.start)||(0,i.invalidSimpleCellAddress)(e.end)):!(0,i.invalidSimpleCellAddress)(e)))},function(e,t,r){"use strict";t.__esModule=!0,t.simpleCellRangeToString=t.simpleCellRangeFromString=t.simpleCellAddressToString=t.simpleCellAddressFromString=t.collectDependencies=t.cellAddressFromString=t.buildProcedureAst=t.buildParsingErrorAst=t.buildLexerConfig=t.buildCellRangeAst=t.buildCellErrorAst=t.Unparser=t.RowRangeDependency=t.ParsingErrorType=t.ParserWithCaching=t.NamedExpressionDependency=t.FormulaLexer=t.ColumnRangeDependency=t.CellRangeDependency=t.CellAddress=t.AstNodeType=t.AddressDependency=void 0;var n=r(78);t.cellAddressFromString=n.cellAddressFromString,t.simpleCellAddressFromString=n.simpleCellAddressFromString,t.simpleCellAddressToString=n.simpleCellAddressToString,t.simpleCellRangeFromString=n.simpleCellRangeFromString,t.simpleCellRangeToString=n.simpleCellRangeToString,t.CellAddress=r(79).CellAddress,t.ParserWithCaching=r(83).ParserWithCaching,t.collectDependencies=r(136).collectDependencies,t.buildLexerConfig=r(132).buildLexerConfig,t.FormulaLexer=r(130).FormulaLexer;var i=r(127);t.AstNodeType=i.AstNodeType,t.ParsingErrorType=i.ParsingErrorType,t.buildProcedureAst=i.buildProcedureAst,t.buildCellRangeAst=i.buildCellRangeAst,t.buildParsingErrorAst=i.buildParsingErrorAst,t.buildCellErrorAst=i.buildCellErrorAst,t.Unparser=r(135).Unparser;var a=r(137);t.AddressDependency=a.AddressDependency,t.CellRangeDependency=a.CellRangeDependency,t.ColumnRangeDependency=a.ColumnRangeDependency,t.RowRangeDependency=a.RowRangeDependency,t.NamedExpressionDependency=a.NamedExpressionDependency},function(e,t,r){"use strict";t.__esModule=!0,t.columnAddressFromString=t.cellAddressFromString=void 0,t.columnIndexToLabel=f,t.rowAddressFromString=void 0,t.sheetIndexToString=E,t.simpleCellRangeToString=t.simpleCellRangeFromString=t.simpleCellAddressToString=t.simpleCellAddressFromString=void 0;var n=r(72),i=r(73),a=r(79),s=r(80),o=r(82),u=r(81);let l=RegExp(`^(${o.SHEET_NAME_PATTERN})?(\\${o.ABSOLUTE_OPERATOR}?)([A-Za-z]+)(\\${o.ABSOLUTE_OPERATOR}?)([0-9]+)$`),c=RegExp(`^(${o.SHEET_NAME_PATTERN})?(\\${o.ABSOLUTE_OPERATOR}?)([A-Za-z]+)$`),h=RegExp(`^(${o.SHEET_NAME_PATTERN})?(\\${o.ABSOLUTE_OPERATOR}?)([0-9]+)$`),d=RegExp(`^${o.UNQUOTED_SHEET_NAME_PATTERN}$`);t.cellAddressFromString=(e,t,r)=>{let n=l.exec(t),i=g(n[6]),s=T(n,e);if(void 0===s)return;null===s&&(s=void 0);let u=Number(n[8])-1;return n[5]===o.ABSOLUTE_OPERATOR&&n[7]===o.ABSOLUTE_OPERATOR?a.CellAddress.absolute(i,u,s):n[5]===o.ABSOLUTE_OPERATOR?a.CellAddress.absoluteCol(i,u-r.row,s):n[7]===o.ABSOLUTE_OPERATOR?a.CellAddress.absoluteRow(i-r.col,u,s):a.CellAddress.relative(i-r.col,u-r.row,s)},t.columnAddressFromString=(e,t,r)=>{let n=c.exec(t),i=T(n,e);if(void 0===i)return;null===i&&(i=void 0);let a=g(n[6]);return n[5]===o.ABSOLUTE_OPERATOR?s.ColumnAddress.absolute(a,i):s.ColumnAddress.relative(a-r.col,i)},t.rowAddressFromString=(e,t,r)=>{let n=h.exec(t),i=T(n,e);if(void 0===i)return;null===i&&(i=void 0);let a=Number(n[6])-1;return n[5]===o.ABSOLUTE_OPERATOR?u.RowAddress.absolute(a,i):u.RowAddress.relative(a-r.row,i)};let p=(e,t,r)=>{let n=l.exec(t);if(!n)return;let a=g(n[6]),s=T(n,e);if(void 0===s)return;null===s&&(s=r);let o=Number(n[8])-1;return(0,i.simpleCellAddress)(s,a,o)};t.simpleCellAddressFromString=p,t.simpleCellRangeFromString=(e,t,r)=>{let i=t.split(o.RANGE_OPERATOR);if(2!==i.length)return;let[a,s]=i,u=p(e,a,r);if(void 0===u)return;let l=p(e,s,u.sheet);return void 0!==l&&u.sheet===l.sheet?(0,n.simpleCellRange)(u,l):void 0};let m=(e,t,r)=>{let n=f(t.col),i=E(t.sheet,e);if(void 0!==i)return r!==t.sheet?`${i}!${n}${t.row+1}`:`${n}${t.row+1}`};function g(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((e,t)=>26*e+(t.toUpperCase().charCodeAt(0)-64),0)-1}function f(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function E(e,t){let r=t(e);if(void 0!==r)return d.test(r)?r:(r=r.replace(/'/g,"''"),`'${r}'`)}function T(e,t){var r;let n=null!=(r=e[3])?r:e[2];return n?t(n=n.replace(/''/g,"'")):null}t.simpleCellAddressToString=m,t.simpleCellRangeToString=(e,t,r)=>{let n=m(e,t.start,r),i=m(e,t.end,t.start.sheet);return void 0===n||void 0===i?void 0:`${n}${o.RANGE_OPERATOR}${i}`}},function(e,t,r){"use strict";t.__esModule=!0,t.CellReferenceType=t.CellAddress=void 0;var n,i,a=r(73),s=r(78),o=r(80),u=r(81);(n=i||(t.CellReferenceType=i={})).CELL_REFERENCE_RELATIVE="CELL_REFERENCE",n.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",n.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",n.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW";class l{constructor(e,t,r,n){this.col=e,this.row=t,this.type=r,this.sheet=n}static fromColAndRow(e,t,r){return(e.isColumnAbsolute()&&t.isRowAbsolute()?l.absolute.bind(this):e.isColumnAbsolute()?l.absoluteCol.bind(this):t.isRowAbsolute()?l.absoluteRow.bind(this):l.relative.bind(this))(e.col,t.row,r)}static relative(e,t,r){return new l(e,t,i.CELL_REFERENCE_RELATIVE,r)}static absolute(e,t,r){return new l(e,t,i.CELL_REFERENCE_ABSOLUTE,r)}static absoluteCol(e,t,r){return new l(e,t,i.CELL_REFERENCE_ABSOLUTE_COL,r)}static absoluteRow(e,t,r){return new l(e,t,i.CELL_REFERENCE_ABSOLUTE_ROW,r)}toSimpleCellAddress(e){let t=(0,a.absoluteSheetReference)(this,e);return this.type===i.CELL_REFERENCE_ABSOLUTE?(0,a.simpleCellAddress)(t,this.col,this.row):this.type===i.CELL_REFERENCE_ABSOLUTE_ROW?(0,a.simpleCellAddress)(t,e.col+this.col,this.row):this.type===i.CELL_REFERENCE_ABSOLUTE_COL?(0,a.simpleCellAddress)(t,this.col,e.row+this.row):(0,a.simpleCellAddress)(t,e.col+this.col,e.row+this.row)}toColumnAddress(){let e=this.isColumnRelative()?o.ReferenceType.RELATIVE:o.ReferenceType.ABSOLUTE;return new o.ColumnAddress(e,this.col,this.sheet)}toRowAddress(){let e=this.isRowRelative()?o.ReferenceType.RELATIVE:o.ReferenceType.ABSOLUTE;return new u.RowAddress(e,this.row,this.sheet)}toSimpleColumnAddress(e){let t=(0,a.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r+=e.col),(0,a.simpleColumnAddress)(t,r)}toSimpleRowAddress(e){let t=(0,a.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r+=e.row),(0,a.simpleRowAddress)(t,r)}isRowAbsolute(){return this.type===i.CELL_REFERENCE_ABSOLUTE||this.type===i.CELL_REFERENCE_ABSOLUTE_ROW}isColumnAbsolute(){return this.type===i.CELL_REFERENCE_ABSOLUTE||this.type===i.CELL_REFERENCE_ABSOLUTE_COL}isColumnRelative(){return this.type===i.CELL_REFERENCE_RELATIVE||this.type===i.CELL_REFERENCE_ABSOLUTE_ROW}isRowRelative(){return this.type===i.CELL_REFERENCE_RELATIVE||this.type===i.CELL_REFERENCE_ABSOLUTE_COL}isAbsolute(){return this.type===i.CELL_REFERENCE_ABSOLUTE&&void 0!==this.sheet}shiftedByRows(e){return new l(this.col,this.row+e,this.type,this.sheet)}shiftedByColumns(e){return new l(this.col+e,this.row,this.type,this.sheet)}moved(e,t,r){let n=void 0===this.sheet?void 0:e;return new l(this.col+t,this.row+r,this.type,n)}withSheet(e){return new l(this.col,this.row,this.type,e)}isInvalid(e){return(0,a.invalidSimpleCellAddress)(this.toSimpleCellAddress(e))}shiftRelativeDimensions(e,t){return new l(this.isColumnAbsolute()?this.col:this.col+e,this.isRowAbsolute()?this.row:this.row+t,this.type,this.sheet)}shiftAbsoluteDimensions(e,t){return new l(this.isColumnRelative()?this.col:this.col+e,this.isRowRelative()?this.row:this.row+t,this.type,this.sheet)}hash(e){let t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case i.CELL_REFERENCE_RELATIVE:return`${t}#${this.row}R${this.col}`;case i.CELL_REFERENCE_ABSOLUTE:return`${t}#${this.row}A${this.col}`;case i.CELL_REFERENCE_ABSOLUTE_COL:return`${t}#${this.row}AC${this.col}`;case i.CELL_REFERENCE_ABSOLUTE_ROW:return`${t}#${this.row}AR${this.col}`}}unparse(e){let t=this.toSimpleCellAddress(e);if((0,a.invalidSimpleCellAddress)(t))return;let r=(0,s.columnIndexToLabel)(t.col),n=this.type===i.CELL_REFERENCE_ABSOLUTE||this.type===i.CELL_REFERENCE_ABSOLUTE_ROW?"$":"";return`${this.type===i.CELL_REFERENCE_ABSOLUTE||this.type===i.CELL_REFERENCE_ABSOLUTE_COL?"$":""}${r}${n}${t.row+1}`}exceedsSheetSizeLimits(e,t){return this.row>=t||this.col>=e}}t.CellAddress=l},function(e,t,r){"use strict";t.__esModule=!0,t.ReferenceType=t.ColumnAddress=void 0;var n,i,a=r(73),s=r(78);(n=i||(t.ReferenceType=i={})).RELATIVE="RELATIVE",n.ABSOLUTE="ABSOLUTE";class o{constructor(e,t,r){this.type=e,this.col=t,this.sheet=r}static absolute(e,t){return new o(i.ABSOLUTE,e,t)}static relative(e,t){return new o(i.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleColumnAddress(e).col-r.toSimpleColumnAddress(e).col}isColumnAbsolute(){return this.type===i.ABSOLUTE}isColumnRelative(){return this.type===i.RELATIVE}isAbsolute(){return this.type===i.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){let n=void 0===this.sheet?void 0:e;return new o(this.type,this.col+t,n)}shiftedByColumns(e){return new o(this.type,this.col+e,this.sheet)}toSimpleColumnAddress(e){let t=(0,a.absoluteSheetReference)(this,e),r=this.col;return this.isColumnRelative()&&(r=e.col+this.col),(0,a.simpleColumnAddress)(t,r)}shiftRelativeDimensions(e,t){let r=this.isColumnRelative()?this.col+e:this.col;return new o(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){let r=this.isColumnAbsolute()?this.col+e:this.col;return new o(this.type,r,this.sheet)}withSheet(e){return new o(this.type,this.col,e)}isInvalid(e){return this.toSimpleColumnAddress(e).col<0}hash(e){let t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case i.RELATIVE:return`${t}#COLR${this.col}`;case i.ABSOLUTE:return`${t}#COLA${this.col}`}}unparse(e){let t=this.toSimpleColumnAddress(e);if((0,a.invalidSimpleColumnAddress)(t))return;let r=(0,s.columnIndexToLabel)(t.col);return`${this.type===i.ABSOLUTE?"$":""}${r}`}exceedsSheetSizeLimits(e){return this.col>=e}}t.ColumnAddress=o},function(e,t,r){"use strict";t.__esModule=!0,t.RowAddress=void 0;var n=r(73),i=r(80);class a{constructor(e,t,r){this.type=e,this.row=t,this.sheet=r}static absolute(e,t){return new a(i.ReferenceType.ABSOLUTE,e,t)}static relative(e,t){return new a(i.ReferenceType.RELATIVE,e,t)}static compareByAbsoluteAddress(e){return(t,r)=>t.toSimpleRowAddress(e).row-r.toSimpleRowAddress(e).row}isRowAbsolute(){return this.type===i.ReferenceType.ABSOLUTE}isRowRelative(){return this.type===i.ReferenceType.RELATIVE}isAbsolute(){return this.type===i.ReferenceType.ABSOLUTE&&void 0!==this.sheet}moved(e,t,r){let n=void 0===this.sheet?void 0:e;return new a(this.type,this.row+r,n)}shiftedByRows(e){return new a(this.type,this.row+e,this.sheet)}toSimpleRowAddress(e){let t=(0,n.absoluteSheetReference)(this,e),r=this.row;return this.isRowRelative()&&(r=e.row+this.row),(0,n.simpleRowAddress)(t,r)}shiftRelativeDimensions(e,t){let r=this.isRowRelative()?this.row+t:this.row;return new a(this.type,r,this.sheet)}shiftAbsoluteDimensions(e,t){let r=this.isRowAbsolute()?this.row+t:this.row;return new a(this.type,r,this.sheet)}withSheet(e){return new a(this.type,this.row,e)}isInvalid(e){return this.toSimpleRowAddress(e).row<0}hash(e){let t=e&&void 0!==this.sheet?"#"+this.sheet:"";switch(this.type){case i.ReferenceType.RELATIVE:return`${t}#ROWR${this.row}`;case i.ReferenceType.ABSOLUTE:return`${t}#ROWA${this.row}`}}unparse(e){let t=this.toSimpleRowAddress(e);if(!(0,n.invalidSimpleRowAddress)(t))return`${this.type===i.ReferenceType.ABSOLUTE?"$":""}${t.row+1}`}exceedsSheetSizeLimits(e){return this.row>=e}}t.RowAddress=a},function(e,t,r){"use strict";t.__esModule=!0,t.UNQUOTED_SHEET_NAME_PATTERN=t.UNICODE_LETTER_PATTERN=t.SHEET_NAME_PATTERN=t.ROW_REFERENCE_PATTERN=t.RANGE_OPERATOR=t.R1C1_CELL_REFERENCE_PATTERN=t.QUOTED_SHEET_NAME_PATTERN=t.ODFF_WHITESPACE_PATTERN=t.NON_RESERVED_CHARACTER_PATTERN=t.NAMED_EXPRESSION_PATTERN=t.COLUMN_REFERENCE_PATTERN=t.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=t.CELL_REFERENCE_PATTERN=t.ALL_WHITESPACE_PATTERN=t.ALL_UNICODE_LETTERS_ARRAY=t.ALL_DIGITS_ARRAY=t.ABSOLUTE_OPERATOR=void 0,t.RANGE_OPERATOR=":";let n=t.ABSOLUTE_OPERATOR="$",i=(t.ALL_WHITESPACE_PATTERN="\\s+",t.ODFF_WHITESPACE_PATTERN="[ \\t\\n\\r]+",t.UNICODE_LETTER_PATTERN="A-Za-zÀ-ʯ"),a=t.NON_RESERVED_CHARACTER_PATTERN=i+"0-9_.",s=t.UNQUOTED_SHEET_NAME_PATTERN=`[${i}0-9_]+`,o=t.QUOTED_SHEET_NAME_PATTERN="'(((?!').|'')*)'",u=t.SHEET_NAME_PATTERN=`(${s}|${o})!`,l=t.CELL_REFERENCE_PATTERN=`(${u})?\\${n}?[A-Za-z]+\\${n}?[0-9]+`;t.COLUMN_REFERENCE_PATTERN=`(${u})?\\${n}?[A-Za-z]+`,t.ROW_REFERENCE_PATTERN=`(${u})?\\${n}?[0-9]+`,t.R1C1_CELL_REFERENCE_PATTERN="[rR][0-9]*[cC][0-9]*",t.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN=`(${l})[^${a}]`,t.NAMED_EXPRESSION_PATTERN=`[${i}_][${a}]*`,t.ALL_DIGITS_ARRAY=["0","1","2","3","4","5","6","7","8","9"],t.ALL_UNICODE_LETTERS_ARRAY=[...Array.from(Array(26)).map((e,t)=>t+65),...Array.from(Array(26)).map((e,t)=>t+97),...Array.from(Array(496)).map((e,t)=>t+192)].map(e=>String.fromCharCode(e))},function(e,t,r){"use strict";t.__esModule=!0,t.ParserWithCaching=void 0,r(2);var n=r(84),i=r(73),a=r(77),s=r(78),o=r(127),u=r(128),l=r(129),c=r(130),h=r(132),d=r(135),p=r(80),m=r(81);class g{constructor(e,t,r){this.config=e,this.functionRegistry=t,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=(0,h.buildLexerConfig)(e),this.lexer=new c.FormulaLexer(this.lexerConfig),this.formulaParser=new c.FormulaParser(this.lexerConfig,this.sheetMapping),this.cache=new l.Cache(this.functionRegistry)}parse(e,t){this.formulaAddress=t;let r=this.tokenizeFormula(e);if(r.errors.length>0){let e=r.errors.map(e=>({type:o.ParsingErrorType.LexingError,message:e.message}));return{ast:(0,a.buildParsingErrorAst)(),errors:e,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}let n=this.computeHashFromTokens(r.tokens,t),i=this.cache.get(n);if(void 0!==i)++this.statsCacheUsed;else{let e=this.bindWhitespacesToTokens(r.tokens),a=this.formulaParser.parseFromTokens(e,t);if(a.errors.length>0)return Object.assign(Object.assign({},a),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(n,a.ast)}let{ast:s,hasVolatileFunction:u,hasStructuralChangeFunction:l}=i,c=this.convertReversedRangesToRegularRanges(s);return{ast:c,errors:[],hasVolatileFunction:u,hasStructuralChangeFunction:l,dependencies:(0,a.collectDependencies)(c,this.functionRegistry)}}convertReversedRangesToRegularRanges(e){switch(e.type){case a.AstNodeType.EMPTY:case a.AstNodeType.NUMBER:case a.AstNodeType.STRING:case a.AstNodeType.ERROR:case a.AstNodeType.ERROR_WITH_RAW_INPUT:case a.AstNodeType.CELL_REFERENCE:case a.AstNodeType.NAMED_EXPRESSION:return e;case a.AstNodeType.CELL_RANGE:{let{start:t,end:r}=e,n=this.orderCellRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case a.AstNodeType.COLUMN_RANGE:{let{start:t,end:r}=e,n=this.orderColumnRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case a.AstNodeType.ROW_RANGE:{let{start:t,end:r}=e,n=this.orderRowRangeEnds(t,r);return Object.assign(Object.assign({},e),{start:n.start,end:n.end})}case a.AstNodeType.PERCENT_OP:case a.AstNodeType.PLUS_UNARY_OP:case a.AstNodeType.MINUS_UNARY_OP:{let t=this.convertReversedRangesToRegularRanges(e.value);return Object.assign(Object.assign({},e),{value:t})}case a.AstNodeType.CONCATENATE_OP:case a.AstNodeType.EQUALS_OP:case a.AstNodeType.NOT_EQUAL_OP:case a.AstNodeType.LESS_THAN_OP:case a.AstNodeType.GREATER_THAN_OP:case a.AstNodeType.LESS_THAN_OR_EQUAL_OP:case a.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case a.AstNodeType.MINUS_OP:case a.AstNodeType.PLUS_OP:case a.AstNodeType.TIMES_OP:case a.AstNodeType.DIV_OP:case a.AstNodeType.POWER_OP:{let t=this.convertReversedRangesToRegularRanges(e.left),r=this.convertReversedRangesToRegularRanges(e.right);return Object.assign(Object.assign({},e),{left:t,right:r})}case a.AstNodeType.PARENTHESIS:{let t=this.convertReversedRangesToRegularRanges(e.expression);return Object.assign(Object.assign({},e),{expression:t})}case a.AstNodeType.FUNCTION_CALL:{let t=e.args.map(e=>this.convertReversedRangesToRegularRanges(e));return Object.assign(Object.assign({},e),{args:t})}case a.AstNodeType.ARRAY:{let t=e.args.map(e=>e.map(e=>this.convertReversedRangesToRegularRanges(e)));return Object.assign(Object.assign({},e),{args:t})}}}orderCellRangeEnds(e,t){let r=[e,t],[n,i]=r.map(e=>e.toColumnAddress()).sort(p.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[s,o]=r.map(e=>e.toRowAddress()).sort(m.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[u,l]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:a.CellAddress.fromColAndRow(n,s,u),end:a.CellAddress.fromColAndRow(i,o,l)}}orderColumnRangeEnds(e,t){let r=[e,t],[n,i]=r.sort(p.ColumnAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new p.ColumnAddress(n.type,n.col,a),end:new p.ColumnAddress(i.type,i.col,s)}}orderRowRangeEnds(e,t){let r=[e,t],[n,i]=r.sort(m.RowAddress.compareByAbsoluteAddress(this.formulaAddress)),[a,s]=r.map(e=>e.sheet).sort(g.compareSheetIds.bind(this));return{start:new m.RowAddress(n.type,n.row,a),end:new m.RowAddress(i.type,i.row,s)}}static compareSheetIds(e,t){return(e=null!=e?e:1/0)-(t=null!=t?t:1/0)}fetchCachedResultForAst(e){let t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}fetchCachedResult(e){let t=this.cache.get(e);if(void 0===t)throw Error("There is no AST with such key in the cache");{let{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:n,relativeDependencies:i}=t;return{ast:e,errors:[],hasVolatileFunction:r,hasStructuralChangeFunction:n,dependencies:i}}}computeHashFromTokens(e,t){var r;let i="",a=0;for(;a<e.length;){let o=e[a];if((0,n.tokenMatcher)(o,h.CellReference)){let e=(0,s.cellAddressFromString)(this.sheetMapping,o.image,t);i=void 0===e?i.concat(o.image):i.concat(e.hash(!0))}else if((0,n.tokenMatcher)(o,h.ProcedureName)){let e=o.image.toUpperCase().slice(0,-1),t=null!=(r=this.lexerConfig.functionMapping[e])?r:e;i=i.concat(t,"(")}else if((0,n.tokenMatcher)(o,h.ColumnRange)){let[e,r]=o.image.split(":"),n=(0,s.columnAddressFromString)(this.sheetMapping,e,t),a=(0,s.columnAddressFromString)(this.sheetMapping,r,t);i=void 0===n||void 0===a?i.concat("!REF"):i.concat(n.hash(!0),":",a.hash(!0))}else if((0,n.tokenMatcher)(o,h.RowRange)){let[e,r]=o.image.split(":"),n=(0,s.rowAddressFromString)(this.sheetMapping,e,t),a=(0,s.rowAddressFromString)(this.sheetMapping,r,t);i=void 0===n||void 0===a?i.concat("!REF"):i.concat(n.hash(!0),":",a.hash(!0))}else i=i.concat(o.image);a++}return i}rememberNewAst(e){let t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}computeHashFromAst(e){return"="+this.computeHashOfAstNode(e)}computeHashOfAstNode(e){switch(e.type){case a.AstNodeType.EMPTY:return e.leadingWhitespace||"";case a.AstNodeType.NUMBER:return(0,o.imageWithWhitespace)((0,d.formatNumber)(e.value,this.config.decimalSeparator),e.leadingWhitespace);case a.AstNodeType.STRING:return(0,o.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case a.AstNodeType.NAMED_EXPRESSION:return(0,o.imageWithWhitespace)(e.expressionName,e.leadingWhitespace);case a.AstNodeType.FUNCTION_CALL:{let t=e.args.map(e=>this.computeHashOfAstNode(e)).join(this.config.functionArgSeparator),r=e.procedureName+"("+t+(0,o.imageWithWhitespace)(")",e.internalWhitespace);return(0,o.imageWithWhitespace)(r,e.leadingWhitespace)}case a.AstNodeType.CELL_REFERENCE:return(0,o.imageWithWhitespace)(e.reference.hash(!0),e.leadingWhitespace);case a.AstNodeType.COLUMN_RANGE:case a.AstNodeType.ROW_RANGE:case a.AstNodeType.CELL_RANGE:{let t=e.start.hash(e.sheetReferenceType!==o.RangeSheetReferenceType.RELATIVE),r=e.end.hash(e.sheetReferenceType===o.RangeSheetReferenceType.BOTH_ABSOLUTE);return(0,o.imageWithWhitespace)(t+":"+r,e.leadingWhitespace)}case a.AstNodeType.MINUS_UNARY_OP:return(0,o.imageWithWhitespace)("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PLUS_UNARY_OP:return(0,o.imageWithWhitespace)("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case a.AstNodeType.PERCENT_OP:return this.computeHashOfAstNode(e.value)+(0,o.imageWithWhitespace)("%",e.leadingWhitespace);case a.AstNodeType.ERROR:{let t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:i.ErrorType.ERROR);return(0,o.imageWithWhitespace)(t,e.leadingWhitespace)}case a.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,o.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case a.AstNodeType.ARRAY:{let t=e.args.map(e=>e.map(e=>this.computeHashOfAstNode(e)).join(",")).join(";");return(0,o.imageWithWhitespace)("{"+t+(0,o.imageWithWhitespace)("}",e.internalWhitespace),e.leadingWhitespace)}case a.AstNodeType.PARENTHESIS:{let t="("+this.computeHashOfAstNode(e.expression)+(0,o.imageWithWhitespace)(")",e.internalWhitespace);return(0,o.imageWithWhitespace)(t,e.leadingWhitespace)}default:return this.computeHashOfAstNode(e.left)+(0,o.imageWithWhitespace)(u.binaryOpTokenMap[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}bindWhitespacesToTokens(e){let t=[],r=e[0];(0,n.tokenMatcher)(r,this.lexerConfig.WhiteSpace)||t.push(r);for(let r=1;r<e.length;++r){let i=e[r];if((0,n.tokenMatcher)(i,this.lexerConfig.WhiteSpace))continue;let a=e[r-1];(0,n.tokenMatcher)(a,this.lexerConfig.WhiteSpace)&&(i.leadingWhitespace=a),t.push(i)}return t}tokenizeFormula(e){return this.lexer.tokenizeFormula(e)}}t.ParserWithCaching=g},function(e,t,r){"use strict";r.r(t),r.d(t,"clearCache",function(){return g});var n=r(85);r.d(t,"VERSION",function(){return n.VERSION});var i=r(86);r.d(t,"Parser",function(){return i.Parser}),r.d(t,"CstParser",function(){return i.CstParser}),r.d(t,"EmbeddedActionsParser",function(){return i.EmbeddedActionsParser}),r.d(t,"ParserDefinitionErrorType",function(){return i.ParserDefinitionErrorType}),r.d(t,"EMPTY_ALT",function(){return i.EMPTY_ALT});var a=r(92);r.d(t,"Lexer",function(){return a.Lexer}),r.d(t,"LexerDefinitionErrorType",function(){return a.LexerDefinitionErrorType});var s=r(91);r.d(t,"createToken",function(){return s.createToken}),r.d(t,"createTokenInstance",function(){return s.createTokenInstance}),r.d(t,"EOF",function(){return s.EOF}),r.d(t,"tokenLabel",function(){return s.tokenLabel}),r.d(t,"tokenMatcher",function(){return s.tokenMatcher}),r.d(t,"tokenName",function(){return s.tokenName});var o=r(105);r.d(t,"defaultGrammarResolverErrorProvider",function(){return o.defaultGrammarResolverErrorProvider}),r.d(t,"defaultGrammarValidatorErrorProvider",function(){return o.defaultGrammarValidatorErrorProvider}),r.d(t,"defaultParserErrorProvider",function(){return o.defaultParserErrorProvider});var u=r(112);r.d(t,"EarlyExitException",function(){return u.EarlyExitException}),r.d(t,"isRecognitionException",function(){return u.isRecognitionException}),r.d(t,"MismatchedTokenException",function(){return u.MismatchedTokenException}),r.d(t,"NotAllInputParsedException",function(){return u.NotAllInputParsedException}),r.d(t,"NoViableAltException",function(){return u.NoViableAltException});var l=r(98);r.d(t,"defaultLexerErrorProvider",function(){return l.defaultLexerErrorProvider});var c=r(90);r.d(t,"Alternation",function(){return c.Alternation}),r.d(t,"Flat",function(){return c.Flat}),r.d(t,"NonTerminal",function(){return c.NonTerminal}),r.d(t,"Option",function(){return c.Option}),r.d(t,"Repetition",function(){return c.Repetition}),r.d(t,"RepetitionMandatory",function(){return c.RepetitionMandatory}),r.d(t,"RepetitionMandatoryWithSeparator",function(){return c.RepetitionMandatoryWithSeparator}),r.d(t,"RepetitionWithSeparator",function(){return c.RepetitionWithSeparator}),r.d(t,"Rule",function(){return c.Rule}),r.d(t,"Terminal",function(){return c.Terminal}),r.d(t,"serializeGrammar",function(){return c.serializeGrammar}),r.d(t,"serializeProduction",function(){return c.serializeProduction});var h=r(101);r.d(t,"GAstVisitor",function(){return h.GAstVisitor});var d=r(109);r.d(t,"assignOccurrenceIndices",function(){return d.assignOccurrenceIndices}),r.d(t,"resolveGrammar",function(){return d.resolveGrammar}),r.d(t,"validateGrammar",function(){return d.validateGrammar});var p=r(124);r.d(t,"createSyntaxDiagramsCode",function(){return p.createSyntaxDiagramsCode});var m=r(125);function g(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n	 It performs no action other than printing this message.\n	 Please avoid using it as it will be completely removed in the future")}r.d(t,"generateParserFactory",function(){return m.generateParserFactory}),r.d(t,"generateParserModule",function(){return m.generateParserModule})},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",function(){return n});var n="6.5.0"},function(e,t,r){"use strict";r.r(t),r.d(t,"END_OF_FILE",function(){return N}),r.d(t,"DEFAULT_PARSER_CONFIG",function(){return C}),r.d(t,"DEFAULT_RULE_CONFIG",function(){return O}),r.d(t,"ParserDefinitionErrorType",function(){return S}),r.d(t,"EMPTY_ALT",function(){return v}),r.d(t,"Parser",function(){return I}),r.d(t,"CstParser",function(){return M}),r.d(t,"EmbeddedActionsParser",function(){return b});var n,i,a=r(87),s=r(88),o=r(91),u=r(103),l=r(105),c=r(109),h=r(111),d=r(113),p=r(114),m=r(117),g=r(118),f=r(119),E=r(120),T=r(121),y=r(122),A=r(123),R=(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),N=Object(o.createTokenInstance)(o.EOF,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(N);var S,C=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:l.defaultParserErrorProvider,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),O=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function v(e){return void 0===e&&(e=void 0),function(){return e}}(n=S||(S={}))[n.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",n[n.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",n[n.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",n[n.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",n[n.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",n[n.LEFT_RECURSION=5]="LEFT_RECURSION",n[n.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",n[n.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",n[n.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",n[n.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",n[n.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",n[n.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",n[n.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",n[n.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",n[n.TOO_MANY_ALTS=14]="TOO_MANY_ALTS";var I=function(){function e(e,t){void 0===t&&(t=C),this.ignoredIssues=C.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1,this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),Object(a.has)(t,"ignoredIssues")&&t.ignoredIssues!==C.ignoredIssues&&Object(a.PRINT_WARNING)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n	Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(a.has)(t,"ignoredIssues")?t.ignoredIssues:C.ignoredIssues,this.skipValidations=Object(a.has)(t,"skipValidations")?t.skipValidations:C.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",function(){t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",function(){Object(a.toFastProperties)(t)}),t.TRACE_INIT("Grammar Recording",function(){try{t.enableRecording(),Object(a.forEach)(t.definedRulesNames,function(e){var r=t[e].originalGrammarAction,n=void 0;t.TRACE_INIT(e+" Rule",function(){n=t.topLevelRuleRecord(e,r)}),t.gastProductionsCache[e]=n})}finally{t.disableRecording()}});var n=[];if(t.TRACE_INIT("Grammar Resolving",function(){n=Object(c.resolveGrammar)({rules:Object(a.values)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,n)}),t.TRACE_INIT("Grammar Validations",function(){if(Object(a.isEmpty)(n)&&!1===t.skipValidations){var e=Object(c.validateGrammar)({rules:Object(a.values)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Object(a.values)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:l.defaultGrammarValidatorErrorProvider,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,e)}}),Object(a.isEmpty)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",function(){var e=Object(s.computeAllProdsFollows)(Object(a.values)(t.gastProductionsCache));t.resyncFollows=e}),t.TRACE_INIT("ComputeLookaheadFunctions",function(){t.preComputeLookaheadFunctions(Object(a.values)(t.gastProductionsCache))})),t.TRACE_INIT("expandAllNestedRuleNames",function(){var e=Object(u.expandAllNestedRuleNames)(Object(a.values)(t.gastProductionsCache),t.fullRuleNameToShort);t.allRuleNames=e.allRuleNames}),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(a.isEmpty)(t.definitionErrors))throw Error("Parser Definition Errors detected:\n "+Object(a.map)(t.definitionErrors,function(e){return e.message}).join("\n-------------------------------\n"))})},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Object(a.applyMixins)(I,[h.Recoverable,d.LooksAhead,p.TreeBuilder,m.LexerAdapter,f.RecognizerEngine,g.RecognizerApi,E.ErrorHandler,T.ContentAssist,y.GastRecorder,A.PerformanceTracer]);var M=function(e){function t(t,r){void 0===r&&(r=C);var n=Object(a.cloneObj)(r);return n.outputCst=!0,e.call(this,t,n)||this}return R(t,e),t}(I),b=function(e){function t(t,r){void 0===r&&(r=C);var n=Object(a.cloneObj)(r);return n.outputCst=!1,e.call(this,t,n)||this}return R(t,e),t}(I)},function(e,t,r){"use strict";function n(e){return e&&0===e.length}function i(e){return null==e?[]:Object.keys(e)}function a(e){for(var t=[],r=Object.keys(e),n=0;n<r.length;n++)t.push(e[r[n]]);return t}function s(e,t){for(var r=[],n=i(e),a=0;a<n.length;a++){var s=n[a];r.push(t.call(null,e[s],s))}return r}function o(e,t){for(var r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));return r}function u(e){return n(e)?void 0:e[0]}function l(e){var t=e&&e.length;return t?e[t-1]:void 0}function c(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t.call(null,e[r],r);else{if(!w(e))throw Error("non exhaustive match");var n=i(e);for(r=0;r<n.length;r++){var a=n[r],s=e[a];t.call(null,s,a)}}}function h(e){return"string"==typeof e}function d(e){return void 0===e}function p(e){return e instanceof Function}function m(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function g(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function f(e,t){var r=[];if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function E(e,t){return f(e,function(e){return!t(e)})}function T(e,t){for(var r=Object.keys(e),n={},i=0;i<r.length;i++){var a=r[i],s=e[a];t(s)&&(n[a]=s)}return n}function y(e,t){return!!w(e)&&e.hasOwnProperty(t)}function A(e,t){return void 0!==S(e,function(e){return e===t})}function R(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r]);return t}function N(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}function S(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t.call(null,n))return n}}function C(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n];t.call(null,i)&&r.push(i)}return r}function O(e,t,r){for(var n=Array.isArray(e),s=n?e:a(e),o=n?[]:i(e),u=r,l=0;l<s.length;l++)u=t.call(null,u,s[l],n?l:o[l]);return u}function v(e){return E(e,function(e){return null==e})}function I(e,t){void 0===t&&(t=function(e){return e});var r=[];return O(e,function(e,n){var i=t(n);return A(r,i)?e:(r.push(i),e.concat(n))},[])}function M(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=[null].concat(t);return Function.bind.apply(e,n)}function b(e){return Array.isArray(e)}function F(e){return e instanceof RegExp}function w(e){return e instanceof Object}function _(e,t){for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0}function L(e,t){return E(e,function(e){return A(t,e)})}function x(e,t){for(var r=0;r<e.length;r++)if(t(e[r]))return!0;return!1}function P(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return r;return -1}function U(e,t){var r=R(e);return r.sort(function(e,r){return t(e)-t(r)}),r}function V(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var r={},n=0;n<e.length;n++)r[e[n]]=t[n];return r}function D(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++)for(var a=t[n],s=i(a),o=0;o<s.length;o++){var u=s[o];e[u]=a[u]}return e}function B(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0;n<t.length;n++){var a=t[n];if(!d(a))for(var s=i(a),o=0;o<s.length;o++){var u=s[o];y(e,u)||(e[u]=a[u])}}return e}function k(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B.apply(null,[{}].concat(e))}function G(e,t){var r={};return c(e,function(e){var n=t(e),i=r[n];i?i.push(e):r[n]=[e]}),r}function j(e,t){for(var r=N(e),n=i(t),a=0;a<n.length;a++){var s=n[a],o=t[s];r[s]=o}return r}function W(){}function H(e){return e}function z(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push(void 0!==n?n:void 0)}return t}function Y(e){console&&console.error&&console.error("Error: "+e)}function X(e){console&&console.warn&&console.warn("Warning: "+e)}function K(){return"function"==typeof Map}function $(e,t){t.forEach(function(t){var r=t.prototype;Object.getOwnPropertyNames(r).forEach(function(n){if("constructor"!==n){var i=Object.getOwnPropertyDescriptor(r,n);i&&(i.get||i.set)?Object.defineProperty(e.prototype,n,i):e.prototype[n]=t.prototype[n]}})})}function q(e){function t(){}t.prototype=e;var r=new t;function n(){return typeof r.bar}return n(),n(),e}function Q(e){return e[e.length-1]}function Z(e){var t=(new Date).getTime(),r=e();return{time:(new Date).getTime()-t,value:r}}r.r(t),r.d(t,"isEmpty",function(){return n}),r.d(t,"keys",function(){return i}),r.d(t,"values",function(){return a}),r.d(t,"mapValues",function(){return s}),r.d(t,"map",function(){return o}),r.d(t,"flatten",function(){return function e(t){for(var r=[],n=0;n<t.length;n++){var i=t[n];Array.isArray(i)?r=r.concat(e(i)):r.push(i)}return r}}),r.d(t,"first",function(){return u}),r.d(t,"last",function(){return l}),r.d(t,"forEach",function(){return c}),r.d(t,"isString",function(){return h}),r.d(t,"isUndefined",function(){return d}),r.d(t,"isFunction",function(){return p}),r.d(t,"drop",function(){return m}),r.d(t,"dropRight",function(){return g}),r.d(t,"filter",function(){return f}),r.d(t,"reject",function(){return E}),r.d(t,"pick",function(){return T}),r.d(t,"has",function(){return y}),r.d(t,"contains",function(){return A}),r.d(t,"cloneArr",function(){return R}),r.d(t,"cloneObj",function(){return N}),r.d(t,"find",function(){return S}),r.d(t,"findAll",function(){return C}),r.d(t,"reduce",function(){return O}),r.d(t,"compact",function(){return v}),r.d(t,"uniq",function(){return I}),r.d(t,"partial",function(){return M}),r.d(t,"isArray",function(){return b}),r.d(t,"isRegExp",function(){return F}),r.d(t,"isObject",function(){return w}),r.d(t,"every",function(){return _}),r.d(t,"difference",function(){return L}),r.d(t,"some",function(){return x}),r.d(t,"indexOf",function(){return P}),r.d(t,"sortBy",function(){return U}),r.d(t,"zipObject",function(){return V}),r.d(t,"assign",function(){return D}),r.d(t,"assignNoOverwrite",function(){return B}),r.d(t,"defaults",function(){return k}),r.d(t,"groupBy",function(){return G}),r.d(t,"merge",function(){return j}),r.d(t,"NOOP",function(){return W}),r.d(t,"IDENTITY",function(){return H}),r.d(t,"packArray",function(){return z}),r.d(t,"PRINT_ERROR",function(){return Y}),r.d(t,"PRINT_WARNING",function(){return X}),r.d(t,"isES2015MapSupported",function(){return K}),r.d(t,"applyMixins",function(){return $}),r.d(t,"toFastProperties",function(){return q}),r.d(t,"peek",function(){return Q}),r.d(t,"timer",function(){return Z})},function(e,t,r){"use strict";r.r(t),r.d(t,"ResyncFollowsWalker",function(){return c}),r.d(t,"computeAllProdsFollows",function(){return h}),r.d(t,"buildBetweenProdsFollowPrefix",function(){return d}),r.d(t,"buildInProdFollowPrefix",function(){return p});var n,i=r(89),a=r(99),s=r(87),o=r(102),u=r(90),l=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c=function(e){function t(t){var r=e.call(this)||this;return r.topProd=t,r.follows={},r}return l(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,r){},t.prototype.walkProdRef=function(e,t,r){var n=d(e.referencedRule,e.idx)+this.topProd.name,i=t.concat(r),s=new u.Flat({definition:i}),o=Object(a.first)(s);this.follows[n]=o},t}(i.RestWalker);function h(e){var t={};return Object(s.forEach)(e,function(e){var r=new c(e).startWalking();Object(s.assign)(t,r)}),t}function d(e,t){return e.name+t+o.IN}function p(e){return e.terminalType.name+e.idx+o.IN}},function(e,t,r){"use strict";r.r(t),r.d(t,"RestWalker",function(){return a});var n=r(87),i=r(90),a=function(){function e(){}return e.prototype.walk=function(e,t){var r=this;void 0===t&&(t=[]),Object(n.forEach)(e.definition,function(a,s){var o=Object(n.drop)(e.definition,s+1);if(a instanceof i.NonTerminal)r.walkProdRef(a,o,t);else if(a instanceof i.Terminal)r.walkTerminal(a,o,t);else if(a instanceof i.Flat)r.walkFlat(a,o,t);else if(a instanceof i.Option)r.walkOption(a,o,t);else if(a instanceof i.RepetitionMandatory)r.walkAtLeastOne(a,o,t);else if(a instanceof i.RepetitionMandatoryWithSeparator)r.walkAtLeastOneSep(a,o,t);else if(a instanceof i.RepetitionWithSeparator)r.walkManySep(a,o,t);else if(a instanceof i.Repetition)r.walkMany(a,o,t);else{if(!(a instanceof i.Alternation))throw Error("non exhaustive match");r.walkOr(a,o,t)}})},e.prototype.walkTerminal=function(e,t,r){},e.prototype.walkProdRef=function(e,t,r){},e.prototype.walkFlat=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkOption=function(e,t,r){var n=t.concat(r);this.walk(e,n)},e.prototype.walkAtLeastOne=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkAtLeastOneSep=function(e,t,r){var n=s(e,t,r);this.walk(e,n)},e.prototype.walkMany=function(e,t,r){var n=[new i.Option({definition:e.definition})].concat(t,r);this.walk(e,n)},e.prototype.walkManySep=function(e,t,r){var n=s(e,t,r);this.walk(e,n)},e.prototype.walkOr=function(e,t,r){var a=this,s=t.concat(r);Object(n.forEach)(e.definition,function(e){var t=new i.Flat({definition:[e]});a.walk(t,s)})},e}();function s(e,t,r){return[new i.Option({definition:[new i.Terminal({terminalType:e.separator})].concat(e.definition)})].concat(t,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractProduction",function(){return o}),r.d(t,"NonTerminal",function(){return u}),r.d(t,"Rule",function(){return l}),r.d(t,"Flat",function(){return c}),r.d(t,"Option",function(){return h}),r.d(t,"RepetitionMandatory",function(){return d}),r.d(t,"RepetitionMandatoryWithSeparator",function(){return p}),r.d(t,"Repetition",function(){return m}),r.d(t,"RepetitionWithSeparator",function(){return g}),r.d(t,"Alternation",function(){return f}),r.d(t,"Terminal",function(){return E}),r.d(t,"serializeGrammar",function(){return T}),r.d(t,"serializeProduction",function(){return y});var n,i=r(87),a=r(91),s=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),o=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),Object(i.forEach)(this.definition,function(t){t.accept(e)})},e}(),u=function(e){function t(t){var r=e.call(this,[])||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(o),l=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.orgText="",Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),c=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.ignoreAmbiguities=!1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),h=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),d=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),p=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),m=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),g=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),f=function(e){function t(t){var r=e.call(this,t.definition)||this;return r.idx=1,r.ignoreAmbiguities=!1,r.hasPredicates=!1,Object(i.assign)(r,Object(i.pick)(t,function(e){return void 0!==e})),r}return s(t,e),t}(o),E=function(){function e(e){this.idx=1,Object(i.assign)(this,Object(i.pick)(e,function(e){return void 0!==e}))}return e.prototype.accept=function(e){e.visit(this)},e}();function T(e){return Object(i.map)(e,y)}function y(e){function t(e){return Object(i.map)(e,y)}if(e instanceof u)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof c)return{type:"Flat",definition:t(e.definition)};if(e instanceof h)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof d)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof p)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:y(new E({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof g)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:y(new E({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof m)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof f)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof E){var r={type:"Terminal",name:e.terminalType.name,label:Object(a.tokenLabel)(e.terminalType),idx:e.idx},n=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(r.pattern=Object(i.isRegExp)(n)?n.source:n),r}if(e instanceof l)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenLabel",function(){return s}),r.d(t,"tokenName",function(){return o}),r.d(t,"hasTokenLabel",function(){return u}),r.d(t,"createToken",function(){return l}),r.d(t,"EOF",function(){return c}),r.d(t,"createTokenInstance",function(){return h}),r.d(t,"tokenMatcher",function(){return d});var n=r(87),i=r(92),a=r(97);function s(e){return u(e)?e.LABEL:e.name}function o(e){return e.name}function u(e){return Object(n.isString)(e.LABEL)&&""!==e.LABEL}function l(e){var t=e.pattern,r={};if(r.name=e.name,Object(n.isUndefined)(t)||(r.PATTERN=t),Object(n.has)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";return Object(n.has)(e,"categories")&&(r.CATEGORIES=e.categories),Object(a.augmentTokenTypes)([r]),Object(n.has)(e,"label")&&(r.LABEL=e.label),Object(n.has)(e,"group")&&(r.GROUP=e.group),Object(n.has)(e,"pop_mode")&&(r.POP_MODE=e.pop_mode),Object(n.has)(e,"push_mode")&&(r.PUSH_MODE=e.push_mode),Object(n.has)(e,"longer_alt")&&(r.LONGER_ALT=e.longer_alt),Object(n.has)(e,"line_breaks")&&(r.LINE_BREAKS=e.line_breaks),Object(n.has)(e,"start_chars_hint")&&(r.START_CHARS_HINT=e.start_chars_hint),r}var c=l({name:"EOF",pattern:i.Lexer.NA});function h(e,t,r,n,i,a,s,o){return{image:t,startOffset:r,endOffset:n,startLine:i,endLine:a,startColumn:s,endColumn:o,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function d(e,t){return Object(a.tokenStructuredMatcher)(e,t)}Object(a.augmentTokenTypes)([c])},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerDefinitionErrorType",function(){return i}),r.d(t,"Lexer",function(){return h});var n,i,a=r(93),s=r(87),o=r(97),u=r(98),l=r(96);(n=i||(i={}))[n.MISSING_PATTERN=0]="MISSING_PATTERN",n[n.INVALID_PATTERN=1]="INVALID_PATTERN",n[n.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",n[n.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",n[n.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",n[n.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",n[n.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",n[n.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",n[n.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",n[n.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",n[n.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",n[n.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",n[n.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",n[n.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",n[n.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",n[n.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",n[n.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK";var c={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:u.defaultLexerErrorProvider,traceInitPerf:!1,skipValidations:!1};Object.freeze(c);var h=function(){function e(e,t){var r=this;if(void 0===t&&(t=c),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(s.merge)(c,t);var n=this.config.traceInitPerf;!0===n?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof n&&(this.traceInitMaxIdent=n,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",function(){var n,i=!0;r.TRACE_INIT("Lexer Config handling",function(){if(r.config.lineTerminatorsPattern===c.lineTerminatorsPattern)r.config.lineTerminatorsPattern=a.LineTerminatorOptimizedTester;else if(r.config.lineTerminatorCharacters===c.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');r.trackStartLines=/full|onlyStart/i.test(r.config.positionTracking),r.trackEndLines=/full/i.test(r.config.positionTracking),Object(s.isArray)(e)?((n={modes:{}}).modes[a.DEFAULT_MODE]=Object(s.cloneArr)(e),n[a.DEFAULT_MODE]=a.DEFAULT_MODE):(i=!1,n=Object(s.cloneObj)(e))}),!1===r.config.skipValidations&&(r.TRACE_INIT("performRuntimeChecks",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(a.performRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))}),r.TRACE_INIT("performWarningRuntimeChecks",function(){r.lexerDefinitionWarning=r.lexerDefinitionWarning.concat(Object(a.performWarningRuntimeChecks)(n,r.trackStartLines,r.config.lineTerminatorCharacters))})),n.modes=n.modes?n.modes:{},Object(s.forEach)(n.modes,function(e,t){n.modes[t]=Object(s.reject)(e,function(e){return Object(s.isUndefined)(e)})});var u=Object(s.keys)(n.modes);if(Object(s.forEach)(n.modes,function(e,n){r.TRACE_INIT("Mode: <"+n+"> processing",function(){var i;r.modes.push(n),!1===r.config.skipValidations&&r.TRACE_INIT("validatePatterns",function(){r.lexerDefinitionErrors=r.lexerDefinitionErrors.concat(Object(a.validatePatterns)(e,u))}),Object(s.isEmpty)(r.lexerDefinitionErrors)&&(Object(o.augmentTokenTypes)(e),r.TRACE_INIT("analyzeTokenTypes",function(){i=Object(a.analyzeTokenTypes)(e,{lineTerminatorCharacters:r.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:r.TRACE_INIT.bind(r)})}),r.patternIdxToConfig[n]=i.patternIdxToConfig,r.charCodeToPatternIdxToConfig[n]=i.charCodeToPatternIdxToConfig,r.emptyGroups=Object(s.merge)(r.emptyGroups,i.emptyGroups),r.hasCustom=i.hasCustom||r.hasCustom,r.canModeBeOptimized[n]=i.canBeOptimized)})}),r.defaultMode=n.defaultMode,!Object(s.isEmpty)(r.lexerDefinitionErrors)&&!r.config.deferDefinitionErrorsHandling)throw Error("Errors detected in definition of Lexer:\n"+Object(s.map)(r.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"));Object(s.forEach)(r.lexerDefinitionWarning,function(e){Object(s.PRINT_WARNING)(e.message)}),r.TRACE_INIT("Choosing sub-methods implementations",function(){if(a.SUPPORT_STICKY?(r.chopInput=s.IDENTITY,r.match=r.matchWithTest):(r.updateLastIndex=s.NOOP,r.match=r.matchWithExec),i&&(r.handleModes=s.NOOP),!1===r.trackStartLines&&(r.computeNewColumn=s.IDENTITY),!1===r.trackEndLines&&(r.updateTokenEndLineColumnLocation=s.NOOP),/full/i.test(r.config.positionTracking))r.createTokenInstance=r.createFullToken;else if(/onlyStart/i.test(r.config.positionTracking))r.createTokenInstance=r.createStartOnlyToken;else{if(!/onlyOffset/i.test(r.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+r.config.positionTracking+'"');r.createTokenInstance=r.createOffsetOnlyToken}r.hasCustom?(r.addToken=r.addTokenUsingPush,r.handlePayload=r.handlePayloadWithCustom):(r.addToken=r.addTokenUsingMemberAccess,r.handlePayload=r.handlePayloadNoCustom)}),r.TRACE_INIT("Failed Optimization Warnings",function(){var e=Object(s.reduce)(r.canModeBeOptimized,function(e,t,r){return!1===t&&e.push(r),e},[]);if(t.ensureOptimizations&&!Object(s.isEmpty)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n	 Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n	 Or inspect the console log for details on how to resolve these issues.')}),r.TRACE_INIT("clearRegExpParserCache",function(){Object(l.clearRegExpParserCache)()}),r.TRACE_INIT("toFastProperties",function(){Object(s.toFastProperties)(r)})})}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!Object(s.isEmpty)(this.lexerDefinitionErrors))throw Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+Object(s.map)(this.lexerDefinitionErrors,function(e){return e.message}).join("-----------------------\n"));return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var r,n,i,o,u,l,c,h,d,p,m,g,f,E,T=this,y=e,A=y.length,R=0,N=0,S=Array(this.hasCustom?0:Math.floor(e.length/10)),C=[],O=this.trackStartLines?1:void 0,v=this.trackStartLines?1:void 0,I=Object(a.cloneEmptyGroups)(this.emptyGroups),M=this.trackStartLines,b=this.config.lineTerminatorsPattern,F=0,w=[],_=[],L=[],x=[];Object.freeze(x);var P=void 0;function U(){return w}function V(e){var t=_[Object(a.charCodeToOptimizedIndex)(e)];return void 0===t?x:t}var D,B=function(e){if(1===L.length&&void 0===e.tokenType.PUSH_MODE){var t=T.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);C.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{L.pop();var r=Object(s.last)(L);w=T.patternIdxToConfig[r],_=T.charCodeToPatternIdxToConfig[r],F=w.length;var n=T.canModeBeOptimized[r]&&!1===T.config.safeMode;P=_&&n?V:U}};function k(e){L.push(e),_=this.charCodeToPatternIdxToConfig[e],F=(w=this.patternIdxToConfig[e]).length,F=w.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;P=_&&t?V:U}for(k.call(this,t);R<A;){u=null;var G=y.charCodeAt(R),j=P(G),W=j.length;for(r=0;r<W;r++){var H=(D=j[r]).pattern;if(l=null,!1!==(ee=D.short)?G===ee&&(u=H):!0===D.isCustom?null!==(E=H.exec(y,R,S,I))?(u=E[0],void 0!==E.payload&&(l=E.payload)):u=null:(this.updateLastIndex(H,R),u=this.match(H,e,R)),null!==u){if(void 0!==(o=D.longerAlt)){var z=w[o],Y=z.pattern;c=null,!0===z.isCustom?null!==(E=Y.exec(y,R,S,I))?(i=E[0],void 0!==E.payload&&(c=E.payload)):i=null:(this.updateLastIndex(Y,R),i=this.match(Y,e,R)),i&&i.length>u.length&&(u=i,l=c,D=z)}break}}if(null!==u){if(h=u.length,void 0!==(d=D.group)&&(p=D.tokenTypeIdx,m=this.createTokenInstance(u,R,p,D.tokenType,O,v,h),this.handlePayload(m,l),!1===d?N=this.addToken(S,N,m):I[d].push(m)),e=this.chopInput(e,h),R+=h,v=this.computeNewColumn(v,h),!0===M&&!0===D.canLineTerminator){var X=0,K=void 0,$=void 0;b.lastIndex=0;do!0===(K=b.test(u))&&($=b.lastIndex-1,X++);while(!0===K)0!==X&&(O+=X,v=h-$,this.updateTokenEndLineColumnLocation(m,d,$,X,O,v,h))}this.handleModes(D,B,k,m)}else{for(var q=R,Q=O,Z=v,J=!1;!J&&R<A;)for(y.charCodeAt(R),e=this.chopInput(e,1),R++,n=0;n<F;n++){var ee,et=w[n];if(H=et.pattern,!1!==(ee=et.short)?y.charCodeAt(R)===ee&&(J=!0):!0===et.isCustom?J=null!==H.exec(y,R,S,I):(this.updateLastIndex(H,R),J=null!==H.exec(e)),!0===J)break}g=R-q,f=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(y,q,g,Q,Z),C.push({offset:q,line:Q,column:Z,length:g,message:f})}}return this.hasCustom||(S.length=N),{tokens:S,groups:I,errors:C}},e.prototype.handleModes=function(e,t,r,n){if(!0===e.pop){var i=e.push;t(n),void 0!==i&&r.call(this,i)}else void 0!==e.push&&r.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,r,n,i,a,s){var o,u;void 0!==t&&(u=(o=r===s-1)?-1:0,1===n&&!0===o||(e.endLine=i+u,e.endColumn=a-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,r,n){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:n}},e.prototype.createStartOnlyToken=function(e,t,r,n,i,a){return{image:e,startOffset:t,startLine:i,startColumn:a,tokenTypeIdx:r,tokenType:n}},e.prototype.createFullToken=function(e,t,r,n,i,a,s){return{image:e,startOffset:t,endOffset:t+s-1,startLine:i,endLine:i,startColumn:a,endColumn:a+s-1,tokenTypeIdx:r,tokenType:n}},e.prototype.addToken=function(e,t,r){return 666},e.prototype.addTokenUsingPush=function(e,t,r){return e.push(r),t},e.prototype.addTokenUsingMemberAccess=function(e,t,r){return e[t]=r,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,r){return null},e.prototype.matchWithTest=function(e,t,r){return!0===e.test(t)?t.substring(r,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var r=e.exec(t);return null!==r?r[0]:r},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var n=Object(s.timer)(t),i=n.time,a=n.value,o=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"DEFAULT_MODE",function(){return h}),r.d(t,"MODES",function(){return d}),r.d(t,"SUPPORT_STICKY",function(){return p}),r.d(t,"disableSticky",function(){return m}),r.d(t,"enableSticky",function(){return g}),r.d(t,"analyzeTokenTypes",function(){return f}),r.d(t,"validatePatterns",function(){return E}),r.d(t,"findMissingPatterns",function(){return T}),r.d(t,"findInvalidPatterns",function(){return y}),r.d(t,"findEndOfInputAnchor",function(){return R}),r.d(t,"findEmptyMatchRegExps",function(){return N}),r.d(t,"findStartOfInputAnchor",function(){return C}),r.d(t,"findUnsupportedFlags",function(){return O}),r.d(t,"findDuplicatePatterns",function(){return v}),r.d(t,"findInvalidGroupType",function(){return I}),r.d(t,"findModesThatDoNotExist",function(){return M}),r.d(t,"findUnreachablePatterns",function(){return b}),r.d(t,"addStartOfInput",function(){return F}),r.d(t,"addStickyFlag",function(){return w}),r.d(t,"performRuntimeChecks",function(){return _}),r.d(t,"performWarningRuntimeChecks",function(){return L}),r.d(t,"cloneEmptyGroups",function(){return x}),r.d(t,"isCustomPattern",function(){return P}),r.d(t,"isShortPattern",function(){return U}),r.d(t,"LineTerminatorOptimizedTester",function(){return V}),r.d(t,"buildLineBreakIssueMessage",function(){return B}),r.d(t,"minOptimizationVal",function(){return j}),r.d(t,"charCodeToOptimizedIndex",function(){return W});var n,i=r(94),a=r(92),s=r(87),o=r(95),u=r(96),l=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),c="PATTERN",h="defaultMode",d="modes",p="boolean"==typeof RegExp("(?:)").sticky;function m(){p=!1}function g(){p=!0}function f(e,t){var r,n=(t=Object(s.defaults)(t,{useSticky:p,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;n("initCharCodeToOptimizedIndexMap",function(){if(Object(s.isEmpty)(H)){H=Array(65536);for(var e=0;e<65536;e++)H[e]=e>255?255+~~(e/255):e}}),n("Reject Lexer.NA",function(){r=Object(s.reject)(e,function(e){return e[c]===a.Lexer.NA})});var i,u,l,h,d,m,g,f,E,T,y,A=!1;n("Transform Patterns",function(){A=!1,i=Object(s.map)(r,function(e){var r=e[c];if(Object(s.isRegExp)(r)){var n=r.source;return 1===n.length&&"^"!==n&&"$"!==n&&"."!==n?n:2!==n.length||"\\"!==n[0]||Object(s.contains)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],n[1])?t.useSticky?w(r):F(r):n[1]}if(Object(s.isFunction)(r))return A=!0,{exec:r};if(Object(s.has)(r,"exec"))return A=!0,r;if("string"==typeof r){if(1===r.length)return r;var i=new RegExp(r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"));return t.useSticky?w(i):F(i)}throw Error("non exhaustive match")})}),n("misc mapping",function(){u=Object(s.map)(r,function(e){return e.tokenTypeIdx}),l=Object(s.map)(r,function(e){var t=e.GROUP;if(t!==a.Lexer.SKIPPED){if(Object(s.isString)(t))return t;if(Object(s.isUndefined)(t))return!1;throw Error("non exhaustive match")}}),h=Object(s.map)(r,function(e){var t=e.LONGER_ALT;if(t)return Object(s.indexOf)(r,t)}),d=Object(s.map)(r,function(e){return e.PUSH_MODE}),m=Object(s.map)(r,function(e){return Object(s.has)(e,"POP_MODE")})}),n("Line Terminator Handling",function(){var e=k(t.lineTerminatorCharacters);g=Object(s.map)(r,function(e){return!1}),"onlyOffset"!==t.positionTracking&&(g=Object(s.map)(r,function(t){return Object(s.has)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===D(t,e)?Object(o.canMatchCharCode)(e,t.PATTERN):void 0}))}),n("Misc Mapping #2",function(){f=Object(s.map)(r,P),E=Object(s.map)(i,U),T=Object(s.reduce)(r,function(e,t){var r=t.GROUP;return Object(s.isString)(r)&&r!==a.Lexer.SKIPPED&&(e[r]=[]),e},{}),y=Object(s.map)(i,function(e,t){return{pattern:i[t],longerAlt:h[t],canLineTerminator:g[t],isCustom:f[t],short:E[t],group:l[t],push:d[t],pop:m[t],tokenTypeIdx:u[t],tokenType:r[t]}})});var R=!0,N=[];return t.safeMode||n("First Char Optimization",function(){N=Object(s.reduce)(r,function(e,r,n){if("string"==typeof r.PATTERN){var i;G(e,W(r.PATTERN.charCodeAt(0)),y[n])}else if(Object(s.isArray)(r.START_CHARS_HINT))Object(s.forEach)(r.START_CHARS_HINT,function(t){var r=W("string"==typeof t?t.charCodeAt(0):t);i!==r&&(i=r,G(e,r,y[n]))});else if(Object(s.isRegExp)(r.PATTERN))if(r.PATTERN.unicode)R=!1,t.ensureOptimizations&&Object(s.PRINT_ERROR)(o.failedOptimizationPrefixMsg+"	Unable to analyze < "+r.PATTERN.toString()+" > pattern.\n	The regexp unicode flag is not currently supported by the regexp-to-ast library.\n	This will disable the lexer's first char optimizations.\n	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var a=Object(o.getOptimizedStartCodesIndices)(r.PATTERN,t.ensureOptimizations);Object(s.isEmpty)(a)&&(R=!1),Object(s.forEach)(a,function(t){G(e,t,y[n])})}else t.ensureOptimizations&&Object(s.PRINT_ERROR)(o.failedOptimizationPrefixMsg+"	TokenType: <"+r.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n	This will disable the lexer's first char optimizations.\n	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),R=!1;return e},[])}),n("ArrayPacking",function(){N=Object(s.packArray)(N)}),{emptyGroups:T,patternIdxToConfig:y,charCodeToPatternIdxToConfig:N,hasCustom:A,canBeOptimized:R}}function E(e,t){var r,n,i=[],a=T(e);i=i.concat(a.errors);var o=y(a.valid),u=o.valid;return(i=(i=(i=(i=i.concat(o.errors)).concat((r=[],n=Object(s.filter)(u,function(e){return Object(s.isRegExp)(e[c])}),(r=(r=(r=(r=r.concat(R(n))).concat(C(n))).concat(O(n))).concat(v(n))).concat(N(n))))).concat(I(u))).concat(M(u,t))).concat(b(u))}function T(e){var t=Object(s.filter)(e,function(e){return!Object(s.has)(e,c)});return{errors:Object(s.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:a.LexerDefinitionErrorType.MISSING_PATTERN,tokenTypes:[e]}}),valid:Object(s.difference)(e,t)}}function y(e){var t=Object(s.filter)(e,function(e){var t=e[c];return!(Object(s.isRegExp)(t)||Object(s.isFunction)(t)||Object(s.has)(t,"exec")||Object(s.isString)(t))});return{errors:Object(s.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:a.LexerDefinitionErrorType.INVALID_PATTERN,tokenTypes:[e]}}),valid:Object(s.difference)(e,t)}}var A=/[^\\][\$]/;function R(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return l(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),r=Object(s.filter)(e,function(e){var r=e[c];try{var n=Object(u.getRegExpAst)(r),i=new t;return i.visit(n),i.found}catch(e){return A.test(r.source)}});return Object(s.map)(r,function(e){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n	See sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:a.LexerDefinitionErrorType.EOI_ANCHOR_FOUND,tokenTypes:[e]}})}function N(e){var t=Object(s.filter)(e,function(e){return e[c].test("")});return Object(s.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:a.LexerDefinitionErrorType.EMPTY_MATCH_PATTERN,tokenTypes:[e]}})}var S=/[^\\[][\^]|^\^/;function C(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return l(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),r=Object(s.filter)(e,function(e){var r=e[c];try{var n=Object(u.getRegExpAst)(r),i=new t;return i.visit(n),i.found}catch(e){return S.test(r.source)}});return Object(s.map)(r,function(e){return{message:"Unexpected RegExp Anchor Error:\n	Token Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS	for details.",type:a.LexerDefinitionErrorType.SOI_ANCHOR_FOUND,tokenTypes:[e]}})}function O(e){var t=Object(s.filter)(e,function(e){var t=e[c];return t instanceof RegExp&&(t.multiline||t.global)});return Object(s.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:a.LexerDefinitionErrorType.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}})}function v(e){var t=[],r=Object(s.map)(e,function(r){return Object(s.reduce)(e,function(e,n){return r.PATTERN.source!==n.PATTERN.source||Object(s.contains)(t,n)||n.PATTERN===a.Lexer.NA||(t.push(n),e.push(n)),e},[])});r=Object(s.compact)(r);var n=Object(s.filter)(r,function(e){return e.length>1});return Object(s.map)(n,function(e){var t=Object(s.map)(e,function(e){return e.name});return{message:"The same RegExp pattern ->"+Object(s.first)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:a.LexerDefinitionErrorType.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}})}function I(e){var t=Object(s.filter)(e,function(e){if(!Object(s.has)(e,"GROUP"))return!1;var t=e.GROUP;return t!==a.Lexer.SKIPPED&&t!==a.Lexer.NA&&!Object(s.isString)(t)});return Object(s.map)(t,function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:a.LexerDefinitionErrorType.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}})}function M(e,t){var r=Object(s.filter)(e,function(e){return void 0!==e.PUSH_MODE&&!Object(s.contains)(t,e.PUSH_MODE)});return Object(s.map)(r,function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:a.LexerDefinitionErrorType.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}})}function b(e){var t=[],r=Object(s.reduce)(e,function(e,t,r){var n=t.PATTERN;return n===a.Lexer.NA||(Object(s.isString)(n)?e.push({str:n,idx:r,tokenType:t}):Object(s.isRegExp)(n)&&void 0===Object(s.find)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],function(e){return -1!==n.source.indexOf(e)})&&e.push({str:n.source,idx:r,tokenType:t})),e},[]);return Object(s.forEach)(e,function(e,n){Object(s.forEach)(r,function(r){var i=r.str,o=r.idx,u=r.tokenType;if(n<o&&function(e,t){if(Object(s.isRegExp)(t)){var r=t.exec(e);return null!==r&&0===r.index}if(Object(s.isFunction)(t))return t(e,0,[],{});if(Object(s.has)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var l="Token: ->"+u.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:l,type:a.LexerDefinitionErrorType.UNREACHABLE_PATTERN,tokenTypes:[e,u]})}})}),t}function F(e){var t=e.ignoreCase?"i":"";return RegExp("^(?:"+e.source+")",t)}function w(e){var t=e.ignoreCase?"iy":"y";return RegExp(""+e.source,t)}function _(e,t,r){var n=[];return Object(s.has)(e,h)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+h+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(s.has)(e,d)||n.push({message:"A MultiMode Lexer cannot be initialized without a <"+d+"> property in its definition\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(s.has)(e,d)&&Object(s.has)(e,h)&&!Object(s.has)(e.modes,e.defaultMode)&&n.push({message:"A MultiMode Lexer cannot be initialized with a "+h+": <"+e.defaultMode+">which does not exist\n",type:a.LexerDefinitionErrorType.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(s.has)(e,d)&&Object(s.forEach)(e.modes,function(e,t){Object(s.forEach)(e,function(e,r){Object(s.isUndefined)(e)&&n.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+r+">\n",type:a.LexerDefinitionErrorType.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})})}),n}function L(e,t,r){var n=[],i=!1,u=Object(s.compact)(Object(s.flatten)(Object(s.mapValues)(e.modes,function(e){return e}))),l=Object(s.reject)(u,function(e){return e[c]===a.Lexer.NA}),h=k(r);return t&&Object(s.forEach)(l,function(e){var t=D(e,h);if(!1!==t){var r={message:B(e,t),type:t.issue,tokenType:e};n.push(r)}else Object(s.has)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):Object(o.canMatchCharCode)(h,e.PATTERN)&&(i=!0)}),t&&!i&&n.push({message:"Warning: No LINE_BREAKS Found.\n	This Lexer has been defined to track line and column information,\n	But none of the Token Types can be identified as matching a line terminator.\n	See https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n	for details.",type:a.LexerDefinitionErrorType.NO_LINE_BREAKS_FLAGS}),n}function x(e){var t={},r=Object(s.keys)(e);return Object(s.forEach)(r,function(r){var n=e[r];if(!Object(s.isArray)(n))throw Error("non exhaustive match");t[r]=[]}),t}function P(e){var t=e.PATTERN;if(Object(s.isRegExp)(t))return!1;if(Object(s.isFunction)(t)||Object(s.has)(t,"exec"))return!0;if(Object(s.isString)(t))return!1;throw Error("non exhaustive match")}function U(e){return!(!Object(s.isString)(e)||1!==e.length)&&e.charCodeAt(0)}var V={test:function(e){for(var t=e.length,r=this.lastIndex;r<t;r++){var n=e.charCodeAt(r);if(10===n)return this.lastIndex=r+1,!0;if(13===n)return 10===e.charCodeAt(r+1)?this.lastIndex=r+2:this.lastIndex=r+1,!0}return!1},lastIndex:0};function D(e,t){if(Object(s.has)(e,"LINE_BREAKS"))return!1;if(Object(s.isRegExp)(e.PATTERN)){try{Object(o.canMatchCharCode)(t,e.PATTERN)}catch(e){return{issue:a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Object(s.isString)(e.PATTERN))return!1;if(P(e))return{issue:a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function B(e,t){if(t.issue===a.LexerDefinitionErrorType.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n	The problem is in the <"+e.name+"> Token Type\n	 Root cause: "+t.errMsg+".\n	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===a.LexerDefinitionErrorType.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n	The problem is in the <"+e.name+"> Token Type\n	For details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}function k(e){return Object(s.map)(e,function(e){return Object(s.isString)(e)&&e.length>0?e.charCodeAt(0):e})}function G(e,t,r){void 0===e[t]?e[t]=[r]:e[t].push(r)}var j=256;function W(e){return e<j?e:H[e]}var H=[]},function(e,t,r){var n,i;"undefined"!=typeof self&&self,void 0===(i="function"==typeof(n=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var r={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":o(r,"global");break;case"i":o(r,"ignoreCase");break;case"m":o(r,"multiLine");break;case"u":o(r,"unicode");break;case"y":o(r,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:r,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var e,t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}throw Error("Internal Error - Should never get here!")},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":t=this.isDigit()?{atLeast:r,atMost:this.integerIncludingZero()}:{atLeast:r,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[a("\n"),a("\r"),a("\u2028"),a("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=l;break;case"D":e=l,t=!0;break;case"s":e=h;break;case"S":e=h,t=!0;break;case"w":e=c;break;case"W":e=c,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=a("\f");break;case"n":e=a("\n");break;case"r":e=a("\r");break;case"t":e=a("	");break;case"v":e=a("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:a("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:a(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:a(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var r=this.classAtom();if("Character"===r.type&&this.isRangeDash()){this.consumeChar("-");var n=this.classAtom();if("Character"===n.type){if(n.value<r.value)throw Error("Range out of order in character class");e.push({from:r.value,to:n.value})}else s(r.value,e),e.push(a("-")),s(n.value,e)}else s(r.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:a("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;(this.consumeChar("("),"?"===this.peekChar(0))?(this.consumeChar("?"),this.consumeChar(":"),e=!1):this.groupIdx++;var t=this.disjunction();this.consumeChar(")");var r={type:"Group",capturing:e,value:t};return e&&(r.idx=this.groupIdx),r},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===i.test(e))throw Error("Expecting a positive integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===n.test(e))throw Error("Expecting an integer");for(;n.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:a(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return n.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",n=0;n<e;n++){var i=this.popChar();if(!1===r.test(i))throw Error("Expecting a HexDecimal digits");t+=i}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,r=/[0-9a-fA-F]/,n=/[0-9]/,i=/[1-9]/;function a(e){return e.charCodeAt(0)}function s(e,t){void 0!==e.length?e.forEach(function(e){t.push(e)}):t.push(e)}function o(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var l=[];for(t=a("0");t<=a("9");t++)l.push(t);var c=[a("_")].concat(l);for(t=a("a");t<=a("z");t++)c.push(t);for(t=a("A");t<=a("Z");t++)c.push(t);var h=[a(" "),a("\f"),a("\n"),a("\r"),a("	"),a("\v"),a("	"),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a(" "),a("\u2028"),a("\u2029"),a(" "),a(" "),a("　"),a("\uFEFF")];function d(){}return d.prototype.visitChildren=function(e){for(var t in e){var r=e[t];e.hasOwnProperty(t)&&(void 0!==r.type?this.visit(r):Array.isArray(r)&&r.forEach(function(e){this.visit(e)},this))}},d.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},d.prototype.visitPattern=function(e){},d.prototype.visitFlags=function(e){},d.prototype.visitDisjunction=function(e){},d.prototype.visitAlternative=function(e){},d.prototype.visitStartAnchor=function(e){},d.prototype.visitEndAnchor=function(e){},d.prototype.visitWordBoundary=function(e){},d.prototype.visitNonWordBoundary=function(e){},d.prototype.visitLookahead=function(e){},d.prototype.visitNegativeLookahead=function(e){},d.prototype.visitCharacter=function(e){},d.prototype.visitSet=function(e){},d.prototype.visitGroup=function(e){},d.prototype.visitGroupBackReference=function(e){},d.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:d,VERSION:"0.4.0"}})?n.apply(t,[]):n)||(e.exports=i)},function(e,t,r){"use strict";r.r(t),r.d(t,"failedOptimizationPrefixMsg",function(){return l}),r.d(t,"getOptimizedStartCodesIndices",function(){return c}),r.d(t,"firstCharOptimizedIndices",function(){return h}),r.d(t,"canMatchCharCode",function(){return g});var n,i=r(94),a=r(87),s=r(96),o=r(93),u=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l='Unable to use "first char" lexer optimizations:\n';function c(e,t){void 0===t&&(t=!1);try{var r=Object(s.getRegExpAst)(e);return h(r.value,{},r.flags.ignoreCase)}catch(r){if("Complement Sets are not supported for first char optimization"===r.message)t&&Object(a.PRINT_WARNING)(l+"	Unable to optimize: < "+e.toString()+" >\n	Complement Sets cannot be automatically optimized.\n	This will disable the lexer's first char optimizations.\n	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var n="";t&&(n="\n	This will disable the lexer's first char optimizations.\n	See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(a.PRINT_ERROR)(l+"\n	Failed parsing: < "+e.toString()+" >\n	Using the regexp-to-ast library version: "+i.VERSION+"\n	Please open an issue at: https://github.com/bd82/regexp-to-ast/issues"+n)}}return[]}function h(e,t,r){switch(e.type){case"Disjunction":for(var n=0;n<e.value.length;n++)h(e.value[n],t,r);break;case"Alternative":var i=e.value;for(n=0;n<i.length;n++){var s=i[n];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}switch(s.type){case"Character":d(s.value,t,r);break;case"Set":if(!0===s.complement)throw Error("Complement Sets are not supported for first char optimization");Object(a.forEach)(s.value,function(e){if("number"==typeof e)d(e,t,r);else if(!0===r)for(var n=e.from;n<=e.to;n++)d(n,t,r);else{for(n=e.from;n<=e.to&&n<o.minOptimizationVal;n++)d(n,t,r);if(e.to>=o.minOptimizationVal)for(var i=e.from>=o.minOptimizationVal?e.from:o.minOptimizationVal,a=e.to,s=Object(o.charCodeToOptimizedIndex)(i),u=Object(o.charCodeToOptimizedIndex)(a),l=s;l<=u;l++)t[l]=l}});break;case"Group":h(s.value,t,r);break;default:throw Error("Non Exhaustive Match")}var u=void 0!==s.quantifier&&0===s.quantifier.atLeast;if("Group"===s.type&&!1===function e(t){return!(!t.quantifier||0!==t.quantifier.atLeast)||!!t.value&&(Object(a.isArray)(t.value)?Object(a.every)(t.value,e):e(t.value))}(s)||"Group"!==s.type&&!1===u)break}break;default:throw Error("non exhaustive match!")}return Object(a.values)(t)}function d(e,t,r){var n=Object(o.charCodeToOptimizedIndex)(e);t[n]=n,!0===r&&function(e,t){var r=String.fromCharCode(e),n=r.toUpperCase();if(n!==r){var i=Object(o.charCodeToOptimizedIndex)(n.charCodeAt(0));t[i]=i}else{var a=r.toLowerCase();a!==r&&(t[i=Object(o.charCodeToOptimizedIndex)(a.charCodeAt(0))]=i)}}(e,t)}function p(e,t){return Object(a.find)(e.value,function(e){return"number"==typeof e?Object(a.contains)(t,e):void 0!==Object(a.find)(t,function(t){return e.from<=t&&t<=e.to})})}var m=function(e){function t(t){var r=e.call(this)||this;return r.targetCharCodes=t,r.found=!1,r}return u(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){Object(a.contains)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===p(e,this.targetCharCodes)&&(this.found=!0):void 0!==p(e,this.targetCharCodes)&&(this.found=!0)},t}(i.BaseRegExpVisitor);function g(e,t){if(t instanceof RegExp){var r=Object(s.getRegExpAst)(t),n=new m(e);return n.visit(r),n.found}return void 0!==Object(a.find)(t,function(t){return Object(a.contains)(e,t.charCodeAt(0))})}},function(e,t,r){"use strict";r.r(t),r.d(t,"getRegExpAst",function(){return s}),r.d(t,"clearRegExpParserCache",function(){return o});var n=r(94),i={},a=new n.RegExpParser;function s(e){var t=e.toString();if(i.hasOwnProperty(t))return i[t];var r=a.pattern(t);return i[t]=r,r}function o(){i={}}},function(e,t,r){"use strict";r.r(t),r.d(t,"tokenStructuredMatcher",function(){return i}),r.d(t,"tokenStructuredMatcherNoCategories",function(){return a}),r.d(t,"tokenShortNameIdx",function(){return s}),r.d(t,"tokenIdxToClass",function(){return o}),r.d(t,"augmentTokenTypes",function(){return u}),r.d(t,"expandCategories",function(){return l}),r.d(t,"assignTokenDefaultProps",function(){return c}),r.d(t,"assignCategoriesTokensProp",function(){return h}),r.d(t,"assignCategoriesMapProp",function(){return d}),r.d(t,"singleAssignCategoriesToksMap",function(){return p}),r.d(t,"hasShortKeyProperty",function(){return m}),r.d(t,"hasCategoriesProperty",function(){return g}),r.d(t,"hasExtendingTokensTypesProperty",function(){return f}),r.d(t,"hasExtendingTokensTypesMapProperty",function(){return E}),r.d(t,"isTokenType",function(){return T});var n=r(87);function i(e,t){var r=e.tokenTypeIdx;return r===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[r]}function a(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var s=1,o={};function u(e){var t=l(e);c(t),d(t),h(t),Object(n.forEach)(t,function(e){e.isParent=e.categoryMatches.length>0})}function l(e){for(var t=Object(n.cloneArr)(e),r=e,i=!0;i;){r=Object(n.compact)(Object(n.flatten)(Object(n.map)(r,function(e){return e.CATEGORIES})));var a=Object(n.difference)(r,t);t=t.concat(a),Object(n.isEmpty)(a)?i=!1:r=a}return t}function c(e){Object(n.forEach)(e,function(e){m(e)||(o[s]=e,e.tokenTypeIdx=s++),g(e)&&!Object(n.isArray)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),g(e)||(e.CATEGORIES=[]),f(e)||(e.categoryMatches=[]),E(e)||(e.categoryMatchesMap={})})}function h(e){Object(n.forEach)(e,function(e){e.categoryMatches=[],Object(n.forEach)(e.categoryMatchesMap,function(t,r){e.categoryMatches.push(o[r].tokenTypeIdx)})})}function d(e){Object(n.forEach)(e,function(e){p([],e)})}function p(e,t){Object(n.forEach)(e,function(e){t.categoryMatchesMap[e.tokenTypeIdx]=!0}),Object(n.forEach)(t.CATEGORIES,function(r){var i=e.concat(t);Object(n.contains)(i,r)||p(i,r)})}function m(e){return Object(n.has)(e,"tokenTypeIdx")}function g(e){return Object(n.has)(e,"CATEGORIES")}function f(e){return Object(n.has)(e,"categoryMatches")}function E(e){return Object(n.has)(e,"categoryMatchesMap")}function T(e){return Object(n.has)(e,"tokenTypeIdx")}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultLexerErrorProvider",function(){return n});var n={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,r,n,i){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+r+" characters."}}},function(e,t,r){"use strict";r.r(t),r.d(t,"first",function(){return s}),r.d(t,"firstForSequence",function(){return o}),r.d(t,"firstForBranching",function(){return u}),r.d(t,"firstForTerminal",function(){return l});var n=r(87),i=r(90),a=r(100);function s(e){if(e instanceof i.NonTerminal)return s(e.referencedRule);if(e instanceof i.Terminal)return l(e);if(Object(a.isSequenceProd)(e))return o(e);if(Object(a.isBranchingProd)(e))return u(e);throw Error("non exhaustive match")}function o(e){for(var t,r=[],i=e.definition,o=0,u=i.length>o,l=!0;u&&l;)t=i[o],l=Object(a.isOptionalProd)(t),r=r.concat(s(t)),o+=1,u=i.length>o;return Object(n.uniq)(r)}function u(e){var t=Object(n.map)(e.definition,function(e){return s(e)});return Object(n.uniq)(Object(n.flatten)(t))}function l(e){return[e.terminalType]}},function(e,t,r){"use strict";r.r(t),r.d(t,"isSequenceProd",function(){return u}),r.d(t,"isOptionalProd",function(){return function e(t,r){return void 0===r&&(r=[]),!!(t instanceof a.Option||t instanceof a.Repetition||t instanceof a.RepetitionWithSeparator)||(t instanceof a.Alternation?Object(i.some)(t.definition,function(t){return e(t,r)}):!(t instanceof a.NonTerminal&&Object(i.contains)(r,t))&&t instanceof a.AbstractProduction&&(t instanceof a.NonTerminal&&r.push(t),Object(i.every)(t.definition,function(t){return e(t,r)})))}}),r.d(t,"isBranchingProd",function(){return l}),r.d(t,"getProductionDslName",function(){return c}),r.d(t,"DslMethodsCollectorVisitor",function(){return h}),r.d(t,"collectMethods",function(){return p});var n,i=r(87),a=r(90),s=r(101),o=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e){return e instanceof a.Flat||e instanceof a.Option||e instanceof a.Repetition||e instanceof a.RepetitionMandatory||e instanceof a.RepetitionMandatoryWithSeparator||e instanceof a.RepetitionWithSeparator||e instanceof a.Terminal||e instanceof a.Rule}function l(e){return e instanceof a.Alternation}function c(e){if(e instanceof a.NonTerminal)return"SUBRULE";if(e instanceof a.Option)return"OPTION";if(e instanceof a.Alternation)return"OR";if(e instanceof a.RepetitionMandatory)return"AT_LEAST_ONE";if(e instanceof a.RepetitionMandatoryWithSeparator)return"AT_LEAST_ONE_SEP";if(e instanceof a.RepetitionWithSeparator)return"MANY_SEP";if(e instanceof a.Repetition)return"MANY";if(e instanceof a.Terminal)return"CONSUME";throw Error("non exhaustive match")}var h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return o(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";Object(i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";Object(i.has)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(s.GAstVisitor),d=new h;function p(e){d.reset(),e.accept(d);var t=d.dslMethods;return d.reset(),t}},function(e,t,r){"use strict";r.r(t),r.d(t,"GAstVisitor",function(){return i});var n=r(90),i=function(){function e(){}return e.prototype.visit=function(e){switch(e.constructor){case n.NonTerminal:return this.visitNonTerminal(e);case n.Flat:return this.visitFlat(e);case n.Option:return this.visitOption(e);case n.RepetitionMandatory:return this.visitRepetitionMandatory(e);case n.RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(e);case n.RepetitionWithSeparator:return this.visitRepetitionWithSeparator(e);case n.Repetition:return this.visitRepetition(e);case n.Alternation:return this.visitAlternation(e);case n.Terminal:return this.visitTerminal(e);case n.Rule:return this.visitRule(e);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"IN",function(){return n});var n="_~IN~_"},function(e,t,r){"use strict";r.r(t),r.d(t,"setNodeLocationOnlyOffset",function(){return l}),r.d(t,"setNodeLocationFull",function(){return c}),r.d(t,"addTerminalToCst",function(){return h}),r.d(t,"addNoneTerminalToCst",function(){return d}),r.d(t,"NamedDSLMethodsCollectorVisitor",function(){return p}),r.d(t,"expandAllNestedRuleNames",function(){return m});var n,i=r(87),a=r(104),s=r(90),o=r(101),u=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function l(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function c(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function h(e,t,r){void 0===e.children[r]?e.children[r]=[t]:e.children[r].push(t)}function d(e,t,r){void 0===e.children[t]?e.children[t]=[r]:e.children[t].push(r)}var p=function(e){function t(t){var r=e.call(this)||this;return r.result=[],r.ruleIdx=t,r}return u(t,e),t.prototype.collectNamedDSLMethod=function(e,t,r){if(!Object(i.isUndefined)(e.name)){var n=void 0;if(e instanceof s.Option||e instanceof s.Repetition||e instanceof s.RepetitionMandatory||e instanceof s.Alternation)n=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof s.RepetitionMandatoryWithSeparator||e instanceof s.RepetitionWithSeparator))throw Error("non exhaustive match");n=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var o=[n],u=Object(a.getKeyForAutomaticLookahead)(this.ruleIdx,r,e.idx);this.result.push({def:o,key:u,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,s.Option,a.OPTION_IDX)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,s.Repetition,a.MANY_IDX)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,s.RepetitionMandatory,a.AT_LEAST_ONE_IDX)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,s.RepetitionMandatoryWithSeparator,a.AT_LEAST_ONE_SEP_IDX)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,s.RepetitionWithSeparator,a.MANY_SEP_IDX)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,s.Alternation,a.OR_IDX);var r=e.definition.length>1;Object(i.forEach)(e.definition,function(n,o){if(!Object(i.isUndefined)(n.name)){var u=n.definition;u=r?[new s.Option({definition:n.definition})]:n.definition;var l=Object(a.getKeyForAltIndex)(t.ruleIdx,a.OR_IDX,e.idx,o);t.result.push({def:u,key:l,name:n.name,orgProd:n})}})},t}(o.GAstVisitor);function m(e,t){var r={allRuleNames:[]};return Object(i.forEach)(e,function(e){var n=t[e.name];r.allRuleNames.push(e.name);var a=new p(n);e.accept(a),Object(i.forEach)(a.result,function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)})}),r}},function(e,t,r){"use strict";r.r(t),r.d(t,"BITS_FOR_METHOD_TYPE",function(){return n}),r.d(t,"BITS_FOR_OCCURRENCE_IDX",function(){return i}),r.d(t,"BITS_FOR_RULE_IDX",function(){return a}),r.d(t,"BITS_FOR_ALT_IDX",function(){return s}),r.d(t,"OR_IDX",function(){return o}),r.d(t,"OPTION_IDX",function(){return u}),r.d(t,"MANY_IDX",function(){return l}),r.d(t,"AT_LEAST_ONE_IDX",function(){return c}),r.d(t,"MANY_SEP_IDX",function(){return h}),r.d(t,"AT_LEAST_ONE_SEP_IDX",function(){return d}),r.d(t,"getKeyForAutomaticLookahead",function(){return p}),r.d(t,"getKeyForAltIndex",function(){return m});var n=4,i=8,a=12,s=8,o=256,u=512,l=768,c=1024,h=1280,d=1536;function p(e,t,r){return r|t|e}function m(e,t,r,n){return r|t|e|n+1<<24}},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultParserErrorProvider",function(){return u}),r.d(t,"defaultGrammarResolverErrorProvider",function(){return l}),r.d(t,"defaultGrammarValidatorErrorProvider",function(){return c});var n=r(91),i=r(87),a=r(90),s=r(100),o=r(106),u={buildMismatchTokenMessage:function(e){var t=e.expected,r=e.actual;return e.previous,e.ruleName,"Expecting "+(Object(n.hasTokenLabel)(t)?"--\x3e "+Object(n.tokenLabel)(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+r.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;return e.ruleName,"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,r=e.actual,a=(e.previous,e.customUserDescription),s=(e.ruleName,"\nbut found: '"+Object(i.first)(r).image+"'");if(a)return"Expecting: "+a+s;var o=Object(i.reduce)(t,function(e,t){return e.concat(t)},[]),u=Object(i.map)(o,function(e){return"["+Object(i.map)(e,function(e){return Object(n.tokenLabel)(e)}).join(", ")+"]"});return"Expecting: one of these possible Token sequences:\n"+Object(i.map)(u,function(e,t){return"  "+(t+1)+". "+e}).join("\n")+s},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,r=e.actual,a=e.customUserDescription,s=(e.ruleName,"\nbut found: '"+Object(i.first)(r).image+"'");return a?"Expecting: "+a+s:"Expecting: expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(i.map)(t,function(e){return"["+Object(i.map)(e,function(e){return Object(n.tokenLabel)(e)}).join(",")+"]"}).join(" ,")+">"+s}};Object.freeze(u);var l={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},c={buildDuplicateFoundError:function(e,t){var r=e.name,n=Object(i.first)(t),o=n.idx,u=Object(s.getProductionDslName)(n),l=n instanceof a.Terminal?n.terminalType.name:n instanceof a.NonTerminal?n.nonTerminalName:"",c="->"+u+(o>0?o:"")+"<- "+(l?"with argument: ->"+l+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return(c=c.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+o.validNestedRuleName.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+Object(i.first)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=Object(i.map)(e.prefixPath,function(e){return Object(n.tokenLabel)(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=Object(i.map)(e.prefixPath,function(e){return Object(n.tokenLabel)(e)}).join(", "),r=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+r+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=Object(s.getProductionDslName)(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+t+" --\x3e "+i.map(e.leftRecursionPath,function(e){return e.name}).concat([t]).join(" --\x3e ")+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof a.Rule?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}}},function(e,t,r){"use strict";r.r(t),r.d(t,"validateGrammar",function(){return p}),r.d(t,"identifyProductionForDuplicates",function(){return m}),r.d(t,"OccurrenceValidationCollector",function(){return f}),r.d(t,"validTermsPattern",function(){return E}),r.d(t,"validNestedRuleName",function(){return T}),r.d(t,"validateRuleName",function(){return y}),r.d(t,"validateNestedRuleName",function(){return A}),r.d(t,"validateTokenName",function(){return R}),r.d(t,"validateRuleDoesNotAlreadyExist",function(){return N}),r.d(t,"validateRuleIsOverridden",function(){return S}),r.d(t,"validateNoLeftRecursion",function(){return C}),r.d(t,"getFirstNoneTerminal",function(){return O}),r.d(t,"validateEmptyOrAlternative",function(){return I}),r.d(t,"validateAmbiguousAlternationAlternatives",function(){return M}),r.d(t,"RepetionCollector",function(){return b}),r.d(t,"validateTooManyAlts",function(){return F}),r.d(t,"validateSomeNonEmptyLookaheadPath",function(){return w}),r.d(t,"checkPrefixAlternativesAmbiguities",function(){return _});var n,i=r(87),a=r(86),s=r(100),o=r(107),u=r(103),l=r(108),c=r(90),h=r(101),d=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e,t,r,n,o,l){var c,h,d,p,E=i.map(e,function(e){var t,r,n,u;return t=new f,e.accept(t),r=t.allProductions,n=i.groupBy(r,m),u=i.pick(n,function(e){return e.length>1}),i.map(i.values(u),function(t){var r=i.first(t),n=o.buildDuplicateFoundError(e,t),u=Object(s.getProductionDslName)(r),l={message:n,type:a.ParserDefinitionErrorType.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:r.idx},c=g(r);return c&&(l.parameter=c),l})}),T=i.map(e,function(e){return C(e,e,o)}),S=[],O=[],v=[];Object(i.every)(T,i.isEmpty)&&(S=Object(i.map)(e,function(e){return I(e,o)}),O=Object(i.map)(e,function(e){return M(e,t,n,o)}),v=w(e,t,o));var b=(c=[],h=Object(i.map)(r,function(e){return e.name}),Object(i.forEach)(e,function(e){var t=e.name;if(Object(i.contains)(h,t)){var r=o.buildNamespaceConflictError(e);c.push({message:r,type:a.ParserDefinitionErrorType.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}),c),_=i.map(r,function(e){return R(e,o)}),L=(d=[],Object(i.forEach)(e,function(e){var t=new u.NamedDSLMethodsCollectorVisitor("");e.accept(t);var r=Object(i.map)(t.result,function(e){return e.orgProd});d.push(Object(i.map)(r,function(t){return A(e,t,o)}))}),Object(i.flatten)(d)),x=(p=[],Object(i.forEach)(e,function(e){var t=new u.NamedDSLMethodsCollectorVisitor("");e.accept(t);var r=Object(i.groupBy)(t.result,function(e){return e.name}),n=Object(i.pick)(r,function(e){return e.length>1});Object(i.forEach)(Object(i.values)(n),function(t){var r=Object(i.map)(t,function(e){return e.orgProd}),n=o.buildDuplicateNestedRuleNameError(e,r);p.push({message:n,type:a.ParserDefinitionErrorType.DUPLICATE_NESTED_NAME,ruleName:e.name})})}),p),P=Object(i.map)(e,function(e){return F(e,o)}),U=Object(i.map)(e,function(e){return y(e,o)}),V=Object(i.map)(e,function(t){return N(t,e,l,o)});return i.flatten(E.concat(_,L,x,v,T,S,O,b,P,U,V))}function m(e){return Object(s.getProductionDslName)(e)+"_#_"+e.idx+"_#_"+g(e)}function g(e){return e instanceof c.Terminal?e.terminalType.name:e instanceof c.NonTerminal?e.nonTerminalName:""}var f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return d(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(h.GAstVisitor),E=/^[a-zA-Z_]\w*$/,T=new RegExp(E.source.replace("^","^\\$"));function y(e,t){var r=[],n=e.name;return n.match(E)||r.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:E}),type:a.ParserDefinitionErrorType.INVALID_RULE_NAME,ruleName:n}),r}function A(e,t,r){var n=[];return t.name.match(T)||n.push({message:r.buildInvalidNestedRuleNameError(e,t),type:a.ParserDefinitionErrorType.INVALID_NESTED_RULE_NAME,ruleName:e.name}),n}function R(e,t){var r=[];return e.name.match(E)||r.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:E}),type:a.ParserDefinitionErrorType.INVALID_TOKEN_NAME}),r}function N(e,t,r,n){var s=[];if(Object(i.reduce)(t,function(t,r){return r.name===e.name?t+1:t},0)>1){var o=n.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});s.push({message:o,type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e.name})}return s}function S(e,t,r){var n=[];return i.contains(t,e)||n.push({message:"Invalid rule override, rule: ->"+e+"<- cannot be overridden in the grammar: ->"+r+"<-as it is not defined in any of the super grammars ",type:a.ParserDefinitionErrorType.INVALID_RULE_OVERRIDE,ruleName:e}),n}function C(e,t,r,n){void 0===n&&(n=[]);var s=[],o=O(t.definition);if(i.isEmpty(o))return[];var u=e.name;i.contains(o,e)&&s.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:n}),type:a.ParserDefinitionErrorType.LEFT_RECURSION,ruleName:u});var l=i.difference(o,n.concat([e])),c=i.map(l,function(t){var a=i.cloneArr(n);return a.push(t),C(e,t,r,a)});return s.concat(i.flatten(c))}function O(e){var t=[];if(i.isEmpty(e))return t;var r=i.first(e);if(r instanceof c.NonTerminal)t.push(r.referencedRule);else if(r instanceof c.Flat||r instanceof c.Option||r instanceof c.RepetitionMandatory||r instanceof c.RepetitionMandatoryWithSeparator||r instanceof c.RepetitionWithSeparator||r instanceof c.Repetition)t=t.concat(O(r.definition));else if(r instanceof c.Alternation)t=i.flatten(i.map(r.definition,function(e){return O(e.definition)}));else if(!(r instanceof c.Terminal))throw Error("non exhaustive match");var n=Object(s.isOptionalProd)(r),a=e.length>1;if(n&&a){var o=i.drop(e);return t.concat(O(o))}return t}var v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return d(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(h.GAstVisitor);function I(e,t){var r=new v;e.accept(r);var n=r.alternations;return i.reduce(n,function(r,n){var s=i.dropRight(n.definition),o=i.map(s,function(r,s){var o=Object(l.nextPossibleTokensAfter)([r],[],null,1);return i.isEmpty(o)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:s}),type:a.ParserDefinitionErrorType.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:s+1}:null});return r.concat(i.compact(o))},[])}function M(e,t,r,n){var u=new v;e.accept(u);var l=u.alternations,c=r[e.name];return c&&(l=Object(i.reject)(l,function(e){return c[Object(s.getProductionDslName)(e)+(0===e.idx?"":e.idx)]})),l=Object(i.reject)(l,function(e){return!0===e.ignoreAmbiguities}),i.reduce(l,function(r,s){var u,l,c=s.idx,h=s.maxLookahead||t,d=Object(o.getLookaheadPathsForOr)(c,e,h,s),p=(u=[],l=Object(i.reduce)(d,function(e,t,r){return!0===s.definition[r].ignoreAmbiguities||Object(i.forEach)(t,function(t){var n=[r];Object(i.forEach)(d,function(e,i){r!==i&&Object(o.containsPath)(e,t)&&!0!==s.definition[i].ignoreAmbiguities&&n.push(i)}),n.length>1&&!Object(o.containsPath)(u,t)&&(u.push(t),e.push({alts:n,path:t}))}),e},[]),i.map(l,function(t){var r=Object(i.map)(t.alts,function(e){return e+1});return{message:n.buildAlternationAmbiguityError({topLevelRule:e,alternation:s,ambiguityIndices:r,prefixPath:t.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_ALTS,ruleName:e.name,occurrence:s.idx,alternatives:[t.alts]}})),m=_(d,s,e,n);return r.concat(p,m)},[])}var b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return d(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(h.GAstVisitor);function F(e,t){var r=new v;e.accept(r);var n=r.alternations;return i.reduce(n,function(r,n){return n.definition.length>255&&r.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:a.ParserDefinitionErrorType.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}),r},[])}function w(e,t,r){var n=[];return Object(i.forEach)(e,function(e){var s=new b;e.accept(s);var u=s.allProductions;Object(i.forEach)(u,function(s){var u=Object(o.getProdType)(s),l=s.maxLookahead||t,c=s.idx,h=Object(o.getLookaheadPathsForOptionalProd)(c,e,u,l)[0];if(Object(i.isEmpty)(Object(i.flatten)(h))){var d=r.buildEmptyRepetitionError({topLevelRule:e,repetition:s});n.push({message:d,type:a.ParserDefinitionErrorType.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}})}),n}function _(e,t,r,n){var s=[],u=Object(i.reduce)(e,function(e,t,r){var n=Object(i.map)(t,function(e){return{idx:r,path:e}});return e.concat(n)},[]);return Object(i.forEach)(u,function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var l=e.idx,c=e.path,h=Object(i.findAll)(u,function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<l&&Object(o.isStrictPrefixOfPath)(e.path,c)}),d=Object(i.map)(h,function(e){var i=[e.idx+1,l+1],s=0===t.idx?"":t.idx;return{message:n.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:a.ParserDefinitionErrorType.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:s,alternatives:i}});s=s.concat(d)}}),s}},function(e,t,r){"use strict";r.r(t),r.d(t,"PROD_TYPE",function(){return a}),r.d(t,"getProdType",function(){return p}),r.d(t,"buildLookaheadFuncForOr",function(){return m}),r.d(t,"buildLookaheadFuncForOptionalProd",function(){return g}),r.d(t,"buildAlternativesLookAheadFunc",function(){return f}),r.d(t,"buildSingleAlternativeLookaheadFunction",function(){return E}),r.d(t,"lookAheadSequenceFromAlternatives",function(){return N}),r.d(t,"getLookaheadPathsForOr",function(){return S}),r.d(t,"getLookaheadPathsForOptionalProd",function(){return C}),r.d(t,"containsPath",function(){return O}),r.d(t,"isStrictPrefixOfPath",function(){return v}),r.d(t,"areTokenCategoriesNotUsed",function(){return I});var n,i,a,s=r(87),o=r(108),u=r(89),l=r(97),c=r(90),h=r(101),d=(i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function p(e){if(e instanceof c.Option)return a.OPTION;if(e instanceof c.Repetition)return a.REPETITION;if(e instanceof c.RepetitionMandatory)return a.REPETITION_MANDATORY;if(e instanceof c.RepetitionMandatoryWithSeparator)return a.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof c.RepetitionWithSeparator)return a.REPETITION_WITH_SEPARATOR;if(e instanceof c.Alternation)return a.ALTERNATION;throw Error("non exhaustive match")}function m(e,t,r,n,i,a){var s=S(e,t,r);return a(s,n,I(s)?l.tokenStructuredMatcherNoCategories:l.tokenStructuredMatcher,i)}function g(e,t,r,n,i,a){var s=C(e,t,i,r),o=I(s)?l.tokenStructuredMatcherNoCategories:l.tokenStructuredMatcher;return a(s[0],o,n)}function f(e,t,r,n){var i=e.length,a=Object(s.every)(e,function(e){return Object(s.every)(e,function(e){return 1===e.length})});if(t)return function(t){for(var n=Object(s.map)(t,function(e){return e.GATE}),a=0;a<i;a++){var o=e[a],u=o.length,l=n[a];if(void 0===l||!1!==l.call(this))e:for(var c=0;c<u;c++){for(var h=o[c],d=h.length,p=0;p<d;p++)if(!1===r(this.LA(p+1),h[p]))continue e;return a}}};if(a&&!n){var o=Object(s.map)(e,function(e){return Object(s.flatten)(e)}),u=Object(s.reduce)(o,function(e,t,r){return Object(s.forEach)(t,function(t){Object(s.has)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=r),Object(s.forEach)(t.categoryMatches,function(t){Object(s.has)(e,t)||(e[t]=r)})}),e},[]);return function(){return u[this.LA(1).tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var n=e[t],a=n.length;e:for(var s=0;s<a;s++){for(var o=n[s],u=o.length,l=0;l<u;l++)if(!1===r(this.LA(l+1),o[l]))continue e;return t}}}}function E(e,t,r){var n=Object(s.every)(e,function(e){return 1===e.length}),i=e.length;if(n&&!r){var a=Object(s.flatten)(e);if(1===a.length&&Object(s.isEmpty)(a[0].categoryMatches)){var o=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===o}}var u=Object(s.reduce)(a,function(e,t,r){return e[t.tokenTypeIdx]=!0,Object(s.forEach)(t.categoryMatches,function(t){e[t]=!0}),e},[]);return function(){return!0===u[this.LA(1).tokenTypeIdx]}}return function(){e:for(var r=0;r<i;r++){for(var n=e[r],a=n.length,s=0;s<a;s++)if(!1===t(this.LA(s+1),n[s]))continue e;return!0}return!1}}(n=a||(a={}))[n.OPTION=0]="OPTION",n[n.REPETITION=1]="REPETITION",n[n.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",n[n.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",n[n.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",n[n.ALTERNATION=5]="ALTERNATION";var T=function(e){function t(t,r,n){var i=e.call(this)||this;return i.topProd=t,i.targetOccurrence=r,i.targetProdType=n,i}return d(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,r,n){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=r.concat(n),!0)},t.prototype.walkOption=function(t,r,n){this.checkIsTarget(t,a.OPTION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOne=function(t,r,n){this.checkIsTarget(t,a.REPETITION_MANDATORY,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkAtLeastOneSep=function(t,r,n){this.checkIsTarget(t,a.REPETITION_MANDATORY_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkMany=function(t,r,n){this.checkIsTarget(t,a.REPETITION,r,n)||e.prototype.walkOption.call(this,t,r,n)},t.prototype.walkManySep=function(t,r,n){this.checkIsTarget(t,a.REPETITION_WITH_SEPARATOR,r,n)||e.prototype.walkOption.call(this,t,r,n)},t}(u.RestWalker),y=function(e){function t(t,r,n){var i=e.call(this)||this;return i.targetOccurrence=t,i.targetProdType=r,i.targetRef=n,i.result=[],i}return d(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,a.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,a.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,a.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,a.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,a.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,a.ALTERNATION)},t}(h.GAstVisitor);function A(e){for(var t=Array(e),r=0;r<e;r++)t[r]=[];return t}function R(e){for(var t=[""],r=0;r<e.length;r++){for(var n=e[r],i=[],a=0;a<t.length;a++){var s=t[a];i.push(s+"_"+n.tokenTypeIdx);for(var o=0;o<n.categoryMatches.length;o++){var u="_"+n.categoryMatches[o];i.push(s+u)}}t=i}return t}function N(e,t){for(var r=Object(s.map)(e,function(e){return Object(o.possiblePathsFrom)([e],1)}),n=A(r.length),i=Object(s.map)(r,function(e){var t={};return Object(s.forEach)(e,function(e){var r=R(e.partialPath);Object(s.forEach)(r,function(e){t[e]=!0})}),t}),a=r,u=1;u<=t;u++){var l=a;a=A(l.length);for(var c=function(e){for(var r=l[e],c=0;c<r.length;c++){var h=r[c].partialPath,d=r[c].suffixDef,p=R(h);if(function(e,t,r){for(var n=0;n<e.length;n++)if(n!==r){for(var i=e[n],a=0;a<t.length;a++)if(!0===i[t[a]])return!1}return!0}(i,p,e)||Object(s.isEmpty)(d)||h.length===t){var m=n[e];if(!1===O(m,h)){m.push(h);for(var g=0;g<p.length;g++){var f=p[g];i[e][f]=!0}}}else{var E=Object(o.possiblePathsFrom)(d,u+1,h);a[e]=a[e].concat(E),Object(s.forEach)(E,function(t){var r=R(t.partialPath);Object(s.forEach)(r,function(t){i[e][t]=!0})})}}},h=0;h<l.length;h++)c(h)}return n}function S(e,t,r,n){var i=new y(e,a.ALTERNATION,n);return t.accept(i),N(i.result,r)}function C(e,t,r,n){var i=new y(e,r);t.accept(i);var a=i.result,s=new T(t,e,r).startWalking();return N([new c.Flat({definition:a}),new c.Flat({definition:s})],n)}function O(e,t){e:for(var r=0;r<e.length;r++){var n=e[r];if(n.length===t.length){for(var i=0;i<n.length;i++){var a=t[i],s=n[i];if(!1==(a===s||void 0!==s.categoryMatchesMap[a.tokenTypeIdx]))continue e}return!0}}return!1}function v(e,t){return e.length<t.length&&Object(s.every)(e,function(e,r){var n=t[r];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})}function I(e){return Object(s.every)(e,function(e){return Object(s.every)(e,function(e){return Object(s.every)(e,function(e){return Object(s.isEmpty)(e.categoryMatches)})})})}},function(e,t,r){"use strict";r.r(t),r.d(t,"AbstractNextPossibleTokensWalker",function(){return l}),r.d(t,"NextAfterTokenWalker",function(){return c}),r.d(t,"AbstractNextTerminalAfterProductionWalker",function(){return h}),r.d(t,"NextTerminalAfterManyWalker",function(){return d}),r.d(t,"NextTerminalAfterManySepWalker",function(){return p}),r.d(t,"NextTerminalAfterAtLeastOneWalker",function(){return m}),r.d(t,"NextTerminalAfterAtLeastOneSepWalker",function(){return g}),r.d(t,"possiblePathsFrom",function(){return function e(t,r,n){void 0===n&&(n=[]),n=Object(a.cloneArr)(n);var i=[],s=0;function u(o){var u=e(o.concat(Object(a.drop)(t,s+1)),r,n);return i.concat(u)}for(;n.length<r&&s<t.length;){var l=t[s];if(l instanceof o.Flat||l instanceof o.NonTerminal)return u(l.definition);if(l instanceof o.Option)i=u(l.definition);else{if(l instanceof o.RepetitionMandatory)return u(c=l.definition.concat([new o.Repetition({definition:l.definition})]));if(l instanceof o.RepetitionMandatoryWithSeparator)return u(c=[new o.Flat({definition:l.definition}),new o.Repetition({definition:[new o.Terminal({terminalType:l.separator})].concat(l.definition)})]);if(l instanceof o.RepetitionWithSeparator){var c=l.definition.concat([new o.Repetition({definition:[new o.Terminal({terminalType:l.separator})].concat(l.definition)})]);i=u(c)}else if(l instanceof o.Repetition)i=u(c=l.definition.concat([new o.Repetition({definition:l.definition})]));else{if(l instanceof o.Alternation)return Object(a.forEach)(l.definition,function(e){i=u(e.definition)}),i;if(!(l instanceof o.Terminal))throw Error("non exhaustive match");n.push(l.terminalType)}}s++}return i.push({partialPath:n,suffixDef:Object(a.drop)(t,s)}),i}}),r.d(t,"nextPossibleTokensAfter",function(){return f});var n,i=r(89),a=r(87),s=r(99),o=r(90),u=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),l=function(e){function t(t,r){var n=e.call(this)||this;return n.topProd=t,n.path=r,n.possibleTokTypes=[],n.nextProductionName="",n.nextProductionOccurrence=0,n.found=!1,n.isAtEndOfPath=!1,n}return u(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(a.cloneArr)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(a.cloneArr)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,r){void 0===r&&(r=[]),this.found||e.prototype.walk.call(this,t,r)},t.prototype.walkProdRef=function(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var n=t.concat(r);this.updateExpectedNext(),this.walk(e.referencedRule,n)}},t.prototype.updateExpectedNext=function(){Object(a.isEmpty)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(i.RestWalker),c=function(e){function t(t,r){var n=e.call(this,t,r)||this;return n.path=r,n.nextTerminalName="",n.nextTerminalOccurrence=0,n.nextTerminalName=n.path.lastTok.name,n.nextTerminalOccurrence=n.path.lastTokOccurrence,n}return u(t,e),t.prototype.walkTerminal=function(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var n=t.concat(r),i=new o.Flat({definition:n});this.possibleTokTypes=Object(s.first)(i),this.found=!0}},t}(l),h=function(e){function t(t,r){var n=e.call(this)||this;return n.topRule=t,n.occurrence=r,n.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},n}return u(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(i.RestWalker),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkMany=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof o.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,r,n)},t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkManySep=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof o.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,r,n)},t}(h),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOne=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof o.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,r,n)},t}(h),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),t.prototype.walkAtLeastOneSep=function(t,r,n){if(t.idx===this.occurrence){var i=Object(a.first)(r.concat(n));this.result.isEndOfRule=void 0===i,i instanceof o.Terminal&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,r,n)},t}(h);function f(e,t,r,n){var i=["EXIT_NONE_TERMINAL"],s=!1,u=t.length,l=u-n-1,c=[],h=[];for(h.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Object(a.isEmpty)(h);){var d=h.pop();if("EXIT_ALTERNATIVE"!==d){var p=d.def,m=d.idx,g=d.ruleStack,f=d.occurrenceStack;if(!Object(a.isEmpty)(p)){var E=p[0];if("EXIT_NONE_TERMINAL"===E){var T={idx:m,def:Object(a.drop)(p),ruleStack:Object(a.dropRight)(g),occurrenceStack:Object(a.dropRight)(f)};h.push(T)}else if(E instanceof o.Terminal)if(m<u-1){var y=m+1;r(t[y],E.terminalType)&&(T={idx:y,def:Object(a.drop)(p),ruleStack:g,occurrenceStack:f},h.push(T))}else{if(m!==u-1)throw Error("non exhaustive match");c.push({nextTokenType:E.terminalType,nextTokenOccurrence:E.idx,ruleStack:g,occurrenceStack:f}),s=!0}else if(E instanceof o.NonTerminal){var A=Object(a.cloneArr)(g);A.push(E.nonTerminalName);var R=Object(a.cloneArr)(f);R.push(E.idx),T={idx:m,def:E.definition.concat(i,Object(a.drop)(p)),ruleStack:A,occurrenceStack:R},h.push(T)}else if(E instanceof o.Option){var N={idx:m,def:Object(a.drop)(p),ruleStack:g,occurrenceStack:f};h.push(N),h.push("EXIT_ALTERNATIVE");var S={idx:m,def:E.definition.concat(Object(a.drop)(p)),ruleStack:g,occurrenceStack:f};h.push(S)}else if(E instanceof o.RepetitionMandatory){var C=new o.Repetition({definition:E.definition,idx:E.idx});T={idx:m,def:E.definition.concat([C],Object(a.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(T)}else if(E instanceof o.RepetitionMandatoryWithSeparator){var O=new o.Terminal({terminalType:E.separator});C=new o.Repetition({definition:[O].concat(E.definition),idx:E.idx}),T={idx:m,def:E.definition.concat([C],Object(a.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(T)}else if(E instanceof o.RepetitionWithSeparator){N={idx:m,def:Object(a.drop)(p),ruleStack:g,occurrenceStack:f},h.push(N),h.push("EXIT_ALTERNATIVE"),O=new o.Terminal({terminalType:E.separator});var v=new o.Repetition({definition:[O].concat(E.definition),idx:E.idx});S={idx:m,def:E.definition.concat([v],Object(a.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(S)}else if(E instanceof o.Repetition)N={idx:m,def:Object(a.drop)(p),ruleStack:g,occurrenceStack:f},h.push(N),h.push("EXIT_ALTERNATIVE"),v=new o.Repetition({definition:E.definition,idx:E.idx}),S={idx:m,def:E.definition.concat([v],Object(a.drop)(p)),ruleStack:g,occurrenceStack:f},h.push(S);else if(E instanceof o.Alternation)for(var I=E.definition.length-1;I>=0;I--){var M={idx:m,def:E.definition[I].definition.concat(Object(a.drop)(p)),ruleStack:g,occurrenceStack:f};h.push(M),h.push("EXIT_ALTERNATIVE")}else if(E instanceof o.Flat)h.push({idx:m,def:E.definition.concat(Object(a.drop)(p)),ruleStack:g,occurrenceStack:f});else{if(!(E instanceof o.Rule))throw Error("non exhaustive match");h.push(function(e,t,r,n){var i=Object(a.cloneArr)(r);i.push(e.name);var s=Object(a.cloneArr)(n);return s.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:s}}(E,m,g,f))}}}else s&&Object(a.last)(h).idx<=l&&h.pop()}return c}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",function(){return u}),r.d(t,"validateGrammar",function(){return l}),r.d(t,"assignOccurrenceIndices",function(){return c});var n=r(87),i=r(110),a=r(106),s=r(105),o=r(100);function u(e){e=Object(n.defaults)(e,{errMsgProvider:s.defaultGrammarResolverErrorProvider});var t={};return Object(n.forEach)(e.rules,function(e){t[e.name]=e}),Object(i.resolveGrammar)(t,e.errMsgProvider)}function l(e){return e=Object(n.defaults)(e,{errMsgProvider:s.defaultGrammarValidatorErrorProvider,ignoredIssues:{}}),Object(a.validateGrammar)(e.rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function c(e){Object(n.forEach)(e.rules,function(e){var t=new o.DslMethodsCollectorVisitor;e.accept(t),Object(n.forEach)(t.dslMethods,function(e){Object(n.forEach)(e,function(e,t){e.idx=t+1})})})}},function(e,t,r){"use strict";r.r(t),r.d(t,"resolveGrammar",function(){return u}),r.d(t,"GastRefResolverVisitor",function(){return l});var n,i=r(86),a=r(87),s=r(101),o=(n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});function u(e,t){var r=new l(e,t);return r.resolveRefs(),r.errors}var l=function(e){function t(t,r){var n=e.call(this)||this;return n.nameToTopRule=t,n.errMsgProvider=r,n.errors=[],n}return o(t,e),t.prototype.resolveRefs=function(){var e=this;Object(a.forEach)(Object(a.values)(this.nameToTopRule),function(t){e.currTopLevel=t,t.accept(e)})},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var r=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:r,type:i.ParserDefinitionErrorType.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(s.GAstVisitor)},function(e,t,r){"use strict";r.r(t),r.d(t,"EOF_FOLLOW_KEY",function(){return u}),r.d(t,"IN_RULE_RECOVERY_EXCEPTION",function(){return l}),r.d(t,"InRuleRecoveryException",function(){return c}),r.d(t,"Recoverable",function(){return h}),r.d(t,"attemptInRepetitionRecovery",function(){return d});var n=r(91),i=r(87),a=r(112),s=r(102),o=r(86),u={},l="InRuleRecoveryException";function c(e){this.name=l,this.message=e}c.prototype=Error.prototype;var h=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(i.has)(e,"recoveryEnabled")?e.recoveryEnabled:o.DEFAULT_PARSER_CONFIG.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=d)},e.prototype.getTokenToInsert=function(e){var t=Object(n.createTokenInstance)(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,r,n){for(var s=this,o=this.findReSyncTokenType(),u=this.exportLexerState(),l=[],c=!1,h=this.LA(1),d=this.LA(1),p=function(){var e=s.LA(0),t=s.errorMessageProvider.buildMismatchTokenMessage({expected:n,actual:h,previous:e,ruleName:s.getCurrRuleFullName()}),r=new a.MismatchedTokenException(t,h,s.LA(0));r.resyncedTokens=Object(i.dropRight)(l),s.SAVE_ERROR(r)};!c;){if(this.tokenMatcher(d,n))return void p();if(r.call(this))return p(),void e.apply(this,t);this.tokenMatcher(d,o)?c=!0:(d=this.SKIP_TOKEN(),this.addToResyncTokens(d,l))}this.importLexerState(u)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,r){return!1!==r&&void 0!==e&&void 0!==t&&!this.tokenMatcher(this.LA(1),e)&&!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var r=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(r)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var r=this.SKIP_TOKEN();return this.consumeToken(),r}throw new c("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var r=this;if(!this.canTokenTypeBeInsertedInRecovery(e)||Object(i.isEmpty)(t))return!1;var n=this.LA(1);return void 0!==Object(i.find)(t,function(e){return r.tokenMatcher(n,e)})},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),r=this.getFollowSetFromFollowKey(t);return Object(i.contains)(r,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),r=2;;){var n=t.tokenType;if(Object(i.contains)(e,n))return n;t=this.LA(r),r++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return u;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,r=this.RULE_OCCURRENCE_STACK;return Object(i.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)||(t=Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.RULE_STACK[t]}),r=Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.RULE_OCCURRENCE_STACK[t]})),Object(i.map)(t,function(n,i){return 0===i?u:{ruleName:e.shortRuleNameToFullName(n),idxInCallingRule:r[i],inRule:e.shortRuleNameToFullName(t[i-1])}})},e.prototype.flattenFollowSet=function(){var e=this,t=Object(i.map)(this.buildFullFollowKeyStack(),function(t){return e.getFollowSetFromFollowKey(t)});return Object(i.flatten)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===u)return[n.EOF];var t=e.ruleName+e.idxInCallingRule+s.IN+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,n.EOF)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],r=this.LA(1);!1===this.tokenMatcher(r,e);)r=this.SKIP_TOKEN(),this.addToResyncTokens(r,t);return Object(i.dropRight)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,r,n,i,a,s){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(i.cloneArr)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return Object(i.isEmpty)(this.LAST_EXPLICIT_RULE_STACK)?Object(i.map)(this.RULE_STACK,function(t){return e.shortRuleNameToFullName(t)}):Object(i.map)(this.LAST_EXPLICIT_RULE_STACK,function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])})},e}();function d(e,t,r,i,a,s,o){var u=this.getKeyForAutomaticLookahead(i,a),l=this.firstAfterRepMap[u];if(void 0===l){var c=this.getCurrRuleFullName();l=new s(this.getGAstProductions()[c],a).startWalking(),this.firstAfterRepMap[u]=l}var h=l.token,d=l.occurrence,p=l.isEndOfRule;1===this.RULE_STACK.length&&p&&void 0===h&&(h=n.EOF,d=1),this.shouldInRepetitionRecoveryBeTried(h,d,o)&&this.tryInRepetitionRecovery(e,t,r,h)}},function(e,t,r){"use strict";r.r(t),r.d(t,"isRecognitionException",function(){return a}),r.d(t,"MismatchedTokenException",function(){return s}),r.d(t,"NoViableAltException",function(){return o}),r.d(t,"NotAllInputParsedException",function(){return u}),r.d(t,"EarlyExitException",function(){return l});var n=r(87),i=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function a(e){return Object(n.contains)(i,e.name)}function s(e,t,r){this.name="MismatchedTokenException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function o(e,t,r){this.name="NoViableAltException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}function u(e,t){this.name="NotAllInputParsedException",this.message=e,this.token=t,this.resyncedTokens=[]}function l(e,t,r){this.name="EarlyExitException",this.message=e,this.token=t,this.previousToken=r,this.resyncedTokens=[]}Object.freeze(i),s.prototype=Error.prototype,o.prototype=Error.prototype,u.prototype=Error.prototype,l.prototype=Error.prototype},function(e,t,r){"use strict";r.r(t),r.d(t,"LooksAhead",function(){return u});var n=r(107),i=r(87),a=r(86),s=r(104),o=r(100),u=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Object(i.has)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:a.DEFAULT_PARSER_CONFIG.dynamicTokensEnabled,this.maxLookahead=Object(i.has)(e,"maxLookahead")?e.maxLookahead:a.DEFAULT_PARSER_CONFIG.maxLookahead,this.lookAheadFuncsCache=Object(i.isES2015MapSupported)()?new Map:[],Object(i.isES2015MapSupported)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;Object(i.forEach)(e,function(e){t.TRACE_INIT(e.name+" Rule Lookahead",function(){var r=Object(o.collectMethods)(e),a=r.alternation,u=r.repetition,l=r.option,c=r.repetitionMandatory,h=r.repetitionMandatoryWithSeparator,d=r.repetitionWithSeparator;Object(i.forEach)(a,function(r){var i=0===r.idx?"":r.idx;t.TRACE_INIT(""+Object(o.getProductionDslName)(r)+i,function(){var i=Object(n.buildLookaheadFuncForOr)(r.idx,e,r.maxLookahead||t.maxLookahead,r.hasPredicates,t.dynamicTokensEnabled,t.lookAheadBuilderForAlternatives),a=Object(s.getKeyForAutomaticLookahead)(t.fullRuleNameToShort[e.name],s.OR_IDX,r.idx);t.setLaFuncCache(a,i)})}),Object(i.forEach)(u,function(r){t.computeLookaheadFunc(e,r.idx,s.MANY_IDX,n.PROD_TYPE.REPETITION,r.maxLookahead,Object(o.getProductionDslName)(r))}),Object(i.forEach)(l,function(r){t.computeLookaheadFunc(e,r.idx,s.OPTION_IDX,n.PROD_TYPE.OPTION,r.maxLookahead,Object(o.getProductionDslName)(r))}),Object(i.forEach)(c,function(r){t.computeLookaheadFunc(e,r.idx,s.AT_LEAST_ONE_IDX,n.PROD_TYPE.REPETITION_MANDATORY,r.maxLookahead,Object(o.getProductionDslName)(r))}),Object(i.forEach)(h,function(r){t.computeLookaheadFunc(e,r.idx,s.AT_LEAST_ONE_SEP_IDX,n.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,r.maxLookahead,Object(o.getProductionDslName)(r))}),Object(i.forEach)(d,function(r){t.computeLookaheadFunc(e,r.idx,s.MANY_SEP_IDX,n.PROD_TYPE.REPETITION_WITH_SEPARATOR,r.maxLookahead,Object(o.getProductionDslName)(r))})})})},e.prototype.computeLookaheadFunc=function(e,t,r,i,a,o){var u=this;this.TRACE_INIT(""+o+(0===t?"":t),function(){var o=Object(n.buildLookaheadFuncForOptionalProd)(t,e,a||u.maxLookahead,u.dynamicTokensEnabled,i,u.lookAheadBuilderForOptional),l=Object(s.getKeyForAutomaticLookahead)(u.fullRuleNameToShort[e.name],r,t);u.setLaFuncCache(l,o)})},e.prototype.lookAheadBuilderForOptional=function(e,t,r){return Object(n.buildSingleAlternativeLookaheadFunction)(e,t,r)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,r,i){return Object(n.buildAlternativesLookAheadFunc)(e,t,r,i)},e.prototype.getKeyForAutomaticLookahead=function(e,t){var r=this.getLastExplicitRuleShortName();return Object(s.getKeyForAutomaticLookahead)(r,e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"TreeBuilder",function(){return u});var n=r(103),i=r(87),a=r(115),s=r(104),o=r(86),u=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(i.has)(e,"outputCst")?e.outputCst:o.DEFAULT_PARSER_CONFIG.outputCst,this.nodeLocationTracking=Object(i.has)(e,"nodeLocationTracking")?e.nodeLocationTracking:o.DEFAULT_PARSER_CONFIG.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationFull,this.setNodeLocationFromNode=n.setNodeLocationFull,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=n.setNodeLocationOnlyOffset,this.setNodeLocationFromNode=n.setNodeLocationOnlyOffset,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=i.NOOP,this.setNodeLocationFromNode=i.NOOP,this.cstPostRule=i.NOOP,this.setInitialNodeLocation=i.NOOP}else this.cstInvocationStateUpdate=i.NOOP,this.cstFinallyStateUpdate=i.NOOP,this.cstPostTerminal=i.NOOP,this.cstPostNonTerminal=i.NOOP,this.cstPostRule=i.NOOP,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var r={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var r={name:e,children:{}};this.setInitialNodeLocation(r),this.CST_STACK.push(r)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?(r.endOffset=t.endOffset,r.endLine=t.endLine,r.endColumn=t.endColumn):(r.startOffset=NaN,r.startLine=NaN,r.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),r=e.location;r.startOffset<=t.startOffset==!0?r.endOffset=t.endOffset:r.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addTerminalToCst)(r,t,e),this.setNodeLocationFromToken(r.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var r=this.CST_STACK[this.CST_STACK.length-1];Object(n.addNoneTerminalToCst)(r,t,e),this.setNodeLocationFromNode(r.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(Object(i.isUndefined)(this.baseCstVisitorConstructor)){var e=Object(a.createBaseSemanticVisitorConstructor)(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(i.isUndefined)(this.baseCstVisitorWithDefaultsConstructor)){var e=Object(a.createBaseVisitorConstructorWithDefaults)(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var r;return void 0!==e.NAME?(r=e.NAME,this.nestedRuleInvocationStateUpdate(r,t),r):void 0},e.prototype.nestedAltBeforeClause=function(e,t,r,n){var i,a=this.getLastExplicitRuleShortName(),o=Object(s.getKeyForAltIndex)(a,r,t,n);return void 0!==e.NAME?(i=e.NAME,this.nestedRuleInvocationStateUpdate(i,o),{shortName:o,nestedName:i}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var r=this.CST_STACK,i=r[r.length-1];this.nestedRuleFinallyStateUpdate();var a=r[r.length-1];Object(n.addNoneTerminalToCst)(a,t,i),this.setNodeLocationFromNode(a.location,i.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"defaultVisit",function(){return u}),r.d(t,"createBaseSemanticVisitorConstructor",function(){return l}),r.d(t,"createBaseVisitorConstructorWithDefaults",function(){return c}),r.d(t,"CstVisitorDefinitionError",function(){return i}),r.d(t,"validateVisitor",function(){return h}),r.d(t,"validateMissingCstMethods",function(){return d}),r.d(t,"validateRedundantMethods",function(){return m});var n,i,a=r(87),s=r(116),o=r(106);function u(e,t){for(var r=Object(a.keys)(e),n=r.length,i=0;i<n;i++)for(var s=e[r[i]],o=s.length,u=0;u<o;u++){var l=s[u];void 0===l.tokenTypeIdx&&(void 0!==l.fullName?this[l.fullName](l.children,t):this[l.name](l.children,t))}}function l(e,t){var r=function(){};return Object(s.defineNameProp)(r,e+"BaseSemantics"),(r.prototype={visit:function(e,t){if(Object(a.isArray)(e)&&(e=e[0]),!Object(a.isUndefined)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=h(this,t);if(!Object(a.isEmpty)(e)){var r=Object(a.map)(e,function(e){return e.msg});throw Error("Errors Detected in CST Visitor <"+Object(s.functionName)(this.constructor)+">:\n	"+r.join("\n\n").replace(/\n/g,"\n	"))}}}).constructor=r,r._RULE_NAMES=t,r}function c(e,t,r){var n=function(){};Object(s.defineNameProp)(n,e+"BaseSemanticsWithDefaults");var i=Object.create(r.prototype);return Object(a.forEach)(t,function(e){i[e]=u}),(n.prototype=i).constructor=n,n}function h(e,t){var r=d(e,t),n=m(e,t);return r.concat(n)}function d(e,t){var r=Object(a.map)(t,function(t){if(!Object(a.isFunction)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+Object(s.functionName)(e.constructor)+" CST Visitor.",type:i.MISSING_METHOD,methodName:t}});return Object(a.compact)(r)}(n=i||(i={}))[n.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",n[n.MISSING_METHOD=1]="MISSING_METHOD";var p=["constructor","visit","validateVisitor"];function m(e,t){var r=[];for(var n in e)o.validTermsPattern.test(n)&&Object(a.isFunction)(e[n])&&!Object(a.contains)(p,n)&&!Object(a.contains)(t,n)&&r.push({msg:"Redundant visitor method: <"+n+"> on "+Object(s.functionName)(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+o.validTermsPattern.source+"/.",type:i.REDUNDANT_METHOD,methodName:n});return r}},function(e,t,r){"use strict";r.r(t),r.d(t,"classNameFromInstance",function(){return i}),r.d(t,"functionName",function(){return s}),r.d(t,"defineNameProp",function(){return o});var n=r(87);function i(e){return s(e.constructor)}var a=/^\s*function\s*(\S*)\s*\(/;function s(e){return e.name||e.toString().match(a)[1]}function o(e,t){var r=Object.getOwnPropertyDescriptor(e,"name");return!(!Object(n.isUndefined)(r)&&!r.configurable)&&(Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}},function(e,t,r){"use strict";r.r(t),r.d(t,"LexerAdapter",function(){return i});var n=r(86),i=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):n.END_OF_FILE},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?n.END_OF_FILE:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerApi",function(){return l});var n=r(87),i=r(112),a=r(86),s=r(105),o=r(106),u=r(90),l=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,r){return this.consumeInternal(t,e,r)},e.prototype.subrule=function(e,t,r){return this.subruleInternal(t,e,r)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,r){if(void 0===r&&(r=a.DEFAULT_RULE_CONFIG),Object(n.contains)(this.definedRulesNames,e)){var i={message:s.defaultGrammarValidatorErrorProvider.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:a.ParserDefinitionErrorType.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(i)}this.definedRulesNames.push(e);var o=this.defineRule(e,t,r);return this[e]=o,o},e.prototype.OVERRIDE_RULE=function(e,t,r){void 0===r&&(r=a.DEFAULT_RULE_CONFIG);var n=[];n=n.concat(Object(o.validateRuleIsOverridden)(e,this.definedRulesNames,this.className)),this.definitionErrors.push.apply(this.definitionErrors,n);var i=this.defineRule(e,t,r);return this[e]=i,i},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var r=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(Object(i.isRecognitionException)(e))return!1;throw e}finally{this.reloadRecogState(r),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return Object(u.serializeGrammar)(Object(n.values)(this.gastProductionsCache))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"RecognizerEngine",function(){return p});var n=r(87),i=r(104),a=r(112),s=r(107),o=r(108),u=r(86),l=r(111),c=r(91),h=r(97),d=r(116),p=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=Object(d.classNameFromInstance)(this),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=h.tokenStructuredMatcherNoCategories,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(n.has)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n	For Further details.");if(Object(n.isArray)(e)){if(Object(n.isEmpty)(e))throw Error("A Token Vocabulary cannot be empty.\n	Note that the first argument for the parser constructor\n	is no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n	See: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n	For Further details.")}if(Object(n.isArray)(e))this.tokensMap=Object(n.reduce)(e,function(e,t){return e[t.name]=t,e},{});else if(Object(n.has)(e,"modes")&&Object(n.every)(Object(n.flatten)(Object(n.values)(e.modes)),h.isTokenType)){var r=Object(n.flatten)(Object(n.values)(e.modes)),i=Object(n.uniq)(r);this.tokensMap=Object(n.reduce)(i,function(e,t){return e[t.name]=t,e},{})}else{if(!Object(n.isObject)(e))throw Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(n.cloneObj)(e)}this.tokensMap.EOF=c.EOF;var a=Object(n.every)(Object(n.values)(e),function(e){return Object(n.isEmpty)(e.categoryMatches)});this.tokenMatcher=a?h.tokenStructuredMatcherNoCategories:h.tokenStructuredMatcher,Object(h.augmentTokenTypes)(Object(n.values)(this.tokensMap))},e.prototype.defineRule=function(e,t,r){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var a,s=Object(n.has)(r,"resyncEnabled")?r.resyncEnabled:u.DEFAULT_RULE_CONFIG.resyncEnabled,o=Object(n.has)(r,"recoveryValueFunc")?r.recoveryValueFunc:u.DEFAULT_RULE_CONFIG.recoveryValueFunc,l=this.ruleShortNameIdx<<i.BITS_FOR_METHOD_TYPE+i.BITS_FOR_OCCURRENCE_IDX;function c(e){try{if(!0===this.outputCst){t.apply(this,e);var r=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(r),r}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,s,o)}finally{this.ruleFinallyStateUpdate()}}return this.ruleShortNameIdx++,this.shortRuleNameToFull[l]=e,this.fullRuleNameToShort[e]=l,(a=function(t,r){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(l,e,t),c.call(this,r)}).ruleName=e,a.originalGrammarAction=t,a},e.prototype.invokeRuleCatch=function(e,t,r){var n=1===this.RULE_STACK.length,i=t&&!this.isBackTracking()&&this.recoveryEnabled;if(Object(a.isRecognitionException)(e)){if(i){var s,o=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(o))return e.resyncedTokens=this.reSyncTo(o),this.outputCst?((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,s):r();throw this.outputCst&&((s=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,e.partialCstResult=s),e}if(n)return this.moveToTerminatedState(),r()}throw e},e.prototype.optionInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t),n=this.nestedRuleBeforeClause(e,r);try{return this.optionInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.optionInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OPTION_IDX,t);return this.optionInternalLogic(e,t,r)},e.prototype.optionInternalLogic=function(e,t,r){var n,i,a=this,s=this.getLaFuncFromCache(r);if(void 0!==e.DEF){if(n=e.DEF,void 0!==(i=e.GATE)){var o=s;s=function(){return i.call(a)&&o.call(a)}}}else n=e;if(!0===s.call(this))return n.call(this)},e.prototype.atLeastOneInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.atLeastOneInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_IDX,e);this.atLeastOneInternalLogic(e,t,r)},e.prototype.atLeastOneInternalLogic=function(e,t,r){var n,a,u=this,l=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var c=l;l=function(){return a.call(u)&&c.call(u)}}}else n=t;if(!0!==l.call(this))throw this.raiseEarlyExitException(e,s.PROD_TYPE.REPETITION_MANDATORY,t.ERR_MSG);for(var h=this.doSingleRepetition(n);!0===l.call(this)&&!0===h;)h=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],l,i.AT_LEAST_ONE_IDX,e,o.NextTerminalAfterAtLeastOneWalker)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.atLeastOneSepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.AT_LEAST_ONE_SEP_IDX,e);this.atLeastOneSepFirstInternalLogic(e,t,r)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,u=t.SEP;if(!0!==this.getLaFuncFromCache(r).call(this))throw this.raiseEarlyExitException(e,s.PROD_TYPE.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);a.call(this);for(var l=function(){return n.tokenMatcher(n.LA(1),u)};!0===this.tokenMatcher(this.LA(1),u);)this.CONSUME(u),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,u,l,a,o.NextTerminalAfterAtLeastOneSepWalker],l,i.AT_LEAST_ONE_SEP_IDX,e,o.NextTerminalAfterAtLeastOneSepWalker)},e.prototype.manyInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{return this.manyInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manyInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_IDX,e);return this.manyInternalLogic(e,t,r)},e.prototype.manyInternalLogic=function(e,t,r){var n,a,s=this,u=this.getLaFuncFromCache(r);if(void 0!==t.DEF){if(n=t.DEF,void 0!==(a=t.GATE)){var l=u;u=function(){return a.call(s)&&l.call(s)}}}else n=t;for(var c=!0;!0===u.call(this)&&!0===c;)c=this.doSingleRepetition(n);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],u,i.MANY_IDX,e,o.NextTerminalAfterManyWalker,c)},e.prototype.manySepFirstInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e),n=this.nestedRuleBeforeClause(t,r);try{this.manySepFirstInternalLogic(e,t,r)}finally{void 0!==n&&this.nestedRuleFinallyClause(r,n)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var r=this.getKeyForAutomaticLookahead(i.MANY_SEP_IDX,e);this.manySepFirstInternalLogic(e,t,r)},e.prototype.manySepFirstInternalLogic=function(e,t,r){var n=this,a=t.DEF,s=t.SEP;if(!0===this.getLaFuncFromCache(r).call(this)){a.call(this);for(var u=function(){return n.tokenMatcher(n.LA(1),s)};!0===this.tokenMatcher(this.LA(1),s);)this.CONSUME(s),a.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,s,u,a,o.NextTerminalAfterManySepWalker],u,i.MANY_SEP_IDX,e,o.NextTerminalAfterManySepWalker)}},e.prototype.repetitionSepSecondInternal=function(e,t,r,n,a){for(;r();)this.CONSUME(t),n.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,n,a],r,i.AT_LEAST_ONE_SEP_IDX,e,a)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var r=Object(n.isArray)(e)?e:e.DEF,a=this.getKeyForAutomaticLookahead(i.OR_IDX,t),s=this.getLaFuncFromCache(a).call(this,r);if(void 0!==s)return r[s].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var r=this.getKeyForAutomaticLookahead(i.OR_IDX,t),a=this.nestedRuleBeforeClause(e,r);try{var s=Object(n.isArray)(e)?e:e.DEF,o=this.getLaFuncFromCache(r).call(this,s);if(void 0!==o){var u=s[o],l=this.nestedAltBeforeClause(u,t,i.OR_IDX,o);try{return u.ALT.call(this)}finally{void 0!==l&&this.nestedRuleFinallyClause(l.shortName,l.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==a&&this.nestedRuleFinallyClause(r,a)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new a.NotAllInputParsedException(t,e))}},e.prototype.subruleInternal=function(e,t,r){var n;try{var i=void 0!==r?r.ARGS:void 0;return n=e.call(this,t,i),this.cstPostNonTerminal(n,void 0!==r&&void 0!==r.LABEL?r.LABEL:e.ruleName),n}catch(t){this.subruleInternalError(t,r,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,r){throw Object(a.isRecognitionException)(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:r),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,r){var n;try{var i=this.LA(1);!0===this.tokenMatcher(i,e)?(this.consumeToken(),n=i):this.consumeInternalError(e,i,r)}catch(r){n=this.consumeInternalRecovery(e,t,r)}return this.cstPostTerminal(void 0!==r&&void 0!==r.LABEL?r.LABEL:e.name,n),n},e.prototype.consumeInternalError=function(e,t,r){var n,i=this.LA(0);throw n=void 0!==r&&r.ERR_MSG?r.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:i,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new a.MismatchedTokenException(n,t,i))},e.prototype.consumeInternalRecovery=function(e,t,r){if(!this.recoveryEnabled||"MismatchedTokenException"!==r.name||this.isBackTracking())throw r;var n=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,n)}catch(e){throw e.name===l.IN_RULE_RECOVERY_EXCEPTION?r:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=Object(n.cloneArr)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,r){this.RULE_OCCURRENCE_STACK.push(r),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),c.EOF)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ErrorHandler",function(){return o});var n=r(112),i=r(87),a=r(107),s=r(86),o=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Object(i.defaults)(e.errorMessageProvider,s.DEFAULT_PARSER_CONFIG.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(Object(n.isRecognitionException)(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(i.cloneArr)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return Object(i.cloneArr)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,r){for(var i=this.getCurrRuleFullName(),s=this.getGAstProductions()[i],o=Object(a.getLookaheadPathsForOptionalProd)(e,s,t,this.maxLookahead)[0],u=[],l=1;l<=this.maxLookahead;l++)u.push(this.LA(l));var c=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:u,previous:this.LA(0),customUserDescription:r,ruleName:i});throw this.SAVE_ERROR(new n.EarlyExitException(c,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var r=this.getCurrRuleFullName(),i=this.getGAstProductions()[r],s=Object(a.getLookaheadPathsForOr)(e,i,this.maxLookahead),o=[],u=1;u<=this.maxLookahead;u++)o.push(this.LA(u));var l=this.LA(0),c=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:s,actual:o,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new n.NoViableAltException(c,this.LA(1),l))},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"ContentAssist",function(){return a});var n=r(108),i=r(87),a=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var r=this.gastProductionsCache[e];if(Object(i.isUndefined)(r))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Object(n.nextPossibleTokensAfter)([r],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=Object(i.first)(e.ruleStack),r=this.getGAstProductions()[t];return new n.NextAfterTokenWalker(r,e).startWalking()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"GastRecorder",function(){return g});var n=r(87),i=r(90),a=r(92),s=r(97),o=r(91),u=r(86),l=r(104),c={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(c);var h=Math.pow(2,l.BITS_FOR_OCCURRENCE_IDX)-1,d=Object(o.createToken)({name:"RECORDING_PHASE_TOKEN",pattern:a.Lexer.NA});Object(s.augmentTokenTypes)([d]);var p=Object(o.createTokenInstance)(d,"This IToken indicates the Parser is in Recording Phase\n	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(p);var m={name:"This CSTNode indicates the Parser is in Recording Phase\n	See: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},g=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",function(){for(var t=function(t){var r=t>0?t:"";e["CONSUME"+r]=function(e,r){return this.consumeInternalRecord(e,t,r)},e["SUBRULE"+r]=function(e,r){return this.subruleInternalRecord(e,t,r)},e["OPTION"+r]=function(e){return this.optionInternalRecord(e,t)},e["OR"+r]=function(e){return this.orInternalRecord(e,t)},e["MANY"+r]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+r]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+r]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+r]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},r=0;r<10;r++)t(r);e.consume=function(e,t,r){return this.consumeInternalRecord(t,e,r)},e.subrule=function(e,t,r){return this.subruleInternalRecord(t,e,r)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD})},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",function(){for(var t=0;t<10;t++){var r=t>0?t:"";delete e["CONSUME"+r],delete e["SUBRULE"+r],delete e["OPTION"+r],delete e["OR"+r],delete e["MANY"+r],delete e["MANY_SEP"+r],delete e["AT_LEAST_ONE"+r],delete e["AT_LEAST_ONE_SEP"+r]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA})},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return u.END_OF_FILE},e.prototype.topLevelRuleRecord=function(e,t){try{var r=new i.Rule({definition:[],name:e});return r.name=e,this.recordingProdStack.push(r),t.call(this),this.recordingProdStack.pop(),r}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n	 This error was thrown during the "grammar recording phase" For more info see:\n	https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(e){}throw e}},e.prototype.optionInternalRecord=function(e,t){return f.call(this,i.Option,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){f.call(this,i.RepetitionMandatory,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){f.call(this,i.RepetitionMandatoryWithSeparator,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){f.call(this,i.Repetition,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){f.call(this,i.RepetitionWithSeparator,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return E.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,r){if(y(t),!e||!1===Object(n.has)(e,"ruleName")){var a=Error("<SUBRULE"+T(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var s=Object(n.peek)(this.recordingProdStack),o=e.ruleName,u=new i.NonTerminal({idx:t,nonTerminalName:o,referencedRule:void 0});return s.definition.push(u),this.outputCst?m:c},e.prototype.consumeInternalRecord=function(e,t,r){if(y(t),!Object(s.hasShortKeyProperty)(e)){var a=Error("<CONSUME"+T(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw a.KNOWN_RECORDER_ERROR=!0,a}var o=Object(n.peek)(this.recordingProdStack),u=new i.Terminal({idx:t,terminalType:e});return o.definition.push(u),p},e}();function f(e,t,r,i){void 0===i&&(i=!1),y(r);var a=Object(n.peek)(this.recordingProdStack),s=Object(n.isFunction)(t)?t:t.DEF,o=new e({definition:[],idx:r});return Object(n.has)(t,"NAME")&&(o.name=t.NAME),i&&(o.separator=t.SEP),Object(n.has)(t,"MAX_LOOKAHEAD")&&(o.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(o),s.call(this),a.definition.push(o),this.recordingProdStack.pop(),c}function E(e,t){var r=this;y(t);var a=Object(n.peek)(this.recordingProdStack),s=!1===Object(n.isArray)(e),o=!1===s?e:e.DEF,u=new i.Alternation({definition:[],idx:t,ignoreAmbiguities:s&&!0===e.IGNORE_AMBIGUITIES});return Object(n.has)(e,"NAME")&&(u.name=e.NAME),Object(n.has)(e,"MAX_LOOKAHEAD")&&(u.maxLookahead=e.MAX_LOOKAHEAD),u.hasPredicates=Object(n.some)(o,function(e){return Object(n.isFunction)(e.GATE)}),a.definition.push(u),Object(n.forEach)(o,function(e){var t=new i.Flat({definition:[]});u.definition.push(t),Object(n.has)(e,"NAME")&&(t.name=e.NAME),Object(n.has)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Object(n.has)(e,"GATE")&&(t.ignoreAmbiguities=!0),r.recordingProdStack.push(t),e.ALT.call(r),r.recordingProdStack.pop()}),c}function T(e){return 0===e?"":""+e}function y(e){if(e<0||e>h){var t=Error("Invalid DSL Method idx value: <"+e+">\n	Idx value must be a none negative value smaller than "+(h+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}},function(e,t,r){"use strict";r.r(t),r.d(t,"PerformanceTracer",function(){return a});var n=r(87),i=r(86),a=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(Object(n.has)(e,"traceInitPerf")){var t=e.traceInitPerf,r="number"==typeof t;this.traceInitMaxIdent=r?t:1/0,this.traceInitPerf=r?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=i.DEFAULT_PARSER_CONFIG.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var r=Array(this.traceInitIndent+1).join("	");this.traceInitIndent<this.traceInitMaxIdent&&console.log(r+"--\x3e <"+e+">");var i=Object(n.timer)(t),a=i.time,s=i.value,o=a>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&o(r+"<-- <"+e+"> time: "+a+"ms"),this.traceInitIndent--,s}return t()},e}()},function(e,t,r){"use strict";r.r(t),r.d(t,"createSyntaxDiagramsCode",function(){return i});var n=r(85);function i(e,t){var r=void 0===t?{}:t,i=r.resourceBase,a=void 0===i?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/":i,s=r.css;return"\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset=\"utf-8\">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n\n<link rel='stylesheet' href='"+(void 0===s?"https://unpkg.com/chevrotain@"+n.VERSION+"/diagrams/diagrams.css":s)+"'>\n"+("\n<script src='"+a+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+a+"src/diagrams_builder.js'><\/script>\n<script src='"+a+"src/diagrams_behavior.js'><\/script>\n<script src='")+a+'src/main.js\'><\/script>\n\n<div id="diagrams" align="center"></div>    \n\n<script>\n    window.serializedGrammar = '+JSON.stringify(e,null,"  ")+';\n<\/script>\n\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}},function(e,t,r){"use strict";r.r(t),r.d(t,"generateParserFactory",function(){return i}),r.d(t,"generateParserModule",function(){return a});var n=r(126);function i(e){var t=Function("tokenVocabulary","config","chevrotain",Object(n.genWrapperFunction)({name:e.name,rules:e.rules}));return function(n){return t(e.tokenVocabulary,n,r(84))}}function a(e){return Object(n.genUmdModule)({name:e.name,rules:e.rules})}},function(e,t,r){"use strict";r.r(t),r.d(t,"genUmdModule",function(){return a}),r.d(t,"genWrapperFunction",function(){return s}),r.d(t,"genClass",function(){return o}),r.d(t,"genAllRules",function(){return u}),r.d(t,"genRule",function(){return l}),r.d(t,"genTerminal",function(){return c}),r.d(t,"genNonTerminal",function(){return h}),r.d(t,"genAlternation",function(){return d}),r.d(t,"genSingleAlt",function(){return p});var n=r(87),i=r(90);function a(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+o(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}function s(e){return"    \n"+o(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}function o(e){return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+u(e.rules)+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n"+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function u(e){return Object(n.map)(e,function(e){return l(e,1)}).join("\n")}function l(e,t){var r=E(t,'$.RULE("'+e.name+'", function() {')+"\n";return r+=f(e.definition,t+1),r+=E(t+1,"})")+"\n"}function c(e,t){var r=e.terminalType.name;return E(t,"$.CONSUME"+e.idx+"(this.tokensMap."+r+")\n")}function h(e,t){return E(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")\n")}function d(e,t){var r=E(t,"$.OR"+e.idx+"([")+"\n";return r+=Object(n.map)(e.definition,function(e){return p(e,t+1)}).join(",\n"),r+="\n"+E(t,"])\n")}function p(e,t){var r=E(t,"{")+"\n";return e.name&&(r+=E(t+1,'NAME: "'+e.name+'",')+"\n"),r+=E(t+1,"ALT: function() {")+"\n",r+=f(e.definition,t+1),r+=E(t+1,"}")+"\n",r+=E(t,"}")}function m(e,t,r){var n=E(r,"$."+(e+t.idx)+"(");return t.name||t.separator?(n+="{\n",t.name&&(n+=E(r+1,'NAME: "'+t.name+'"')+",\n"),t.separator&&(n+=E(r+1,"SEP: this.tokensMap."+t.separator.name)+",\n"),n+="DEF: "+g(t.definition,r+2)+"\n",n+=E(r,"}")+"\n"):n+=g(t.definition,r+1),n+=E(r,")")+"\n"}function g(e,t){var r="function() {\n";return r+=f(e,t),r+=E(t,"}")+"\n"}function f(e,t){var r="";return Object(n.forEach)(e,function(e){r+=function(e,t){if(e instanceof i.NonTerminal)return h(e,t);if(e instanceof i.Option)return m("OPTION",e,t);if(e instanceof i.RepetitionMandatory)return m("AT_LEAST_ONE",e,t);if(e instanceof i.RepetitionMandatoryWithSeparator)return m("AT_LEAST_ONE_SEP",e,t);if(e instanceof i.RepetitionWithSeparator)return m("MANY_SEP",e,t);if(e instanceof i.Repetition)return m("MANY",e,t);if(e instanceof i.Alternation)return d(e,t);if(e instanceof i.Terminal)return c(e,t);if(e instanceof i.Flat)return f(e.definition,t);throw Error("non exhaustive match")}(e,t+1)}),r}function E(e,t){return Array(4*e+1).join(" ")+t}},function(e,t,r){"use strict";t.__esModule=!0,t.buildTimesOpAst=t.buildStringAst=t.buildRowRangeAst=t.buildProcedureAst=t.buildPowerOpAst=t.buildPlusUnaryOpAst=t.buildPlusOpAst=t.buildPercentOpAst=t.buildParsingErrorAst=t.buildParenthesisAst=t.buildNumberAst=t.buildNotEqualOpAst=t.buildNamedExpressionAst=t.buildMinusUnaryOpAst=t.buildMinusOpAst=t.buildLessThanOrEqualOpAst=t.buildLessThanOpAst=t.buildGreaterThanOrEqualOpAst=t.buildGreaterThanOpAst=t.buildErrorWithRawInputAst=t.buildEqualsOpAst=t.buildEmptyArgAst=t.buildDivOpAst=t.buildConcatenateOpAst=t.buildColumnRangeAst=t.buildCellReferenceAst=t.buildCellRangeAst=t.buildCellErrorAst=t.buildArrayAst=t.RangeSheetReferenceType=t.ParsingErrorType=t.AstNodeType=void 0,t.imageWithWhitespace=function(e,t){return(null!=t?t:"")+e},t.parsingError=void 0;var n,i,a,s,o,u,l=r(73);function c(e,t,r){if(void 0!==e.sheet&&void 0===t.sheet||void 0===e.sheet&&void 0!==t.sheet)throw Error("Start address inconsistent with end address");if(void 0===e.sheet&&r!==u.RELATIVE||void 0!==e.sheet&&r===u.RELATIVE)throw Error("Sheet address inconsistent with sheet reference type")}t.parsingError=(e,t)=>({type:e,message:t}),(n=s||(t.ParsingErrorType=s={})).LexingError="LexingError",n.ParserError="ParsingError",n.StaticOffsetError="StaticOffsetError",n.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",n.RangeOffsetNotAllowed="RangeOffsetNotAllowed",n.InvalidRangeSize="InvalidRangeSize",(i=o||(t.AstNodeType=o={})).EMPTY="EMPTY",i.NUMBER="NUMBER",i.STRING="STRING",i.MINUS_UNARY_OP="MINUS_UNARY_OP",i.PLUS_UNARY_OP="PLUS_UNARY_OP",i.PERCENT_OP="PERCENT_OP",i.CONCATENATE_OP="CONCATENATE_OP",i.EQUALS_OP="EQUALS_OP",i.NOT_EQUAL_OP="NOT_EQUAL_OP",i.GREATER_THAN_OP="GREATER_THAN_OP",i.LESS_THAN_OP="LESS_THAN_OP",i.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",i.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",i.PLUS_OP="PLUS_OP",i.MINUS_OP="MINUS_OP",i.TIMES_OP="TIMES_OP",i.DIV_OP="DIV_OP",i.POWER_OP="POWER_OP",i.FUNCTION_CALL="FUNCTION_CALL",i.NAMED_EXPRESSION="NAMED_EXPRESSION",i.PARENTHESIS="PARENTHESES",i.CELL_REFERENCE="CELL_REFERENCE",i.CELL_RANGE="CELL_RANGE",i.COLUMN_RANGE="COLUMN_RANGE",i.ROW_RANGE="ROW_RANGE",i.ERROR="ERROR",i.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT",i.ARRAY="ARRAY",(a=u||(t.RangeSheetReferenceType=u={}))[a.RELATIVE=0]="RELATIVE",a[a.START_ABSOLUTE=1]="START_ABSOLUTE",a[a.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE",t.buildEmptyArgAst=e=>({type:o.EMPTY,leadingWhitespace:null==e?void 0:e.image}),t.buildNumberAst=(e,t)=>({type:o.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildStringAst=e=>{var t;return{type:o.STRING,value:e.image.slice(1,-1),leadingWhitespace:null==(t=e.leadingWhitespace)?void 0:t.image}},t.buildCellReferenceAst=(e,t)=>({type:o.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}),t.buildCellRangeAst=(e,t,r,n)=>(c(e,t,r),{type:o.CELL_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:n}),t.buildColumnRangeAst=(e,t,r,n)=>(c(e,t,r),{type:o.COLUMN_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),t.buildRowRangeAst=(e,t,r,n)=>(c(e,t,r),{type:o.ROW_RANGE,start:e,end:t,sheetReferenceType:r,leadingWhitespace:null==n?void 0:n.image}),t.buildConcatenateOpAst=(e,t,r)=>({type:o.CONCATENATE_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildEqualsOpAst=(e,t,r)=>({type:o.EQUALS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildNotEqualOpAst=(e,t,r)=>({type:o.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildGreaterThanOpAst=(e,t,r)=>({type:o.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildLessThanOpAst=(e,t,r)=>({type:o.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildGreaterThanOrEqualOpAst=(e,t,r)=>({type:o.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildLessThanOrEqualOpAst=(e,t,r)=>({type:o.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildPlusOpAst=(e,t,r)=>({type:o.PLUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildMinusOpAst=(e,t,r)=>({type:o.MINUS_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildTimesOpAst=(e,t,r)=>({type:o.TIMES_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildDivOpAst=(e,t,r)=>({type:o.DIV_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildPowerOpAst=(e,t,r)=>({type:o.POWER_OP,left:e,right:t,leadingWhitespace:null==r?void 0:r.image}),t.buildMinusUnaryOpAst=(e,t)=>({type:o.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildPlusUnaryOpAst=(e,t)=>({type:o.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildPercentOpAst=(e,t)=>({type:o.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}),t.buildProcedureAst=(e,t,r,n,i)=>({type:o.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==r?void 0:r.image,internalWhitespace:null==n?void 0:n.image,hyperlink:i}),t.buildArrayAst=(e,t,r)=>({type:o.ARRAY,args:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),t.buildNamedExpressionAst=(e,t)=>({type:o.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}),t.buildParenthesisAst=(e,t,r)=>({type:o.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==r?void 0:r.image}),t.buildCellErrorAst=(e,t)=>({type:o.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}),t.buildErrorWithRawInputAst=(e,t,r)=>({type:o.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==r?void 0:r.image}),t.buildParsingErrorAst=()=>({type:o.ERROR,error:l.CellError.parsingError()})},function(e,t,r){"use strict";t.__esModule=!0,t.binaryOpTokenMap=void 0;var n=r(127);t.binaryOpTokenMap={[n.AstNodeType.PLUS_OP]:"+",[n.AstNodeType.MINUS_OP]:"-",[n.AstNodeType.TIMES_OP]:"*",[n.AstNodeType.DIV_OP]:"/",[n.AstNodeType.CONCATENATE_OP]:"&",[n.AstNodeType.POWER_OP]:"^",[n.AstNodeType.EQUALS_OP]:"=",[n.AstNodeType.NOT_EQUAL_OP]:"<>",[n.AstNodeType.GREATER_THAN_OP]:">",[n.AstNodeType.GREATER_THAN_OR_EQUAL_OP]:">=",[n.AstNodeType.LESS_THAN_OP]:"<",[n.AstNodeType.LESS_THAN_OR_EQUAL_OP]:"<="}},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainFunctions=t.Cache=void 0;var n=r(77);t.Cache=class{constructor(e){this.functionRegistry=e,this.cache=new Map}set(e,t){let r,a,s=(r=(0,n.collectDependencies)(t,this.functionRegistry),a=i(t,this.functionRegistry.isFunctionVolatile),{ast:t,relativeDependencies:r,hasVolatileFunction:a,hasStructuralChangeFunction:i(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange)});return this.cache.set(e,s),s}get(e){return this.cache.get(e)}maybeSetAndThenGet(e,t){let r=this.cache.get(e);return void 0!==r?r.ast:(this.set(e,t),t)}};let i=(e,t)=>{switch(e.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:case n.AstNodeType.ERROR_WITH_RAW_INPUT:case n.AstNodeType.CELL_REFERENCE:case n.AstNodeType.CELL_RANGE:case n.AstNodeType.COLUMN_RANGE:case n.AstNodeType.ROW_RANGE:case n.AstNodeType.NAMED_EXPRESSION:return!1;case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return i(e.value,t);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return i(e.left,t)||i(e.right,t);case n.AstNodeType.PARENTHESIS:return i(e.expression,t);case n.AstNodeType.FUNCTION_CALL:return!!t(e.procedureName)||e.args.some(e=>i(e,t));case n.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>i(e,t)))}};t.doesContainFunctions=i},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaParser=t.FormulaLexer=void 0,r(2);var n=r(84),i=r(73),a=r(131),s=r(78),o=r(127),u=r(79),l=r(132);class c extends n.EmbeddedActionsParser{constructor(e,t){super(e.allTokens,{outputCst:!1,maxLookahead:7}),this.booleanExpressionOrEmpty=this.RULE("booleanExpressionOrEmpty",()=>this.OR([{ALT:()=>this.SUBRULE(this.booleanExpression)},{ALT:(0,n.EMPTY_ALT)((0,o.buildEmptyArgAst)())}])),this.procedureExpression=this.RULE("procedureExpression",()=>{var e;let t=this.CONSUME(l.ProcedureName),r=t.image.toUpperCase().slice(0,-1),n=null!=(e=this.lexerConfig.functionMapping[r])?e:r,i=[],a=this.SUBRULE(this.booleanExpressionOrEmpty);this.MANY(()=>{var e;let t=this.CONSUME(this.lexerConfig.ArgSeparator);a.type===o.AstNodeType.EMPTY&&(a.leadingWhitespace=null==(e=t.leadingWhitespace)?void 0:e.image),i.push(a),a=this.SUBRULE2(this.booleanExpressionOrEmpty)}),i.push(a),1===i.length&&i[0].type===o.AstNodeType.EMPTY&&(i.length=0);let s=this.CONSUME(l.RParen);return(0,o.buildProcedureAst)(n,i,t.leadingWhitespace,s.leadingWhitespace)}),this.namedExpressionExpression=this.RULE("namedExpressionExpression",()=>{let e=this.CONSUME(l.NamedExpression);return(0,o.buildNamedExpressionAst)(e.image,e.leadingWhitespace)}),this.offsetProcedureExpression=this.RULE("offsetProcedureExpression",()=>{let e=[];return this.CONSUME(this.lexerConfig.OffsetProcedureName),this.CONSUME(l.LParen),this.MANY_SEP({SEP:this.lexerConfig.ArgSeparator,DEF:()=>{e.push(this.SUBRULE(this.booleanExpression))}}),this.CONSUME(l.RParen),this.handleOffsetHeuristic(e)}),this.columnRangeExpression=this.RULE("columnRangeExpression",()=>{let e=this.CONSUME(l.ColumnRange),[t,r]=e.image.split(":"),n=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,t,this.formulaAddress)),a=this.ACTION(()=>(0,s.columnAddressFromString)(this.sheetMapping,r,this.formulaAddress));if(void 0===n||void 0===a)return(0,o.buildCellErrorAst)(new i.CellError(i.ErrorType.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns))return(0,o.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==a.sheet)return this.parsingError(o.ParsingErrorType.ParserError,"Malformed range expression");let{firstEnd:u,secondEnd:h,sheetRefType:d}=c.fixSheetIdsForRangeEnds(n,a);return(0,o.buildColumnRangeAst)(u,h,d,e.leadingWhitespace)}),this.rowRangeExpression=this.RULE("rowRangeExpression",()=>{let e=this.CONSUME(l.RowRange),[t,r]=e.image.split(":"),n=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,t,this.formulaAddress)),a=this.ACTION(()=>(0,s.rowAddressFromString)(this.sheetMapping,r,this.formulaAddress));if(void 0===n||void 0===a)return(0,o.buildCellErrorAst)(new i.CellError(i.ErrorType.REF));if(n.exceedsSheetSizeLimits(this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxRows))return(0,o.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace);if(void 0===n.sheet&&void 0!==a.sheet)return this.parsingError(o.ParsingErrorType.ParserError,"Malformed range expression");let{firstEnd:u,secondEnd:h,sheetRefType:d}=c.fixSheetIdsForRangeEnds(n,a);return(0,o.buildRowRangeAst)(u,h,d,e.leadingWhitespace)}),this.cellReference=this.RULE("cellReference",()=>{let e=this.CONSUME(l.CellReference),t=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===t?(0,o.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?(0,o.buildErrorWithRawInputAst)(e.image,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace):(0,o.buildCellReferenceAst)(t,e.leadingWhitespace)}),this.endRangeReference=this.RULE("endRangeReference",e=>{var t;let r=this.CONSUME(l.CellReference),n=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress)),a=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,r.image,this.formulaAddress));return void 0===n||void 0===a?this.ACTION(()=>(0,o.buildErrorWithRawInputAst)(`${e.image}:${r.image}`,new i.CellError(i.ErrorType.REF),e.leadingWhitespace)):n.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(this.lexerConfig.maxColumns,this.lexerConfig.maxRows)?this.ACTION(()=>(0,o.buildErrorWithRawInputAst)(`${e.image}:${r.image}`,new i.CellError(i.ErrorType.NAME),e.leadingWhitespace)):this.buildCellRange(n,a,null==(t=e.leadingWhitespace)?void 0:t.image)}),this.endOfRangeExpression=this.RULE("endOfRangeExpression",e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeReference,{ARGS:[e]})},{ALT:()=>{var t;let r=this.SUBRULE(this.offsetProcedureExpression),n=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,e.image,this.formulaAddress));return void 0===n?(0,o.buildCellErrorAst)(new i.CellError(i.ErrorType.REF)):r.type===o.AstNodeType.CELL_REFERENCE?this.buildCellRange(n,r.reference,null==(t=e.leadingWhitespace)?void 0:t.image):this.parsingError(o.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.cellRangeExpression=this.RULE("cellRangeExpression",()=>{let e=this.CONSUME(l.CellReference);return this.CONSUME2(l.RangeSeparator),this.SUBRULE(this.endOfRangeExpression,{ARGS:[e]})}),this.endRangeWithOffsetStartReference=this.RULE("endRangeWithOffsetStartReference",e=>{let t=this.CONSUME(l.CellReference),r=this.ACTION(()=>(0,s.cellAddressFromString)(this.sheetMapping,t.image,this.formulaAddress));return void 0===r?this.ACTION(()=>(0,o.buildCellErrorAst)(new i.CellError(i.ErrorType.REF))):this.buildCellRange(e.reference,r,e.leadingWhitespace)}),this.endOfRangeWithOffsetStartExpression=this.RULE("endOfRangeWithOffsetStartExpression",e=>this.OR([{ALT:()=>this.SUBRULE(this.endRangeWithOffsetStartReference,{ARGS:[e]})},{ALT:()=>{let t=this.SUBRULE(this.offsetProcedureExpression);return t.type===o.AstNodeType.CELL_REFERENCE?this.buildCellRange(e.reference,t.reference,e.leadingWhitespace):this.parsingError(o.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here")}}])),this.offsetExpression=this.RULE("offsetExpression",()=>{let e,t=this.SUBRULE(this.offsetProcedureExpression);return this.OPTION(()=>{this.CONSUME(l.RangeSeparator),e=t.type===o.AstNodeType.CELL_RANGE?this.parsingError(o.ParsingErrorType.RangeOffsetNotAllowed,"Range offset not allowed here"):this.SUBRULE(this.endOfRangeWithOffsetStartExpression,{ARGS:[t]})}),void 0!==e?e:t}),this.insideArrayExpression=this.RULE("insideArrayExpression",()=>{let e=[[]];return e[e.length-1].push(this.SUBRULE(this.booleanExpression)),this.MANY(()=>{this.OR([{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayColSeparator),e[e.length-1].push(this.SUBRULE2(this.booleanExpression))}},{ALT:()=>{this.CONSUME(this.lexerConfig.ArrayRowSeparator),e.push([]),e[e.length-1].push(this.SUBRULE3(this.booleanExpression))}}])}),(0,o.buildArrayAst)(e)}),this.parenthesisExpression=this.RULE("parenthesisExpression",()=>{let e=this.CONSUME(l.LParen),t=this.SUBRULE(this.booleanExpression),r=this.CONSUME(l.RParen);return(0,o.buildParenthesisAst)(t,e.leadingWhitespace,r.leadingWhitespace)}),this.arrayExpression=this.RULE("arrayExpression",()=>this.OR([{ALT:()=>{let e=this.CONSUME(l.ArrayLParen),t=this.SUBRULE(this.insideArrayExpression),r=this.CONSUME(l.ArrayRParen);return(0,o.buildArrayAst)(t.args,e.leadingWhitespace,r.leadingWhitespace)}},{ALT:()=>this.SUBRULE(this.parenthesisExpression)}])),this.numericStringToNumber=e=>Number(e.replace(this.lexerConfig.decimalSeparator,".")),this.positiveAtomicExpression=this.RULE("positiveAtomicExpression",()=>{var e;return this.OR(null!=(e=this.atomicExpCache)?e:this.atomicExpCache=[{ALT:()=>this.SUBRULE(this.arrayExpression)},{ALT:()=>this.SUBRULE(this.cellRangeExpression)},{ALT:()=>this.SUBRULE(this.columnRangeExpression)},{ALT:()=>this.SUBRULE(this.rowRangeExpression)},{ALT:()=>this.SUBRULE(this.offsetExpression)},{ALT:()=>this.SUBRULE(this.cellReference)},{ALT:()=>this.SUBRULE(this.procedureExpression)},{ALT:()=>this.SUBRULE(this.namedExpressionExpression)},{ALT:()=>{let e=this.CONSUME(this.lexerConfig.NumberLiteral);return(0,o.buildNumberAst)(this.numericStringToNumber(e.image),e.leadingWhitespace)}},{ALT:()=>{let e=this.CONSUME(l.StringLiteral);return(0,o.buildStringAst)(e)}},{ALT:()=>{let e=this.CONSUME(l.ErrorLiteral),t=e.image.toUpperCase(),r=this.lexerConfig.errorMapping[t];return r?(0,o.buildCellErrorAst)(new i.CellError(r),e.leadingWhitespace):this.parsingError(o.ParsingErrorType.ParserError,"Unknown error literal")}}])}),this.rightUnaryOpAtomicExpression=this.RULE("rightUnaryOpAtomicExpression",()=>{let e=this.SUBRULE(this.positiveAtomicExpression),t=this.OPTION(()=>this.CONSUME(l.PercentOp));return t?(0,o.buildPercentOpAst)(e,t.leadingWhitespace):e}),this.atomicExpression=this.RULE("atomicExpression",()=>this.OR([{ALT:()=>{let e=this.CONSUME(l.AdditionOp),t=this.SUBRULE(this.atomicExpression);return(0,n.tokenMatcher)(e,l.PlusOp)?(0,o.buildPlusUnaryOpAst)(t,e.leadingWhitespace):(0,n.tokenMatcher)(e,l.MinusOp)?(0,o.buildMinusUnaryOpAst)(t,e.leadingWhitespace):(this.customParsingError=(0,o.parsingError)(o.ParsingErrorType.ParserError,"Mismatched token type"),this.customParsingError)}},{ALT:()=>this.SUBRULE2(this.rightUnaryOpAtomicExpression)}])),this.powerExpression=this.RULE("powerExpression",()=>{let e=this.SUBRULE(this.atomicExpression);return this.MANY(()=>{let t=this.CONSUME(l.PowerOp),r=this.SUBRULE2(this.atomicExpression);(0,n.tokenMatcher)(t,l.PowerOp)?e=(0,o.buildPowerOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.multiplicationExpression=this.RULE("multiplicationExpression",()=>{let e=this.SUBRULE(this.powerExpression);return this.MANY(()=>{let t=this.CONSUME(l.MultiplicationOp),r=this.SUBRULE2(this.powerExpression);(0,n.tokenMatcher)(t,l.TimesOp)?e=(0,o.buildTimesOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.DivOp)?e=(0,o.buildDivOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.additionExpression=this.RULE("additionExpression",()=>{let e=this.SUBRULE(this.multiplicationExpression);return this.MANY(()=>{let t=this.CONSUME(l.AdditionOp),r=this.SUBRULE2(this.multiplicationExpression);(0,n.tokenMatcher)(t,l.PlusOp)?e=(0,o.buildPlusOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.MinusOp)?e=(0,o.buildMinusOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.concatenateExpression=this.RULE("concatenateExpression",()=>{let e=this.SUBRULE(this.additionExpression);return this.MANY(()=>{let t=this.CONSUME(l.ConcatenateOp),r=this.SUBRULE2(this.additionExpression);e=(0,o.buildConcatenateOpAst)(e,r,t.leadingWhitespace)}),e}),this.booleanExpression=this.RULE("booleanExpression",()=>{let e=this.SUBRULE(this.concatenateExpression);return this.MANY(()=>{let t=this.CONSUME(l.BooleanOp),r=this.SUBRULE2(this.concatenateExpression);(0,n.tokenMatcher)(t,l.EqualsOp)?e=(0,o.buildEqualsOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.NotEqualOp)?e=(0,o.buildNotEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.GreaterThanOp)?e=(0,o.buildGreaterThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.LessThanOp)?e=(0,o.buildLessThanOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.GreaterThanOrEqualOp)?e=(0,o.buildGreaterThanOrEqualOpAst)(e,r,t.leadingWhitespace):(0,n.tokenMatcher)(t,l.LessThanOrEqualOp)?e=(0,o.buildLessThanOrEqualOpAst)(e,r,t.leadingWhitespace):this.ACTION(()=>{throw Error("Operator not supported")})}),e}),this.formula=this.RULE("formula",()=>(this.CONSUME(l.EqualsOp),this.SUBRULE(this.booleanExpression))),this.lexerConfig=e,this.sheetMapping=t,this.formulaAddress=(0,i.simpleCellAddress)(0,0,0),this.performSelfAnalysis()}parseFromTokens(e,t){this.input=e;let r=this.formulaWithContext(t),n=[];return this.customParsingError&&n.push(this.customParsingError),(n=n.concat(this.errors.map(e=>({type:o.ParsingErrorType.ParserError,message:e.message})))).length>0&&(r=(0,o.buildParsingErrorAst)()),{ast:r,errors:n}}reset(){super.reset(),this.customParsingError=void 0}formulaWithContext(e){return this.formulaAddress=e,this.formula()}buildCellRange(e,t,r){if(void 0===e.sheet&&void 0!==t.sheet)return this.parsingError(o.ParsingErrorType.ParserError,"Malformed range expression");let{firstEnd:n,secondEnd:i,sheetRefType:a}=c.fixSheetIdsForRangeEnds(e,t);return(0,o.buildCellRangeAst)(n,i,a,r)}static fixSheetIdsForRangeEnds(e,t){let r=c.rangeSheetReferenceType(e.sheet,t.sheet);return{firstEnd:e,secondEnd:void 0!==e.sheet&&void 0===t.sheet?t.withSheet(e.sheet):t,sheetRefType:r}}handleOffsetHeuristic(e){let t,r,n,s,l=e[0];if(l.type!==o.AstNodeType.CELL_REFERENCE)return this.parsingError(o.ParsingErrorType.StaticOffsetError,"First argument to OFFSET is not a reference");let c=e[1];if(c.type===o.AstNodeType.NUMBER&&Number.isInteger(c.value))t=c.value;else if(c.type===o.AstNodeType.PLUS_UNARY_OP&&c.value.type===o.AstNodeType.NUMBER&&Number.isInteger(c.value.value))t=c.value.value;else{if(c.type!==o.AstNodeType.MINUS_UNARY_OP||c.value.type!==o.AstNodeType.NUMBER||!Number.isInteger(c.value.value))return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Second argument to OFFSET is not a static number");t=-c.value.value}let h=e[2];if(h.type===o.AstNodeType.NUMBER&&Number.isInteger(h.value))r=h.value;else if(h.type===o.AstNodeType.PLUS_UNARY_OP&&h.value.type===o.AstNodeType.NUMBER&&Number.isInteger(h.value.value))r=h.value.value;else{if(h.type!==o.AstNodeType.MINUS_UNARY_OP||h.value.type!==o.AstNodeType.NUMBER||!Number.isInteger(h.value.value))return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Third argument to OFFSET is not a static number");r=-h.value.value}let d=e[3];if(void 0===d)n=1;else{if(d.type!==o.AstNodeType.NUMBER)return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((n=d.value)<1)return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(n))return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fourth argument to OFFSET is not integer")}let p=e[4];if(void 0===p)s=1;else{if(p.type!==o.AstNodeType.NUMBER)return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((s=p.value)<1)return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(s))return this.parsingError(o.ParsingErrorType.StaticOffsetError,"Fifth argument to OFFSET is not integer")}let m=new u.CellAddress(l.reference.col+r,l.reference.row+t,l.reference.type),g=m.col,f=m.row;if(l.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&l.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_COL||(f+=this.formulaAddress.row),l.reference.type!==u.CellReferenceType.CELL_REFERENCE_RELATIVE&&l.reference.type!==u.CellReferenceType.CELL_REFERENCE_ABSOLUTE_ROW||(g+=this.formulaAddress.col),g<0||f<0)return(0,o.buildCellErrorAst)(new i.CellError(i.ErrorType.REF,a.ErrorMessage.OutOfSheet));if(1===s&&1===n)return(0,o.buildCellReferenceAst)(m);{let e=new u.CellAddress(m.col+s-1,m.row+n-1,m.type);return(0,o.buildCellRangeAst)(m,e,o.RangeSheetReferenceType.RELATIVE)}}parsingError(e,t){return this.customParsingError=(0,o.parsingError)(e,t),(0,o.buildParsingErrorAst)()}static rangeSheetReferenceType(e,t){return void 0===e?o.RangeSheetReferenceType.RELATIVE:void 0===t?o.RangeSheetReferenceType.START_ABSOLUTE:o.RangeSheetReferenceType.BOTH_ABSOLUTE}}t.FormulaParser=c;class h{constructor(e){this.lexerConfig=e,this.lexer=new n.Lexer(e.allTokens,{ensureOptimizations:!0})}tokenizeFormula(e){let t=this.lexer.tokenize(e),r=t.tokens;return r=this.trimTrailingWhitespaces(r),r=this.skipWhitespacesInsideRanges(r),t.tokens=r=this.skipWhitespacesBeforeArgSeparators(r),t}skipWhitespacesInsideRanges(e){return h.filterTokensByNeighbors(e,(e,t,r)=>((0,n.tokenMatcher)(e,l.CellReference)||(0,n.tokenMatcher)(e,l.RangeSeparator))&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&((0,n.tokenMatcher)(r,l.CellReference)||(0,n.tokenMatcher)(r,l.RangeSeparator)))}skipWhitespacesBeforeArgSeparators(e){return h.filterTokensByNeighbors(e,(e,t,r)=>!(0,n.tokenMatcher)(e,this.lexerConfig.ArgSeparator)&&(0,n.tokenMatcher)(t,this.lexerConfig.WhiteSpace)&&(0,n.tokenMatcher)(r,this.lexerConfig.ArgSeparator))}static filterTokensByNeighbors(e,t){if(e.length<3)return e;let r=0,n=[e[r++]];for(;r<e.length-1;)t(e[r-1],e[r],e[r+1])||n.push(e[r]),++r;return n.push(e[r]),n}trimTrailingWhitespaces(e){return e.length>0&&(0,n.tokenMatcher)(e[e.length-1],this.lexerConfig.WhiteSpace)&&e.pop(),e}}t.FormulaLexer=h},function(e,t,r){"use strict";t.__esModule=!0,t.ErrorMessage=void 0;class n{}t.ErrorMessage=n,n.DistinctSigns="Distinct signs.",n.WrongArgNumber="Wrong number of arguments.",n.EmptyArg="Empty function argument.",n.EmptyArray="Empty array not allowed.",n.ArrayDimensions="Array dimensions are not compatible.",n.NoSpaceForArrayResult="No space for array result.",n.ValueSmall="Value too small.",n.ValueLarge="Value too large.",n.BadCriterion="Incorrect criterion.",n.RangeManySheets="Range spans more than one sheet.",n.CellRangeExpected="Cell range expected.",n.WrongDimension="Wrong range dimension.",n.ScalarExpected="Cell range not allowed.",n.NumberCoercion="Value cannot be coerced to number.",n.NumberExpected="Number argument expected.",n.IntegerExpected="Value needs to be an integer.",n.BadMode="Mode not recognized.",n.DateBounds="Date outside of bounds.",n.OutOfSheet="Resulting reference is out of the sheet.",n.WrongType="Wrong type of argument.",n.NaN="NaN or infinite value encountered.",n.EqualLength="Ranges need to be of equal length.",n.Negative="Value cannot be negative.",n.NotBinary="String does not represent a binary number.",n.NotOctal="String does not represent an octal number.",n.NotHex="String does not represent a hexadecimal number.",n.EndStartPeriod="End period needs to be at least start period.",n.CellRefExpected="Cell reference expected.",n.EmptyRange="Empty range not allowed.",n.BadRef="Address is not correct.",n.NumberRange="Number-only range expected.",n.ValueNotFound="Value not found.",n.ValueBaseLarge="Value in base too large.",n.ValueBaseSmall="Value in base too small.",n.ValueBaseLong="Value in base too long.",n.NegativeLength="Length cannot be negative.",n.PatternNotFound="Pattern not found.",n.OneValue="Needs at least one value.",n.TwoValues="Range needs to contain at least two elements.",n.ThreeValues="Range needs to contain at least three elements.",n.IndexBounds="Index out of bounds.",n.IndexLarge="Index too large.",n.Formula="Expected formula.",n.NegativeCount="Count cannot be negative.",n.ParseError="Parsing error.",n.SheetRef="Sheet does not exist.",n.PeriodLong="Period number cannot exceed life length.",n.InvalidDate="Invalid date.",n.BitshiftLong="Result of bitshift is too long.",n.EmptyString="Empty-string argument not allowed.",n.LengthBounds="Length out of bounds.",n.NegativeTime="Time cannot be negative.",n.NoDefault="No default option.",n.NoConditionMet="None of the conditions were met.",n.Selector="Selector cannot exceed the number of arguments.",n.StartEndDate="Start date needs to be earlier than end date.",n.IncorrectDateTime="String does not represent correct DateTime.",n.CharacterCodeBounds="Character code out of bounds.",n.NonZero="Argument cannot be 0.",n.LessThanOne="Argument cannot be less than 1.",n.WeekendString="Incorrect weekend bitmask string.",n.InvalidRoman="Invalid roman numeral.",n.WrongOrder="Wrong order of values.",n.ComplexNumberExpected="Complex number expected.",n.ShouldBeIorJ="Should be 'i' or 'j'.",n.SizeMismatch="Array dimensions mismatched.",n.FunctionName=e=>`Function name ${e} not recognized.`,n.NamedExpressionName=e=>`Named expression ${e} not recognized.`,n.LicenseKey=e=>`License key is ${e}.`},function(e,t,r){"use strict";t.__esModule=!0,t.buildLexerConfig=t.TimesOp=t.StringLiteral=t.RowRange=t.RangeSeparator=t.RParen=t.ProcedureName=t.PowerOp=t.PlusOp=t.PercentOp=t.NotEqualOp=t.NamedExpression=t.MultiplicationOp=t.MinusOp=t.LessThanOrEqualOp=t.LessThanOp=t.LParen=t.GreaterThanOrEqualOp=t.GreaterThanOp=t.ErrorLiteral=t.EqualsOp=t.DivOp=t.ConcatenateOp=t.ColumnRange=t.CellReference=t.BooleanOp=t.ArrayRParen=t.ArrayLParen=t.AdditionOp=void 0;var n=r(84),i=r(82),a=r(133),s=r(134);let o=t.AdditionOp=(0,n.createToken)({name:"AdditionOp",pattern:n.Lexer.NA}),u=t.PlusOp=(0,n.createToken)({name:"PlusOp",pattern:/\+/,categories:o}),l=t.MinusOp=(0,n.createToken)({name:"MinusOp",pattern:/-/,categories:o}),c=t.MultiplicationOp=(0,n.createToken)({name:"MultiplicationOp",pattern:n.Lexer.NA}),h=t.TimesOp=(0,n.createToken)({name:"TimesOp",pattern:/\*/,categories:c}),d=t.DivOp=(0,n.createToken)({name:"DivOp",pattern:/\//,categories:c}),p=t.PowerOp=(0,n.createToken)({name:"PowerOp",pattern:/\^/}),m=t.PercentOp=(0,n.createToken)({name:"PercentOp",pattern:/%/}),g=t.BooleanOp=(0,n.createToken)({name:"BooleanOp",pattern:n.Lexer.NA}),f=t.EqualsOp=(0,n.createToken)({name:"EqualsOp",pattern:/=/,categories:g}),E=t.NotEqualOp=(0,n.createToken)({name:"NotEqualOp",pattern:/<>/,categories:g}),T=t.GreaterThanOp=(0,n.createToken)({name:"GreaterThanOp",pattern:/>/,categories:g}),y=t.LessThanOp=(0,n.createToken)({name:"LessThanOp",pattern:/</,categories:g}),A=t.GreaterThanOrEqualOp=(0,n.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:g}),R=t.LessThanOrEqualOp=(0,n.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:g}),N=t.ConcatenateOp=(0,n.createToken)({name:"ConcatenateOp",pattern:/&/}),S=t.LParen=(0,n.createToken)({name:"LParen",pattern:/\(/}),C=t.RParen=(0,n.createToken)({name:"RParen",pattern:/\)/}),O=t.ArrayLParen=(0,n.createToken)({name:"ArrayLParen",pattern:/{/}),v=t.ArrayRParen=(0,n.createToken)({name:"ArrayRParen",pattern:/}/}),I=t.StringLiteral=(0,n.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),M=t.ErrorLiteral=(0,n.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),b=t.RangeSeparator=(0,n.createToken)({name:"RangeSeparator",pattern:new RegExp(i.RANGE_OPERATOR)}),F=t.ColumnRange=(0,n.createToken)({name:"ColumnRange",pattern:RegExp(`${i.COLUMN_REFERENCE_PATTERN}${i.RANGE_OPERATOR}${i.COLUMN_REFERENCE_PATTERN}`)}),w=t.RowRange=(0,n.createToken)({name:"RowRange",pattern:RegExp(`${i.ROW_REFERENCE_PATTERN}${i.RANGE_OPERATOR}${i.ROW_REFERENCE_PATTERN}`)}),_=t.ProcedureName=(0,n.createToken)({name:"ProcedureName",pattern:RegExp(`([${i.UNICODE_LETTER_PATTERN}][${i.NON_RESERVED_CHARACTER_PATTERN}]*)\\(`)}),L=new a.CellReferenceMatcher,x=t.CellReference=(0,n.createToken)({name:"CellReference",pattern:L.match.bind(L),start_chars_hint:L.POSSIBLE_START_CHARACTERS,line_breaks:!1}),P=new s.NamedExpressionMatcher,U=t.NamedExpression=(0,n.createToken)({name:"NamedExpression",pattern:P.match.bind(P),start_chars_hint:P.POSSIBLE_START_CHARACTERS,line_breaks:!1});t.buildLexerConfig=e=>{let t,r,a=e.translationPackage.getFunctionTranslation("OFFSET"),s=e.errorMapping,L=e.translationPackage.buildFunctionMapping(),P=new RegExp("standard"===e.ignoreWhiteSpace?i.ODFF_WHITESPACE_PATTERN:i.ALL_WHITESPACE_PATTERN),V=(0,n.createToken)({name:"WhiteSpace",pattern:P}),D=(0,n.createToken)({name:"ArrayRowSep",pattern:e.arrayRowSeparator}),B=(0,n.createToken)({name:"ArrayColSep",pattern:e.arrayColumnSeparator}),k=(0,n.createToken)({name:"NumberLiteral",pattern:RegExp(`(([${e.decimalSeparator}]\\d+)|(\\d+([${e.decimalSeparator}]\\d*)?))(e[+-]?\\d+)?`)}),G=(0,n.createToken)({name:"OffsetProcedureName",pattern:RegExp(a,"i")});return e.functionArgSeparator===e.arrayColumnSeparator?(t=B,r=[]):e.functionArgSeparator===e.arrayRowSeparator?(t=D,r=[]):r=[t=(0,n.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator})],{ArgSeparator:t,NumberLiteral:k,OffsetProcedureName:G,ArrayRowSeparator:D,ArrayColSeparator:B,WhiteSpace:V,allTokens:[V,u,l,h,d,p,f,E,m,A,R,T,y,S,C,O,v,G,_,b,...r,F,w,k,I,M,N,g,o,c,x,U,D,B],errorMapping:s,functionMapping:L,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}}},function(e,t,r){"use strict";t.__esModule=!0,t.CellReferenceMatcher=void 0;var n=r(82);t.CellReferenceMatcher=class{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,...n.ALL_DIGITS_ARRAY,n.ABSOLUTE_OPERATOR,"'","_"],this.cellReferenceRegexp=RegExp(n.CELL_REFERENCE_WITH_NEXT_CHARACTER_PATTERN,"y")}match(e,t){this.cellReferenceRegexp.lastIndex=t;let r=this.cellReferenceRegexp.exec(e+"@");return null==r||null==r[1]?null:(r[0]=r[1],r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.NamedExpressionMatcher=void 0;var n=r(82);t.NamedExpressionMatcher=class{constructor(){this.POSSIBLE_START_CHARACTERS=[...n.ALL_UNICODE_LETTERS_ARRAY,"_"],this.namedExpressionRegexp=RegExp(n.NAMED_EXPRESSION_PATTERN,"y"),this.r1c1CellRefRegexp=RegExp(`^${n.R1C1_CELL_REFERENCE_PATTERN}$`)}match(e,t){this.namedExpressionRegexp.lastIndex=t;let r=this.namedExpressionRegexp.exec(e);return null==r||null==r[0]||this.r1c1CellRefRegexp.test(r[0])?null:r}}},function(e,t,r){"use strict";t.__esModule=!0,t.Unparser=void 0,t.formatNumber=u;var n=r(73),i=r(0),a=r(78),s=r(127),o=r(128);function u(e,t){return e.toString().replace(".",t)}t.Unparser=class{constructor(e,t,r,n){this.config=e,this.lexerConfig=t,this.sheetMappingFn=r,this.namedExpressions=n}unparse(e,t){return"="+this.unparseAst(e,t)}unparseAst(e,t){var r,i;switch(e.type){case s.AstNodeType.EMPTY:return(0,s.imageWithWhitespace)("",e.leadingWhitespace);case s.AstNodeType.NUMBER:return(0,s.imageWithWhitespace)(u(e.value,this.config.decimalSeparator),e.leadingWhitespace);case s.AstNodeType.STRING:return(0,s.imageWithWhitespace)('"'+e.value+'"',e.leadingWhitespace);case s.AstNodeType.FUNCTION_CALL:{let r=e.args.map(e=>void 0!==e?this.unparseAst(e,t):"").join(this.config.functionArgSeparator),n=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+r+(0,s.imageWithWhitespace)(")",e.internalWhitespace);return(0,s.imageWithWhitespace)(n,e.leadingWhitespace)}case s.AstNodeType.NAMED_EXPRESSION:{let n=null==(r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))?void 0:r.displayName;return(0,s.imageWithWhitespace)(n||e.expressionName,e.leadingWhitespace)}case s.AstNodeType.CELL_REFERENCE:{let r;return r=(void 0!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"")+(null!=(i=e.reference.unparse(t))?i:this.config.translationPackage.getErrorTranslation(n.ErrorType.REF)),(0,s.imageWithWhitespace)(r,e.leadingWhitespace)}case s.AstNodeType.COLUMN_RANGE:case s.AstNodeType.ROW_RANGE:case s.AstNodeType.CELL_RANGE:return(0,s.imageWithWhitespace)(this.formatRange(e,t),e.leadingWhitespace);case s.AstNodeType.PLUS_UNARY_OP:{let r=this.unparseAst(e.value,t);return(0,s.imageWithWhitespace)("+",e.leadingWhitespace)+r}case s.AstNodeType.MINUS_UNARY_OP:{let r=this.unparseAst(e.value,t);return(0,s.imageWithWhitespace)("-",e.leadingWhitespace)+r}case s.AstNodeType.PERCENT_OP:return this.unparseAst(e.value,t)+(0,s.imageWithWhitespace)("%",e.leadingWhitespace);case s.AstNodeType.ERROR:{let t=this.config.translationPackage.getErrorTranslation(e.error?e.error.type:n.ErrorType.ERROR);return(0,s.imageWithWhitespace)(t,e.leadingWhitespace)}case s.AstNodeType.ERROR_WITH_RAW_INPUT:return(0,s.imageWithWhitespace)(e.rawInput,e.leadingWhitespace);case s.AstNodeType.PARENTHESIS:{let r="("+this.unparseAst(e.expression,t)+(0,s.imageWithWhitespace)(")",e.internalWhitespace);return(0,s.imageWithWhitespace)(r,e.leadingWhitespace)}case s.AstNodeType.ARRAY:{let r="{"+e.args.map(e=>e.map(e=>this.unparseAst(e,t)).join(this.config.arrayColumnSeparator)).join(this.config.arrayRowSeparator)+(0,s.imageWithWhitespace)("}",e.internalWhitespace);return(0,s.imageWithWhitespace)(r,e.leadingWhitespace)}default:{let r=this.unparseAst(e.left,t),n=this.unparseAst(e.right,t);return r+(0,s.imageWithWhitespace)(o.binaryOpTokenMap[e.type],e.leadingWhitespace)+n}}}unparseSheetName(e){let t=(0,a.sheetIndexToString)(e,this.sheetMappingFn);if(void 0===t)throw new i.NoSheetWithIdError(e);return t}formatRange(e,t){let r="",i="";void 0!==e.start.sheet&&e.sheetReferenceType!==s.RangeSheetReferenceType.RELATIVE&&(r=this.unparseSheetName(e.start.sheet)+"!"),void 0!==e.end.sheet&&e.sheetReferenceType===s.RangeSheetReferenceType.BOTH_ABSOLUTE&&(i=this.unparseSheetName(e.end.sheet)+"!");let a=e.start.unparse(t),o=e.end.unparse(t);return void 0===a||void 0===o?this.config.translationPackage.getErrorTranslation(n.ErrorType.REF):`${r}${a}:${i}${o}`}}},function(e,t,r){"use strict";t.__esModule=!0,t.collectDependencies=void 0,r(2);var n=r(77);let i=(e,t,r,a)=>{switch(e.type){case n.AstNodeType.EMPTY:case n.AstNodeType.NUMBER:case n.AstNodeType.STRING:case n.AstNodeType.ERROR:return;case n.AstNodeType.NAMED_EXPRESSION:return void(a&&r.push(new n.NamedExpressionDependency(e.expressionName)));case n.AstNodeType.CELL_REFERENCE:return void(a&&r.push(new n.AddressDependency(e.reference)));case n.AstNodeType.CELL_RANGE:return void(a&&e.start.sheet===e.end.sheet&&r.push(new n.CellRangeDependency(e.start,e.end)));case n.AstNodeType.COLUMN_RANGE:return void(a&&e.start.sheet===e.end.sheet&&r.push(new n.ColumnRangeDependency(e.start,e.end)));case n.AstNodeType.ROW_RANGE:return void(a&&e.start.sheet===e.end.sheet&&r.push(new n.RowRangeDependency(e.start,e.end)));case n.AstNodeType.PERCENT_OP:case n.AstNodeType.PLUS_UNARY_OP:case n.AstNodeType.MINUS_UNARY_OP:return void i(e.value,t,r,!0);case n.AstNodeType.CONCATENATE_OP:case n.AstNodeType.EQUALS_OP:case n.AstNodeType.NOT_EQUAL_OP:case n.AstNodeType.LESS_THAN_OP:case n.AstNodeType.GREATER_THAN_OP:case n.AstNodeType.LESS_THAN_OR_EQUAL_OP:case n.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case n.AstNodeType.MINUS_OP:case n.AstNodeType.PLUS_OP:case n.AstNodeType.TIMES_OP:case n.AstNodeType.DIV_OP:case n.AstNodeType.POWER_OP:return i(e.left,t,r,!0),void i(e.right,t,r,!0);case n.AstNodeType.PARENTHESIS:return void i(e.expression,t,r,a);case n.AstNodeType.FUNCTION_CALL:{let n=!t.doesFunctionNeedArgumentToBeComputed(e.procedureName);return void e.args.forEach(e=>i(e,t,r,n))}}};t.collectDependencies=(e,t)=>{let r=[];return i(e,t,r,!0),r}},function(e,t,r){"use strict";t.__esModule=!0,t.RowRangeDependency=t.NamedExpressionDependency=t.ColumnRangeDependency=t.CellRangeDependency=t.AddressDependency=void 0;var n=r(72);t.AddressDependency=class{constructor(e){this.dependency=e}absolutize(e){return this.dependency.toSimpleCellAddress(e)}},t.CellRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){return new n.AbsoluteCellRange(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}},t.ColumnRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){let t=this.start.toSimpleColumnAddress(e),r=this.end.toSimpleColumnAddress(e);return new n.AbsoluteColumnRange(t.sheet,t.col,r.col)}},t.RowRangeDependency=class{constructor(e,t){this.start=e,this.end=t}absolutize(e){let t=this.start.toSimpleRowAddress(e),r=this.end.toSimpleRowAddress(e);return new n.AbsoluteRowRange(t.sheet,t.row,r.row)}},t.NamedExpressionDependency=class{constructor(e){this.name=e}absolutize(e){return this}}},function(e,t,r){"use strict";t.__esModule=!0,t.ContentChanges=void 0,r(2);var n=r(73),i=r(139);class a{constructor(){this.changes=new Map}static empty(){return new a}addAll(e){for(let t of e.changes.values())this.add(t.address,t);return this}addChange(e,t,r){this.addInterpreterValue(e,t,r)}exportChanges(e){let t=[];return this.changes.forEach(r=>{let n=e.exportChange(r);Array.isArray(n)?t=t.concat(n):t.push(n)}),t}getChanges(){return Array.from(this.changes.values())}isEmpty(){return 0===this.changes.size}add(e,t){let r=t.value;if(r instanceof i.SimpleRangeValue)for(let t of r.effectiveAddressesFromData(e))this.changes.delete((0,n.addressKey)(t));this.changes.set((0,n.addressKey)(e),t)}addInterpreterValue(e,t,r){this.add(t,{address:t,value:e,oldValue:r})}}t.ContentChanges=a},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleRangeValue=void 0,r(2);var n=r(1),i=r(73),a=r(131),s=r(140);class o{constructor(e,t,r,i){this._data=e,this.range=t,this.dependencyGraph=r,this._hasOnlyNumbers=i,this.size=void 0===e?new n.ArraySize(t.effectiveWidth(r),t.effectiveHeight(r)):new n.ArraySize(e[0].length,e.length)}get data(){return this.ensureThatComputed(),this._data}static fromRange(e,t,r){return new o(e,t,r,!0)}static onlyNumbers(e){return new o(e,void 0,void 0,!0)}static onlyValues(e){return new o(e,void 0,void 0,void 0)}static onlyRange(e,t){return new o(void 0,e,t,void 0)}static fromScalar(e){return new o([[e]],void 0,void 0,void 0)}isAdHoc(){return void 0===this.range}width(){return this.size.width}height(){return this.size.height}valuesFromTopLeftCorner(){this.ensureThatComputed();let e=[];for(let t=0;t<this._data.length;t++)for(let r=0;r<this._data[0].length;r++)e.push(this._data[t][r]);return e}*effectiveAddressesFromData(e){for(let t=0;t<this.data.length;++t){let r=this.data[t];for(let n=0;n<r.length;++n)yield(0,i.simpleCellAddress)(e.sheet,e.col+n,e.row+t)}}*entriesFromTopLeftCorner(e){this.ensureThatComputed();for(let t=0;t<this.size.height;++t)for(let r=0;r<this.size.width;++r)yield[this._data[t][r],(0,i.simpleCellAddress)(e.sheet,e.col+r,e.row+t)]}*iterateValuesFromTopLeftCorner(){yield*this.valuesFromTopLeftCorner()}numberOfElements(){return this.size.width*this.size.height}hasOnlyNumbers(){if(void 0===this._hasOnlyNumbers){for(let e of(this._hasOnlyNumbers=!0,this.data))for(let t of e)if("number"!=typeof t)return this._hasOnlyNumbers=!1,!1}return this._hasOnlyNumbers}rawNumbers(){return this._data}rawData(){var e;return this.ensureThatComputed(),null!=(e=this._data)?e:[]}sameDimensionsAs(e){return this.width()===e.width()&&this.height()===e.height()}ensureThatComputed(){void 0===this._data&&(this._hasOnlyNumbers=!0,this._data=this.range.addressesArrayMap(this.dependencyGraph,e=>{let t=this.dependencyGraph.getCellValue(e);return t instanceof o?(this._hasOnlyNumbers=!1,new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.ScalarExpected)):((0,s.isExtendedNumber)(t)||(this._hasOnlyNumbers=!1),t)}))}}t.SimpleRangeValue=o},function(e,t,r){"use strict";var n,i;t.__esModule=!0,t.TimeNumber=t.RichNumber=t.PercentNumber=t.NumberType=t.EmptyValue=t.DateTimeNumber=t.DateNumber=t.CurrencyNumber=void 0,t.cloneNumber=function(e,t){if("number"==typeof e)return t;{let r=e.fromNumber(t);return r.format=e.format,r}},t.getFormatOfExtendedNumber=function(e){return e instanceof a?e.format:void 0},t.getRawValue=function(e){return e instanceof a?e.val:e},t.getTypeFormatOfExtendedNumber=function(e){return e instanceof a?{type:e.getDetailedType(),format:e.format}:{type:n.NUMBER_RAW}},t.getTypeOfExtendedNumber=function(e){return e instanceof a?e.getDetailedType():n.NUMBER_RAW},t.isExtendedNumber=function(e){return"number"==typeof e||e instanceof a},t.EmptyValue=Symbol("Empty value");class a{constructor(e,t){this.val=e,this.format=t}fromNumber(e){return new this.constructor(e)}}t.RichNumber=a,t.DateNumber=class extends a{getDetailedType(){return n.NUMBER_DATE}},t.CurrencyNumber=class extends a{getDetailedType(){return n.NUMBER_CURRENCY}},t.TimeNumber=class extends a{getDetailedType(){return n.NUMBER_TIME}},t.DateTimeNumber=class extends a{getDetailedType(){return n.NUMBER_DATETIME}},t.PercentNumber=class extends a{getDetailedType(){return n.NUMBER_PERCENT}},(i=n||(t.NumberType=n={})).NUMBER_RAW="NUMBER_RAW",i.NUMBER_DATE="NUMBER_DATE",i.NUMBER_TIME="NUMBER_TIME",i.NUMBER_DATETIME="NUMBER_DATETIME",i.NUMBER_CURRENCY="NUMBER_CURRENCY",i.NUMBER_PERCENT="NUMBER_PERCENT"},function(e,t,r){"use strict";t.__esModule=!0,t.RowsSpan=t.ColumnsSpan=void 0;class n{constructor(e,t,r){if(this.sheet=e,this.rowStart=t,this.rowEnd=r,t<0)throw Error("Starting row cant be less than 0");if(r<t)throw Error("Row span cant end before start")}get numberOfRows(){return this.rowEnd-this.rowStart+1}get start(){return this.rowStart}get end(){return this.rowEnd}static fromNumberOfRows(e,t,r){return new n(e,t,t+r-1)}static fromRowStartAndEnd(e,t,r){return new n(e,t,r)}*rows(){for(let e=this.rowStart;e<=this.rowEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");let t=Math.max(this.rowStart,e.rowStart),r=Math.min(this.rowEnd,e.rowEnd);return t>r?null:new n(this.sheet,t,r)}firstRow(){return new n(this.sheet,this.rowStart,this.rowStart)}}t.RowsSpan=n;class i{constructor(e,t,r){if(this.sheet=e,this.columnStart=t,this.columnEnd=r,t<0)throw Error("Starting column cant be less than 0");if(r<t)throw Error("Column span cant end before start")}get numberOfColumns(){return this.columnEnd-this.columnStart+1}get start(){return this.columnStart}get end(){return this.columnEnd}static fromNumberOfColumns(e,t,r){return new i(e,t,t+r-1)}static fromColumnStartAndEnd(e,t,r){return new i(e,t,r)}*columns(){for(let e=this.columnStart;e<=this.columnEnd;++e)yield e}intersect(e){if(this.sheet!==e.sheet)throw Error("Can't intersect spans from different sheets");let t=Math.max(this.columnStart,e.columnStart),r=Math.min(this.columnEnd,e.columnEnd);return t>r?null:new i(this.sheet,t,r)}firstColumn(){return new i(this.sheet,this.columnStart,this.columnStart)}}t.ColumnsSpan=i},function(e,t,r){"use strict";t.__esModule=!0,t.Statistics=t.StatType=t.EmptyStatistics=void 0,t.EmptyStatistics=r(143).EmptyStatistics,t.Statistics=r(144).Statistics,t.StatType=r(145).StatType},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyStatistics=void 0;var n=r(144);class i extends n.Statistics{incrementCriterionFunctionFullCacheUsed(){}incrementCriterionFunctionPartialCacheUsed(){}start(e){}end(e){}}t.EmptyStatistics=i},function(e,t,r){"use strict";t.__esModule=!0,t.Statistics=void 0;var n=r(145);t.Statistics=class{constructor(){this.stats=new Map([[n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0],[n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}incrementCriterionFunctionFullCacheUsed(){var e;let t=(null!=(e=this.stats.get(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED))?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,t)}incrementCriterionFunctionPartialCacheUsed(){var e;let t=(null!=(e=this.stats.get(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED))?e:0)+1;this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,t)}reset(){this.stats.clear(),this.startTimes.clear(),this.stats.set(n.StatType.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(n.StatType.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}start(e){if(this.startTimes.get(e))throw Error(`Statistics ${e} already started`);this.startTimes.set(e,Date.now())}end(e){var t;let r=Date.now(),n=this.startTimes.get(e);if(!n)throw Error(`Statistics ${e} not started`);{let i=null!=(t=this.stats.get(e))?t:0;i+=r-n,this.stats.set(e,i),this.startTimes.delete(e)}}measure(e,t){this.start(e);let r=t();return this.end(e),r}snapshot(){return new Map(this.stats)}}},function(e,t,r){"use strict";var n,i;t.__esModule=!0,t.StatType=void 0,(i=n||(t.StatType=n={})).BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",i.PARSER="PARSER",i.GRAPH_BUILD="GRAPH_BUILD",i.COLLECT_DEPENDENCIES="COLLECT_DEPENDENCIES",i.PROCESS_DEPENDENCIES="PROCESS_DEPENDENCIES",i.TOP_SORT="TOP_SORT",i.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",i.EVALUATION="EVALUATION",i.VLOOKUP="VLOOKUP",i.TRANSFORM_ASTS="TRANSFORM_ASTS",i.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",i.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",i.ADJUSTING_ARRAY_MAPPING="ADJUSTING_ARRAY_MAPPING",i.ADJUSTING_RANGES="ADJUSTING_RANGES",i.ADJUSTING_GRAPH="ADJUSTING_GRAPH",i.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",i.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"},function(e,t,r){"use strict";t.__esModule=!0,t.AddressMapping=void 0;var n=r(147),i=r(140),a=r(74);t.AddressMapping=class{constructor(e){this.policy=e,this.mapping=new Map}getCell(e){let t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);return t.getCell(e)}fetchCell(e){let t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);let r=t.getCell(e);if(!r)throw Error("Vertex for address missing in AddressMapping");return r}strategyFor(e){let t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t}addSheet(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}autoAddSheet(e,t){let{height:r,width:n,fill:i}=t,a=this.policy.call(i);this.addSheet(e,new a(n,r))}getCellValue(e){let t=this.getCell(e);return void 0===t?i.EmptyValue:t instanceof a.ArrayVertex?t.getArrayCellValue(e):t.getCellValue()}getRawValue(e){let t=this.getCell(e);return t instanceof a.ValueCellVertex?t.getValues().rawValue:t instanceof a.ArrayVertex?t.getArrayCellRawValue(e):null}setCell(e,t){let r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized");r.setCell(e,t)}moveCell(e,t){let r=this.mapping.get(e.sheet);if(!r)throw Error("Sheet not initialized.");if(e.sheet!==t.sheet)throw Error("Cannot move cells between sheets.");if(r.has(t))throw Error("Cannot move cell. Destination already occupied.");let n=r.getCell(e);if(void 0===n)throw Error("Cannot move cell. No cell with such address.");this.setCell(t,n),this.removeCell(e)}removeCell(e){let t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}has(e){let t=this.mapping.get(e.sheet);return void 0!==t&&t.has(e)}getHeight(e){let t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t.getHeight()}getWidth(e){let t=this.mapping.get(e);if(!t)throw new n.NoSheetWithIdError(e);return t.getWidth()}addRows(e,t,r){let i=this.mapping.get(e);if(void 0===i)throw new n.NoSheetWithIdError(e);i.addRows(t,r)}removeRows(e){let t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);t.removeRows(e)}removeSheet(e){this.mapping.delete(e)}addColumns(e,t,r){let i=this.mapping.get(e);if(void 0===i)throw new n.NoSheetWithIdError(e);i.addColumns(t,r)}removeColumns(e){let t=this.mapping.get(e.sheet);if(void 0===t)throw new n.NoSheetWithIdError(e.sheet);t.removeColumns(e)}*verticesFromRowsSpan(e){yield*this.mapping.get(e.sheet).verticesFromRowsSpan(e)}*verticesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).verticesFromColumnsSpan(e)}*entriesFromRowsSpan(e){yield*this.mapping.get(e.sheet).entriesFromRowsSpan(e)}*entriesFromColumnsSpan(e){yield*this.mapping.get(e.sheet).entriesFromColumnsSpan(e)}*entries(){for(let[e,t]of this.mapping.entries())yield*t.getEntries(e)}*sheetEntries(e){let t=this.mapping.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);yield*t.getEntries(e)}}},function(e,t,r){"use strict";function n(e,t){switch(typeof t){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}t.__esModule=!0,t.UnableToParseError=t.TargetLocationHasArrayError=t.SourceLocationHasArrayError=t.SheetsNotEqual=t.SheetSizeLimitExceededError=t.SheetNameAlreadyTakenError=t.ProtectedFunctionTranslationError=t.ProtectedFunctionError=t.NothingToPasteError=t.NotAFormulaError=t.NoSheetWithNameError=t.NoSheetWithIdError=t.NoRelativeAddressesAllowedError=t.NoOperationToUndoError=t.NoOperationToRedoError=t.NamedExpressionNameIsInvalidError=t.NamedExpressionNameIsAlreadyTakenError=t.NamedExpressionDoesNotExistError=t.MissingTranslationError=t.LanguageNotRegisteredError=t.LanguageAlreadyRegisteredError=t.InvalidArgumentsError=t.InvalidAddressError=t.FunctionPluginValidationError=t.ExpectedValueOfTypeError=t.ExpectedOneOfValuesError=t.EvaluationSuspendedError=t.ConfigValueTooSmallError=t.ConfigValueTooBigError=t.ConfigValueEmpty=t.AliasAlreadyExisting=void 0,t.NoSheetWithIdError=class extends Error{constructor(e){super("There's no sheet with id = "+e)}},t.NoSheetWithNameError=class extends Error{constructor(e){super(`There's no sheet with name '${e}'`)}},t.SheetNameAlreadyTakenError=class extends Error{constructor(e){super(`Sheet with name ${e} already exists`)}},t.SheetSizeLimitExceededError=class extends Error{constructor(){super("Sheet size limit exceeded")}},t.NotAFormulaError=class extends Error{constructor(){super("This is not a formula")}},t.InvalidAddressError=class extends Error{constructor(e){super(`Address (row = ${e.row}, col = ${e.col}) is invalid`)}},t.InvalidArgumentsError=class extends Error{constructor(e){super("Invalid arguments, expected "+e)}},t.SheetsNotEqual=class extends Error{constructor(e,t){super(`Sheets ${e} and ${t} are not equal.`)}},t.NamedExpressionNameIsAlreadyTakenError=class extends Error{constructor(e){super(`Name of Named Expression '${e}' is already present`)}},t.NamedExpressionNameIsInvalidError=class extends Error{constructor(e){super(`Name of Named Expression '${e}' is invalid`)}},t.NamedExpressionDoesNotExistError=class extends Error{constructor(e){super(`Named Expression '${e}' does not exist`)}},t.NoOperationToUndoError=class extends Error{constructor(){super("There is no operation to undo")}},t.NoOperationToRedoError=class extends Error{constructor(){super("There is no operation to redo")}},t.NothingToPasteError=class extends Error{constructor(){super("There is nothing to paste")}},t.UnableToParseError=class extends Error{constructor(e){super("Unable to parse value: "+JSON.stringify(e,n,4))}},t.ExpectedValueOfTypeError=class extends Error{constructor(e,t){super(`Expected value of type: ${e} for config parameter: ${t}`)}},t.ConfigValueEmpty=class extends Error{constructor(e){super(`Config parameter ${e} cannot be empty.`)}},t.ConfigValueTooSmallError=class extends Error{constructor(e,t){super(`Config parameter ${e} should be at least ${t}`)}},t.ConfigValueTooBigError=class extends Error{constructor(e,t){super(`Config parameter ${e} should be at most ${t}`)}},t.ExpectedOneOfValuesError=class extends Error{constructor(e,t){super(`Expected one of ${e} for config parameter: ${t}`)}},t.EvaluationSuspendedError=class extends Error{constructor(){super("Computations are suspended")}},t.MissingTranslationError=class extends Error{constructor(e){super(`Translation for ${e} is missing in the translation package you're using.`)}},t.ProtectedFunctionTranslationError=class extends Error{constructor(e){super("Cannot register translation for function with id: "+e)}},t.LanguageNotRegisteredError=class extends Error{constructor(){super("Language not registered.")}},t.LanguageAlreadyRegisteredError=class extends Error{constructor(){super("Language already registered.")}};class i extends Error{static functionNotDeclaredInPlugin(e,t){return new i(`Function with id ${e} not declared in plugin ${t}`)}static functionMethodNotFound(e,t){return new i(`Function method ${e} not found in plugin ${t}`)}}t.FunctionPluginValidationError=i;class a extends Error{static cannotRegisterFunctionWithId(e){return new a("Cannot register function with id "+e)}static cannotUnregisterFunctionWithId(e){return new a("Cannot unregister function with id "+e)}static cannotUnregisterProtectedPlugin(){return new a("Cannot unregister protected plugin")}}t.ProtectedFunctionError=a,t.SourceLocationHasArrayError=class extends Error{constructor(){super("Cannot perform this operation, source location has an array inside.")}},t.TargetLocationHasArrayError=class extends Error{constructor(){super("Cannot perform this operation, target location has an array inside.")}},t.NoRelativeAddressesAllowedError=class extends Error{constructor(){super("Relative addresses not allowed in named expressions.")}},t.AliasAlreadyExisting=class extends Error{constructor(e,t){super(`Alias id ${e} in plugin ${t} already defined as a function or alias.`)}}},function(e,t,r){"use strict";t.__esModule=!0,t.ArrayMapping=void 0,r(2);var n=r(73);t.ArrayMapping=class{constructor(){this.arrayMapping=new Map}getArray(e){let t=this.getArrayByCorner(e.start);if(null==t?void 0:t.getRange().sameAs(e))return t}getArrayByCorner(e){return this.arrayMapping.get((0,n.addressKey)(e))}setArray(e,t){this.arrayMapping.set((0,n.addressKey)(e.start),t)}removeArray(e){"string"==typeof e?this.arrayMapping.delete(e):this.arrayMapping.delete((0,n.addressKey)(e.start))}count(){return this.arrayMapping.size}*arraysInRows(e){for(let[t,r]of this.arrayMapping.entries())r.spansThroughSheetRows(e.sheet,e.rowStart,e.rowEnd)&&(yield[t,r])}*arraysInCols(e){for(let[t,r]of this.arrayMapping.entries())r.spansThroughSheetColumn(e.sheet,e.columnStart,e.columnEnd)&&(yield[t,r])}isFormulaArrayInRow(e,t){for(let r of this.arrayMapping.values())if(r.spansThroughSheetRows(e,t))return!0;return!1}isFormulaArrayInAllRows(e){let t=!0;for(let r of e.rows())this.isFormulaArrayInRow(e.sheet,r)||(t=!1);return t}isFormulaArrayInColumn(e,t){for(let r of this.arrayMapping.values())if(r.spansThroughSheetColumn(e,t))return!0;return!1}isFormulaArrayInAllColumns(e){let t=!0;for(let r of e.columns())this.isFormulaArrayInColumn(e.sheet,r)||(t=!1);return t}isFormulaArrayInRange(e){for(let t of this.arrayMapping.values())if(t.getRange().doesOverlap(e))return!0;return!1}isFormulaArrayAtAddress(e){for(let t of this.arrayMapping.values())if(t.getRange().addressInRange(e))return!0;return!1}moveArrayVerticesAfterRowByRows(e,t,r){this.updateArrayVerticesInSheet(e,(e,n)=>{let i=n.getRange();return t<=i.start.row?[i.shifted(0,r),n]:void 0})}moveArrayVerticesAfterColumnByColumns(e,t,r){this.updateArrayVerticesInSheet(e,(e,n)=>{let i=n.getRange();return t<=i.start.col?[i.shifted(r,0),n]:void 0})}updateArrayVerticesInSheet(e,t){let r=[];for(let[n,i]of this.arrayMapping.entries()){if(i.sheet!==e)continue;let a=t(n,i);void 0!==a&&(this.removeArray(n),r.push(a))}r.forEach(([e,t])=>{this.setArray(e,t)})}}},function(e,t,r){"use strict";t.__esModule=!0,t.collectAddressesDependentToRange=void 0;var n=r(77),i=r(150),a=r(152);t.collectAddressesDependentToRange=(e,t,r,s,o)=>{let u,l;if(t instanceof a.RangeVertex){let e=t.range.intersectionWith(r);return void 0!==e?Array.from(e.addresses(o)):[]}return t instanceof i.FormulaVertex?(u=t.getFormula(s),l=t.getAddress(s),(0,n.collectDependencies)(u,e).filter(e=>e instanceof n.AddressDependency).map(e=>e.dependency.toSimpleCellAddress(l)).filter(e=>r.addressInRange(e))):[]}},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaVertex=t.FormulaCellVertex=t.ArrayVertex=void 0;var n=r(72),i=r(1),a=r(151),s=r(73),o=r(131),u=r(140),l=r(141);class c{constructor(e,t,r){this.formula=e,this.cellAddress=t,this.version=r}get width(){return 1}get height(){return 1}static fromAst(e,t,r,n){return r.isScalar()?new d(e,t,n):new h(e,t,r,n)}getFormula(e){return this.ensureRecentData(e),this.formula}ensureRecentData(e){if(this.version!=e.version()){let[t,r,n]=e.applyTransformations(this.formula,this.cellAddress,this.version);this.formula=t,this.cellAddress=r,this.version=n}}getAddress(e){return this.ensureRecentData(e),this.cellAddress}}t.FormulaVertex=c;class h extends c{constructor(e,t,r,n=0){super(e,t,n),r.isRef?this.array=new a.ErroredArray(new s.CellError(s.ErrorType.REF,o.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()):this.array=new a.NotComputedArray(r)}get width(){return this.array.width()}get height(){return this.array.height()}get sheet(){return this.cellAddress.sheet}get leftCorner(){return this.cellAddress}setCellValue(e){if(e instanceof s.CellError)return this.setErrorValue(e),e;let t=a.ArrayValue.fromInterpreterValue(e);return t.resize(this.array.size),this.array=t,e}getCellValue(){if(this.array instanceof a.NotComputedArray)throw Error("Array not computed yet.");return this.array.simpleRangeValue()}valueOrUndef(){if(!(this.array instanceof a.NotComputedArray))return this.array.simpleRangeValue()}getArrayCellValue(e){let t=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;try{return this.array.get(t,r)}catch(e){return new s.CellError(s.ErrorType.REF)}}getArrayCellRawValue(e){let t=this.getArrayCellValue(e);return t instanceof s.CellError||t===u.EmptyValue?void 0:(0,u.getRawValue)(t)}setArrayCellValue(e,t){let r=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;this.array instanceof a.ArrayValue&&this.array.set(r,n,t)}setNoSpace(){return this.array=new a.ErroredArray(new s.CellError(s.ErrorType.SPILL,o.ErrorMessage.NoSpaceForArrayResult),i.ArraySize.error()),this.getCellValue()}getRange(){return n.AbsoluteCellRange.spanFrom(this.cellAddress,this.width,this.height)}getRangeOrUndef(){return n.AbsoluteCellRange.spanFromOrUndef(this.cellAddress,this.width,this.height)}setAddress(e){this.cellAddress=e}setFormula(e){this.formula=e}spansThroughSheetRows(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.row<=r&&t<this.cellAddress.row+this.height}spansThroughSheetColumn(e,t,r=t){return this.cellAddress.sheet===e&&this.cellAddress.col<=r&&t<this.cellAddress.col+this.width}isComputed(){return!(this.array instanceof a.NotComputedArray)}columnsFromArray(){return l.ColumnsSpan.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}rowsFromArray(){return l.RowsSpan.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}ensureRecentData(e){}isLeftCorner(e){return(0,s.equalSimpleCellAddress)(this.cellAddress,e)}setErrorValue(e){this.array=new a.ErroredArray(e,this.array.size)}}t.ArrayVertex=h;class d extends c{constructor(e,t,r){super(e,t,r)}valueOrUndef(){return this.cachedCellValue}setCellValue(e){return this.cachedCellValue=e,this.cachedCellValue}getCellValue(){if(void 0!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}isComputed(){return void 0!==this.cachedCellValue}}t.FormulaCellVertex=d},function(e,t,r){"use strict";t.__esModule=!0,t.NotComputedArray=t.ErroredArray=t.ArrayValue=void 0,r(2);var n=r(1),i=r(140),a=r(139);t.NotComputedArray=class{constructor(e){this.size=e}width(){return this.size.width}height(){return this.size.height}get(e,t){throw Error("Array not computed yet.")}simpleRangeValue(){throw Error("Array not computed yet.")}};class s{constructor(e){if(this.size=new n.ArraySize(e.length>0?e[0].length:0,e.length),this.array=e,this.size.width<=0||this.size.height<=0)throw Error("Incorrect array size")}static fromInterpreterValue(e){return new s(e instanceof a.SimpleRangeValue?e.data:[[e]])}simpleRangeValue(){return a.SimpleRangeValue.onlyValues(this.array)}addRows(e,t){this.array.splice(e,0,...this.nullArrays(t,this.width())),this.size.height+=t}addColumns(e,t){for(let r=0;r<this.height();r++)this.array[r].splice(e,0,...Array(t).fill(i.EmptyValue));this.size.width+=t}removeRows(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Array index out of bound");let r=t-e+1;this.array.splice(e,r),this.size.height-=r}removeColumns(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Array index out of bound");let r=t-e+1;for(let t of this.array)t.splice(e,r);this.size.width-=r}nullArrays(e,t){let r=[];for(let n=0;n<e;++n)r.push(Array(t).fill(i.EmptyValue));return r}get(e,t){if(this.outOfBound(e,t))throw Error("Array index out of bound");return this.array[t][e]}set(e,t,r){if(this.outOfBound(e,t))throw Error("Array index out of bound");this.array[t][e]=r}width(){return this.size.width}height(){return this.size.height}raw(){return this.array}resize(e){if(this.height()<e.height&&isFinite(e.height)&&this.addRows(this.height(),e.height-this.height()),this.height()>e.height||(this.width()<e.width&&isFinite(e.width)&&this.addColumns(this.width(),e.width-this.width()),this.width()>e.width))throw Error("Resizing to smaller array")}outOfBound(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}t.ArrayValue=s,t.ErroredArray=class{constructor(e,t){this.error=e,this.size=t}get(e,t){return this.error}width(){return this.size.width}height(){return this.size.height}simpleRangeValue(){return this.error}}},function(e,t,r){"use strict";t.__esModule=!0,t.RangeVertex=void 0,t.RangeVertex=class{constructor(e){this.range=e,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}get start(){return this.range.start}get end(){return this.range.end}get sheet(){return this.range.start.sheet}getFunctionValue(e){return this.functionCache.get(e)}setFunctionValue(e,t){this.functionCache.set(e,t)}getCriterionFunctionValue(e,t){var r;return null==(r=this.getCriterionFunctionValues(e).get(t))?void 0:r[0]}getCriterionFunctionValues(e){var t;return null!=(t=this.criterionFunctionCache.get(e))?t:new Map}setCriterionFunctionValues(e,t){this.criterionFunctionCache.set(e,t)}addDependentCacheRange(e){e!==this&&this.dependentCacheRanges.add(e)}clearCache(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach(e=>e.criterionFunctionCache.clear()),this.dependentCacheRanges.clear()}getStart(){return this.start}getEnd(){return this.end}}},function(e,t,r){"use strict";t.__esModule=!0,t.Graph=void 0,r(2);var n=r(154),i=r(155);t.Graph=class{constructor(e){this.dependencyQuery=e,this.nodesSparseArray=[],this.edgesSparseArray=[],this.nodesIds=new Map,this.dirtyAndVolatileNodeIds=new i.ProcessableValue({dirty:[],volatile:[]},e=>this.processDirtyAndVolatileNodeIds(e)),this.infiniteRangeIds=new Set,this.changingWithStructureNodeIds=[],this.nextId=0}getNodes(){return this.nodesSparseArray.filter(e=>void 0!==e)}hasNode(e){return this.nodesIds.has(e)}existsEdge(e,t){let r=this.getNodeId(e),n=this.getNodeId(t);return void 0!==r&&void 0!==n&&this.edgesSparseArray[r].includes(n)}adjacentNodes(e){let t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return new Set(this.edgesSparseArray[t].filter(e=>void 0!==e).map(e=>this.nodesSparseArray[e]))}adjacentNodesCount(e){let t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);return this.fixEdgesArrayForNode(t).length}addNodeAndReturnId(e){let t=this.nodesIds.get(e);if(void 0!==t)return t;let r=this.nextId;return this.nextId++,this.nodesSparseArray[r]=e,this.edgesSparseArray[r]=[],this.nodesIds.set(e,r),r}addEdge(e,t){let r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);this.edgesSparseArray[r].includes(n)||this.edgesSparseArray[r].push(n)}removeNode(e){let t=this.getNodeId(e);if(void 0===t)throw this.missingNodeError(e);this.edgesSparseArray[t].length>0&&(this.edgesSparseArray[t].forEach(e=>this.dirtyAndVolatileNodeIds.rawValue.dirty.push(e)),this.dirtyAndVolatileNodeIds.markAsModified());let r=this.removeDependencies(e);return delete this.nodesSparseArray[t],delete this.edgesSparseArray[t],this.infiniteRangeIds.delete(t),this.nodesIds.delete(e),r}removeEdge(e,t){let r=this.getNodeIdIfNotNumber(e),n=this.getNodeIdIfNotNumber(t);if(void 0===r)throw this.missingNodeError(e);if(void 0===n)throw this.missingNodeError(t);let i=this.edgesSparseArray[r].indexOf(n);if(-1===i)throw Error("Edge does not exist");delete this.edgesSparseArray[r][i]}removeEdgeIfExists(e,t){let r=this.getNodeId(e),n=this.getNodeId(t);if(void 0===r||void 0===n)return;let i=this.edgesSparseArray[r].indexOf(n);-1!==i&&delete this.edgesSparseArray[r][i]}topSortWithScc(){return this.getTopSortedWithSccSubgraphFrom(this.getNodes(),()=>!0,()=>{})}getTopSortedWithSccSubgraphFrom(e,t,r){let i=new n.TopSort(this.nodesSparseArray,this.edgesSparseArray),a=e.map(e=>this.getNodeId(e)).filter(e=>void 0!==e);return i.getTopSortedWithSccSubgraphFrom(a,t,r)}markNodeAsVolatile(e){let t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.volatile.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsDirty(e){let t=this.getNodeId(e);void 0!==t&&(this.dirtyAndVolatileNodeIds.rawValue.dirty.push(t),this.dirtyAndVolatileNodeIds.markAsModified())}getDirtyAndVolatileNodes(){return this.dirtyAndVolatileNodeIds.getProcessedValue()}clearDirtyNodes(){this.dirtyAndVolatileNodeIds.rawValue.dirty=[],this.dirtyAndVolatileNodeIds.markAsModified()}markNodeAsChangingWithStructure(e){let t=this.getNodeId(e);void 0!==t&&this.changingWithStructureNodeIds.push(t)}markChangingWithStructureNodesAsDirty(){this.changingWithStructureNodeIds.length<=0||(this.dirtyAndVolatileNodeIds.rawValue.dirty=[...this.dirtyAndVolatileNodeIds.rawValue.dirty,...this.changingWithStructureNodeIds],this.dirtyAndVolatileNodeIds.markAsModified())}markNodeAsInfiniteRange(e){let t=this.getNodeIdIfNotNumber(e);void 0!==t&&this.infiniteRangeIds.add(t)}getInfiniteRanges(){return[...this.infiniteRangeIds].map(e=>({node:this.nodesSparseArray[e],id:e}))}getNodeId(e){return this.nodesIds.get(e)}getNodeIdIfNotNumber(e){return"number"==typeof e?e:this.nodesIds.get(e)}fixEdgesArrayForNode(e){let t=this.edgesSparseArray[e];return this.edgesSparseArray[e]=t.filter(e=>void 0!==e&&this.nodesSparseArray[e]),this.edgesSparseArray[e]}removeDependencies(e){let t=this.dependencyQuery(e);return t.forEach(([t,r])=>{this.removeEdgeIfExists(r,e)}),t}processDirtyAndVolatileNodeIds({dirty:e,volatile:t}){return[...new Set([...e,...t])].map(e=>this.nodesSparseArray[e]).filter(e=>void 0!==e)}missingNodeError(e){return Error("Unknown node "+e)}}},function(e,t,r){"use strict";var n,i;t.__esModule=!0,t.TopSort=void 0,r(2),(i=n||(n={}))[i.ON_STACK=0]="ON_STACK",i[i.PROCESSED=1]="PROCESSED",i[i.POPPED=2]="POPPED",t.TopSort=class{constructor(e=[],t=[]){this.nodesSparseArray=e,this.edgesSparseArray=t,this.entranceTime=[],this.low=[],this.parent=[],this.inSCC=[],this.nodeStatus=[],this.order=[],this.sccNonSingletons=[],this.timeCounter=0}getTopSortedWithSccSubgraphFrom(e,t,r){let n=e.reverse();return n.forEach(e=>this.runDFS(e)),this.postprocess(n,r,t)}getAdjacentNodeIds(e){return this.edgesSparseArray[e].filter(e=>void 0!==e&&this.nodesSparseArray[e])}runDFS(e){if(void 0!==this.nodeStatus[e])return;this.nodeStatus[e]=n.ON_STACK;let t=[e],r=[];for(;t.length>0;){let e=t[t.length-1];switch(this.nodeStatus[e]){case n.ON_STACK:this.handleOnStack(e,r,t);break;case n.PROCESSED:this.handleProcessed(e,r,t);break;case n.POPPED:t.pop()}}}handleOnStack(e,t,r){this.entranceTime[e]=this.timeCounter,this.low[e]=this.timeCounter,this.timeCounter++,t.push(e),this.getAdjacentNodeIds(e).forEach(t=>{void 0===this.entranceTime[t]&&(r.push(t),this.parent[t]=e,this.nodeStatus[t]=n.ON_STACK)}),this.nodeStatus[e]=n.PROCESSED}handleProcessed(e,t,r){let i=this.entranceTime[e];if(this.getAdjacentNodeIds(e).forEach(t=>{this.inSCC[t]||(i=this.parent[t]===e?Math.min(i,this.low[t]):Math.min(i,this.entranceTime[t]))}),this.low[e]=i,i===this.entranceTime[e]){let r=[];do r.push(t[t.length-1]),t.pop();while(r[r.length-1]!==e)r.forEach(e=>{this.inSCC[e]=!0}),this.order.push(...r),r.length>1&&r.forEach(e=>{this.sccNonSingletons[e]=!0})}r.pop(),this.nodeStatus[e]=n.POPPED}postprocess(e,t,r){let n=[];e.forEach(e=>{n[e]=!0});let i=[],a=[];return this.order.reverse(),this.order.forEach(e=>{let s=this.getAdjacentNodeIds(e);this.sccNonSingletons[e]||s.includes(e)?(a.push(this.nodesSparseArray[e]),t(this.nodesSparseArray[e]),s.forEach(e=>n[e]=!0)):(i.push(this.nodesSparseArray[e]),n[e]&&r(this.nodesSparseArray[e])&&s.forEach(e=>n[e]=!0))}),{sorted:i,cycled:a}}}},function(e,t,r){"use strict";t.__esModule=!0,t.ProcessableValue=void 0,t.ProcessableValue=class{constructor(e,t){this.rawValue=e,this.processFn=t,this.processedValue=null}getProcessedValue(){return null===this.processedValue&&(this.processedValue=this.processFn(this.rawValue)),this.processedValue}markAsModified(){this.processedValue=null}}},function(e,t,r){"use strict";t.__esModule=!0,t.RangeMapping=void 0,r(2);var n=r(72),i=r(73);function a(e,t){return`${e.col},${e.row},${t.col},${t.row}`}t.RangeMapping=class{constructor(){this.rangeMapping=new Map}getMappingSize(e){var t,r;return null!=(r=null==(t=this.rangeMapping.get(e))?void 0:t.size)?r:0}setRange(e){let t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));let r=a(e.getStart(),e.getEnd());t.set(r,e)}removeRange(e){let t=e.getStart().sheet,r=this.rangeMapping.get(t);if(void 0===r)return;let n=a(e.getStart(),e.getEnd());r.delete(n),0===r.size&&this.rangeMapping.delete(t)}getRange(e,t){let r=this.rangeMapping.get(e.sheet),n=a(e,t);return null==r?void 0:r.get(n)}fetchRange(e,t){let r=this.getRange(e,t);if(!r)throw Error("Range does not exist");return r}truncateRanges(e,t){var r;let n=[],i=[],o=[],u=e.sheet;for(let[r,a]of this.entriesFromSheet(e.sheet)){let s=a.range;e.start<=t(a.range.end)&&(s.removeSpan(e),s.shouldBeRemoved()?(this.removeByKey(u,r),n.push(a)):i.push([r,a]),o.push(a))}let l=[];for(let[e,n]of(i.sort((e,r)=>s(e[1],r[1],t)),i)){let t=a((r=n.range).start,r.end);if(t===e)continue;let i=this.getByKey(u,t);this.removeByKey(u,e),void 0!==i&&n!=i?l.push([i,n]):this.setRange(n)}return{verticesToRemove:n,verticesToMerge:l,verticesWithChangedSize:o}}moveAllRangesInSheetAfterRowByRows(e,t,r){return this.updateVerticesFromSheet(e,(e,n)=>t<=n.start.row?(n.range.shiftByRows(r),{changedSize:!1,vertex:n}):t>n.start.row&&t<=n.end.row?(n.range.expandByRows(r),{changedSize:!0,vertex:n}):void 0)}moveAllRangesInSheetAfterColumnByColumns(e,t,r){return this.updateVerticesFromSheet(e,(e,n)=>t<=n.start.col?(n.range.shiftByColumns(r),{changedSize:!1,vertex:n}):t>n.start.col&&t<=n.end.col?(n.range.expandByColumns(r),{changedSize:!0,vertex:n}):void 0)}moveRangesInsideSourceRange(e,t,r,n){this.updateVerticesFromSheet(e.sheet,(i,a)=>e.containsRange(a.range)?(a.range.shiftByColumns(t),a.range.shiftByRows(r),a.range.moveToSheet(n),{changedSize:!1,vertex:a}):void 0)}removeRangesInSheet(e){if(this.rangeMapping.has(e)){let t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}*rangesInSheet(e){let t=this.rangeMapping.get(e);t&&(yield*t.values())}*rangeVerticesContainedInRange(e){for(let t of this.rangesInSheet(e.sheet))e.containsRange(t.range)&&(yield t)}findSmallerRange(e){if(e.height()>1&&Number.isFinite(e.height())){let t=(0,i.simpleCellAddress)(e.end.sheet,e.end.col,e.end.row-1),r=this.getRange(e.start,t);if(void 0!==r)return{smallerRangeVertex:r,restRange:n.AbsoluteCellRange.fromSimpleCellAddresses((0,i.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row),e.end)}}return{restRange:e}}*entriesFromSheet(e){let t=this.rangeMapping.get(e);t&&(yield*t.entries())}removeByKey(e,t){this.rangeMapping.get(e).delete(t)}getByKey(e,t){var r;return null==(r=this.rangeMapping.get(e))?void 0:r.get(t)}updateVerticesFromSheet(e,t){let r=[];for(let[n,i]of this.entriesFromSheet(e)){let a=t(n,i);void 0!==a&&(this.removeByKey(e,n),r.push(a))}return r.forEach(e=>{this.setRange(e.vertex)}),{verticesWithChangedSize:r.filter(e=>e.changedSize).map(e=>e.vertex)}}};let s=(e,t,r)=>{let n=r(e.range.start),i=r(e.range.start);return n===i?r(e.range.end)-r(t.range.end):n-i}},function(e,t,r){"use strict";t.__esModule=!0,t.SheetMapping=void 0;var n=r(147),i=r(158);function a(e){return e.toLowerCase()}class s{constructor(e,t){this.id=e,this.displayName=t}get canonicalName(){return a(this.displayName)}}t.SheetMapping=class{constructor(e){this.languages=e,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=e=>{let t=this.mappingFromCanonicalName.get(a(e));if(void 0===t)throw new n.NoSheetWithNameError(e);return t.id},this.get=e=>{var t;return null==(t=this.mappingFromCanonicalName.get(a(e)))?void 0:t.id},this.fetchDisplayName=e=>this.fetchSheetById(e).displayName,this.sheetNamePrefix=e.getUITranslation(i.UIElement.NEW_SHEET_PREFIX)}addSheet(e=`${this.sheetNamePrefix}${this.lastSheetId+2}`){let t=a(e);if(this.mappingFromCanonicalName.has(t))throw new n.SheetNameAlreadyTakenError(e);this.lastSheetId++;let r=new s(this.lastSheetId,e);return this.store(r),r.id}removeSheet(e){let t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}getDisplayName(e){var t;return null==(t=this.mappingFromId.get(e))?void 0:t.displayName}*displayNames(){for(let e of this.mappingFromCanonicalName.values())yield e.displayName}numberOfSheets(){return this.mappingFromCanonicalName.size}hasSheetWithId(e){return this.mappingFromId.has(e)}hasSheetWithName(e){return this.mappingFromCanonicalName.has(a(e))}renameSheet(e,t){let r=this.fetchSheetById(e),i=r.displayName;if(i===t)return;let s=this.mappingFromCanonicalName.get(a(t));if(void 0!==s&&s.id!==r.id)throw new n.SheetNameAlreadyTakenError(t);let o=r.canonicalName;return this.mappingFromCanonicalName.delete(o),r.displayName=t,this.store(r),i}sheetNames(){return Array.from(this.mappingFromId.values()).map(e=>e.displayName)}store(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}fetchSheetById(e){let t=this.mappingFromId.get(e);if(void 0===t)throw new n.NoSheetWithIdError(e);return t}}},function(e,t,r){"use strict";t.__esModule=!0,t.UIElement=void 0;var n,i=r(159);t.buildTranslationPackage=i.buildTranslationPackage,t.TranslationPackage=i.TranslationPackage,(n||(t.UIElement=n={})).NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"},function(e,t,r){"use strict";t.__esModule=!0,t.TranslationPackage=void 0,t.buildTranslationPackage=function(e){return new s(Object.assign({},e.functions),Object.assign({},e.errors),Object.assign({},e.ui))},r(2);var n=r(73),i=r(147),a=r(158);class s{constructor(e,t,r){this.functions=e,this.errors=t,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}extendFunctions(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}buildFunctionMapping(){return Object.keys(this.functions).reduce((e,t)=>(e[this.functions[t]]=t,e),{})}buildErrorMapping(){return Object.keys(this.errors).reduce((e,t)=>(e[this.errors[t]]=t,e),{})}isFunctionTranslated(e){return void 0!==this.functions[e]}getFunctionTranslations(e){let t=[];for(let r of e)this.isFunctionTranslated(r)&&t.push(this.functions[r]);return t}getFunctionTranslation(e){let t=this.functions[e];if(void 0===t)throw new i.MissingTranslationError("functions."+e);return t}getMaybeFunctionTranslation(e){return this.functions[e]}getErrorTranslation(e){if(e===n.ErrorType.LIC)return`#${n.ErrorType.LIC}!`;let t=this.errors[e];if(void 0===t)throw new i.MissingTranslationError("errors."+e);return t}getUITranslation(e){let t=this.ui[e];if(void 0===t)throw new i.MissingTranslationError("ui."+e);return t}checkUI(){for(let e of Object.values(a.UIElement))if(!(e in this.ui))throw new i.MissingTranslationError("ui."+e)}checkErrors(){for(let e of Object.values(n.ErrorType))if(!(e in this.errors)&&e!==n.ErrorType.LIC)throw new i.MissingTranslationError("errors."+e)}checkFunctionTranslations(e){let t=new Set(Object.getOwnPropertyNames(e));for(let e of Object.getOwnPropertyNames(this._protectedTranslations))if(t.has(e))throw new i.ProtectedFunctionTranslationError(e)}}t.TranslationPackage=s},function(e,t,r){"use strict";t.__esModule=!0,t.EmptyCellVertex=void 0;var n=r(140);t.EmptyCellVertex=class{constructor(){}getCellValue(){return n.EmptyValue}}},function(e,t,r){"use strict";t.__esModule=!0,t.ValueCellVertex=void 0,t.ValueCellVertex=class{constructor(e,t){this.parsedValue=e,this.rawValue=t}getValues(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}setValues(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}getCellValue(){return this.parsedValue}setCellValue(e){throw Error("SetCellValue is deprecated for ValueCellVertex")}}},function(e,t,r){"use strict";t.__esModule=!0,t.ParsingErrorVertex=void 0;var n=r(73);t.ParsingErrorVertex=class{constructor(e,t){this.errors=e,this.rawInput=t}getCellValue(){let e=this.errors.map(e=>e.message).find(e=>e);return n.CellError.parsingError(e)}getFormula(){return this.rawInput}}},function(e,t,r){"use strict";t.__esModule=!0,t.SparseStrategy=void 0;var n=r(73);t.SparseStrategy=class{constructor(e,t){this.width=e,this.height=t,this.mapping=new Map}getCell(e){var t;return null==(t=this.mapping.get(e.col))?void 0:t.get(e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);let r=this.mapping.get(e.col);r||(r=new Map,this.mapping.set(e.col,r)),r.set(e.row,t)}has(e){var t;return!!(null==(t=this.mapping.get(e.col))?void 0:t.get(e.row))}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){var t;null==(t=this.mapping.get(e.col))||t.delete(e.row)}addRows(e,t){this.mapping.forEach(r=>{let n=new Map;r.forEach((i,a)=>{a>=e&&(n.set(a+t,i),r.delete(a))}),n.forEach((e,t)=>{r.set(t,e)})}),this.height+=t}addColumns(e,t){let r=new Map;this.mapping.forEach((n,i)=>{i>=e&&(r.set(i+t,n),this.mapping.delete(i))}),r.forEach((e,t)=>{this.mapping.set(t,e)}),this.width+=t}removeRows(e){this.mapping.forEach(t=>{let r=new Map;t.forEach((n,i)=>{i>=e.rowStart&&(t.delete(i),i>e.rowEnd&&r.set(i-e.numberOfRows,n))}),r.forEach((e,r)=>{t.set(r,e)})});let t=Math.max(0,Math.min(this.height-1,e.rowEnd)-e.rowStart+1);this.height=Math.max(0,this.height-t)}removeColumns(e){let t=new Map;this.mapping.forEach((r,n)=>{n>=e.columnStart&&(this.mapping.delete(n),n>e.columnEnd&&t.set(n-e.numberOfColumns,r))}),t.forEach((e,t)=>{this.mapping.set(t,e)});let r=Math.max(0,Math.min(this.width-1,e.columnEnd)-e.columnStart+1);this.width=Math.max(0,this.width-r)}*getEntries(e){for(let[t,r]of this.mapping)for(let[i,a]of r)yield[(0,n.simpleCellAddress)(e,t,i),a]}*verticesFromColumn(e){let t=this.mapping.get(e);if(void 0!==t)for(let[e,r]of t)yield r}*verticesFromRow(e){for(let t of this.mapping.values()){let r=t.get(e);void 0!==r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t of e.columns()){let e=this.mapping.get(t);if(void 0!==e)for(let[t,r]of e)yield r}}*verticesFromRowsSpan(e){for(let t of this.mapping.values())for(let r of e.rows()){let e=t.get(r);void 0!==e&&(yield e)}}*entriesFromRowsSpan(e){for(let[t,r]of this.mapping.entries())for(let i of e.rows()){let a=r.get(i);void 0!==a&&(yield[(0,n.simpleCellAddress)(e.sheet,t,i),a])}}*entriesFromColumnsSpan(e){for(let t of e.columns()){let r=this.mapping.get(t);if(void 0!==r)for(let[i,a]of r.entries())yield[(0,n.simpleCellAddress)(e.sheet,t,i),a]}}*vertices(){for(let[e,t]of this.mapping)for(let[e,r]of t)void 0!==r&&(yield r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.DenseStrategy=void 0,r(2);var n=r(73);t.DenseStrategy=class{constructor(e,t){this.width=e,this.height=t,this.mapping=Array(t);for(let r=0;r<t;r++)this.mapping[r]=Array(e)}getCell(e){return this.getCellVertex(e.col,e.row)}setCell(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=Array(this.width)),this.mapping[e.row][e.col]=t}has(e){let t=this.mapping[e.row];return!!t&&!!t[e.col]}getHeight(){return this.height}getWidth(){return this.width}removeCell(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}addRows(e,t){let r=[];for(let e=0;e<t;e++)r.push(Array(this.width));this.mapping.splice(e,0,...r),this.height+=t}addColumns(e,t){for(let r=0;r<this.height;r++)void 0!==this.mapping[r]&&this.mapping[r].splice(e,0,...Array(t));this.width+=t}removeRows(e){this.mapping.splice(e.rowStart,e.numberOfRows);let t=Math.max(0,Math.min(this.height-1,e.rowEnd)-e.rowStart+1);this.height=Math.max(0,this.height-t)}removeColumns(e){for(let t=0;t<this.height;t++)void 0!==this.mapping[t]&&this.mapping[t].splice(e.columnStart,e.numberOfColumns);let t=Math.max(0,Math.min(this.width-1,e.columnEnd)-e.columnStart+1);this.width=Math.max(0,this.width-t)}*getEntries(e){for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r){let i=this.getCellVertex(r,t);i&&(yield[(0,n.simpleCellAddress)(e,r,t),i])}}*verticesFromColumn(e){for(let t=0;t<this.height;++t){let r=this.getCellVertex(e,t);r&&(yield r)}}*verticesFromRow(e){for(let t=0;t<this.width;++t){let r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let e=0;e<this.height;++e){let r=this.getCellVertex(t,e);r&&(yield r)}}*verticesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){let e=this.getCellVertex(t,r);e&&(yield e)}}*entriesFromRowsSpan(e){for(let t=0;t<this.width;++t)for(let r=e.rowStart;r<=e.rowEnd;++r){let i=this.getCellVertex(t,r);i&&(yield[(0,n.simpleCellAddress)(e.sheet,t,r),i])}}*entriesFromColumnsSpan(e){for(let t=e.columnStart;t<=e.columnEnd;++t)for(let r=0;r<this.height;++r){let i=this.getCellVertex(t,r);i&&(yield[(0,n.simpleCellAddress)(e.sheet,t,r),i])}}*vertices(){for(let e=0;e<this.height;++e)for(let t=0;t<this.width;++t){let r=this.getCellVertex(t,e);r&&(yield r)}}getCellVertex(e,t){var r;return null==(r=this.mapping[t])?void 0:r[e]}}},function(e,t,r){"use strict";t.__esModule=!0,t.InterpreterState=void 0,t.InterpreterState=class{constructor(e,t,r){this.formulaAddress=e,this.arraysFlag=t,this.formulaVertex=r}}},function(e,t,r){"use strict";t.__esModule=!0;var n=r(167);t.FunctionPlugin=n.FunctionPlugin,t.FunctionArgumentType=n.FunctionArgumentType,t.EmptyValue=r(140).EmptyValue},function(e,t,r){"use strict";t.__esModule=!0,t.FunctionPlugin=t.FunctionArgumentType=void 0,r(2);var n,i,a=r(72),s=r(73),o=r(131),u=r(77),l=r(168),c=r(140),h=r(139);(n=i||(t.FunctionArgumentType=i={})).STRING="STRING",n.NUMBER="NUMBER",n.BOOLEAN="BOOLEAN",n.SCALAR="SCALAR",n.NOERROR="NOERROR",n.RANGE="RANGE",n.INTEGER="INTEGER",n.COMPLEX="COMPLEX",n.ANY="ANY",t.FunctionPlugin=class{constructor(e){this.coerceScalarToNumberOrError=e=>this.arithmeticHelper.coerceScalarToNumberOrError(e),this.runFunction=(e,t,r,n)=>{let i=this.evaluateArguments(e,t,r),a=i.map(([e,t])=>e),u=i.map(([e,t])=>t),l=this.buildMetadataForEachArgumentValue(a.length,r),c=t.arraysFlag&&!r.vectorizationForbidden;if(!this.isNumberOfArgumentValuesValid(l,a.length))return new s.CellError(s.ErrorType.NA,o.ErrorMessage.WrongArgNumber);let[d,p]=c?this.calculateSizeOfVectorizedResultArray(a,l):[1,1];if(1===d&&1===p){let e=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,l,0,0);return this.calculateSingleCellOfResultArray(t,e,l,u,n,r.returnNumberType)}let m=[...Array(d).keys()].map(e=>[...Array(p).keys()].map(i=>{let s=this.vectorizeAndBroadcastArgumentsIfNecessary(c,a,l,e,i),o=this.calculateSingleCellOfResultArray(t,s,l,u,n,r.returnNumberType);if(o instanceof h.SimpleRangeValue)throw Error("Function returning array cannot be vectorized.");return o}));return h.SimpleRangeValue.onlyValues(m)},this.runFunctionWithReferenceArgument=(e,t,r,n,i,l=()=>new s.CellError(s.ErrorType.NA,o.ErrorMessage.CellRefExpected))=>{if(0===e.length)return this.returnNumberWrapper(n(),r.returnNumberType);if(e.length>1)return new s.CellError(s.ErrorType.NA,o.ErrorMessage.WrongArgNumber);let c,h=e[0];for(;h.type===u.AstNodeType.PARENTHESIS;)h=h.expression;if(h.type===u.AstNodeType.CELL_REFERENCE)c=h.reference.toSimpleCellAddress(t.formulaAddress);else if(h.type===u.AstNodeType.CELL_RANGE||h.type===u.AstNodeType.COLUMN_RANGE||h.type===u.AstNodeType.ROW_RANGE)try{c=a.AbsoluteCellRange.fromAst(h,t.formulaAddress).start}catch(e){return new s.CellError(s.ErrorType.REF,o.ErrorMessage.CellRefExpected)}return void 0!==c?this.returnNumberWrapper(i(c),r.returnNumberType):this.runFunction(e,t,r,l)},this.interpreter=e,this.dependencyGraph=e.dependencyGraph,this.columnSearch=e.columnSearch,this.config=e.config,this.serialization=e.serialization,this.arraySizePredictor=e.arraySizePredictor,this.dateTimeHelper=e.dateTimeHelper,this.arithmeticHelper=e.arithmeticHelper}evaluateAst(e,t){return this.interpreter.evaluateAst(e,t)}arraySizeForAst(e,t){return this.arraySizePredictor.checkArraySizeForAst(e,t)}listOfScalarValues(e,t){let r=[];for(let n of e){let e=this.evaluateAst(n,t);if(e instanceof h.SimpleRangeValue)for(let t of e.valuesFromTopLeftCorner())r.push([t,!0]);else r.push([e,!1])}return r}coerceToType(e,t,r){let n;if(e instanceof h.SimpleRangeValue)switch(t.argumentType){case i.RANGE:case i.ANY:n=e;break;default:{let t=(0,l.coerceRangeToScalar)(e,r);if(void 0===t)return;e=t}}if(!(e instanceof h.SimpleRangeValue))switch(t.argumentType){case i.INTEGER:case i.NUMBER:let a=this.coerceScalarToNumberOrError(e);if(!(0,c.isExtendedNumber)(a)){n=a;break}let u=(0,c.getRawValue)(a);if(void 0!==t.maxValue&&u>t.maxValue)return new s.CellError(s.ErrorType.NUM,o.ErrorMessage.ValueLarge);if(void 0!==t.minValue&&u<t.minValue)return new s.CellError(s.ErrorType.NUM,o.ErrorMessage.ValueSmall);if(void 0!==t.lessThan&&u>=t.lessThan)return new s.CellError(s.ErrorType.NUM,o.ErrorMessage.ValueLarge);if(void 0!==t.greaterThan&&u<=t.greaterThan)return new s.CellError(s.ErrorType.NUM,o.ErrorMessage.ValueSmall);if(t.argumentType===i.INTEGER&&!Number.isInteger(u))return new s.CellError(s.ErrorType.NUM,o.ErrorMessage.IntegerExpected);n=a;break;case i.STRING:n=(0,l.coerceScalarToString)(e);break;case i.BOOLEAN:n=(0,l.coerceScalarToBoolean)(e);break;case i.SCALAR:case i.NOERROR:case i.ANY:n=e;break;case i.RANGE:if(e instanceof s.CellError)return e;n=(0,l.coerceToRange)(e);break;case i.COMPLEX:return this.arithmeticHelper.coerceScalarToComplex((0,c.getRawValue)(e))}return t.passSubtype||void 0===n?n:(0,c.getRawValue)(n)}calculateSingleCellOfResultArray(e,t,r,n,i,a){let o=this.coerceArgumentsToRequiredTypes(e,t,r,n);if(o instanceof s.CellError)return o;let u=i(...o);return this.returnNumberWrapper(u,a)}coerceArgumentsToRequiredTypes(e,t,r,n){let a=[];for(let u=0;u<r.length;u++){let l=r[u],c=void 0!==t[u]?t[u]:null==l?void 0:l.defaultValue;if(void 0===c){a.push(void 0);continue}let h=this.coerceToType(c,l,e);if(void 0===h&&!n[u])return new s.CellError(s.ErrorType.VALUE,o.ErrorMessage.WrongType);if(h instanceof s.CellError&&l.argumentType!==i.SCALAR)return h;a.push(h)}return a}vectorizeAndBroadcastArgumentsIfNecessary(e,t,r,n,i){return t.map((t,a)=>e&&this.isRangePassedAsAScalarArgument(t,r[a])?this.vectorizeAndBroadcastRangeArgument(t,n,i):t)}vectorizeAndBroadcastRangeArgument(e,t,r){var n;let i=1===e.height()?0:t,a=1===e.width()?0:r;return null==(n=e.data[i])?void 0:n[a]}evaluateArguments(e,t,r){return r.expandRanges?this.listOfScalarValues(e,t):e.map(e=>[this.evaluateAst(e,t),!1])}buildMetadataForEachArgumentValue(e,t){let r=t.parameters?[...t.parameters]:[];if(void 0!==t.repeatLastArgs&&Number.isInteger(t.repeatLastArgs)&&t.repeatLastArgs>0)for(;e>r.length;)r.push(...r.slice(r.length-t.repeatLastArgs));return r}isNumberOfArgumentValuesValid(e,t){return!(t>e.length)&&(!(t<e.length)||e.slice(t).every(e=>(null==e?void 0:e.optionalArg)||void 0!==(null==e?void 0:e.defaultValue)))}calculateSizeOfVectorizedResultArray(e,t){let r=e.filter((e,r)=>this.isRangePassedAsAScalarArgument(e,t[r]));return[Math.max(1,...r.map(e=>e.height())),Math.max(1,...r.map(e=>e.width()))]}isRangePassedAsAScalarArgument(e,t){return null!=e&&null!=t&&e instanceof h.SimpleRangeValue&&![i.RANGE,i.ANY].includes(t.argumentType)}metadata(e){let t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw Error(`No metadata for function ${e}.`)}returnNumberWrapper(e,t,r){return void 0!==t&&(0,c.isExtendedNumber)(e)?this.arithmeticHelper.ExtendedNumberFactory((0,c.getRawValue)(e),{type:t,format:r}):e}}},function(e,t,r){"use strict";t.__esModule=!0,t.ArithmeticHelper=void 0,t.coerceBooleanToNumber=l,t.coerceComplexToString=function([e,t],r){if(!isFinite(e)||!isFinite(t))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NaN);if(r=null!=r?r:"i",0===t)return""+e;let a=`${-1===t||1===t?"":Math.abs(t)}${r}`;return 0===e?`${t<0?"-":""}${a}`:`${e}${t<0?"-":"+"}${a}`},t.coerceEmptyToValue=c,t.coerceRangeToScalar=function(e,t){var r;if(e.isAdHoc())return null==(r=e.data[0])?void 0:r[0];let n=e.range;if(t.formulaAddress.sheet===n.sheet){if(1===n.width()){let r=t.formulaAddress.row-n.start.row;if(r>=0&&r<n.height())return e.data[r][0]}else if(1===n.height()){let r=t.formulaAddress.col-n.start.col;if(r>=0&&r<n.width())return e.data[0][r]}}},t.coerceScalarToBoolean=function(e){if(e instanceof n.CellError||"boolean"==typeof e)return e;if(e===s.EmptyValue)return!1;if((0,s.isExtendedNumber)(e))return 0!==(0,s.getRawValue)(e);{let t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0}},t.coerceScalarToString=function(e){return e instanceof n.CellError||"string"==typeof e?e:e===s.EmptyValue?"":(0,s.isExtendedNumber)(e)?(0,s.getRawValue)(e).toString():e?"TRUE":"FALSE"},t.coerceToRange=function(e){return e instanceof o.SimpleRangeValue?e:o.SimpleRangeValue.fromScalar(e)},t.coerceToRangeNumbersOrError=function(e){return e instanceof o.SimpleRangeValue&&e.hasOnlyNumbers()||e instanceof n.CellError?e:(0,s.isExtendedNumber)(e)?o.SimpleRangeValue.fromScalar(e):null},t.fixNegativeZero=function(e){return 0===e?0:e},t.forceNormalizeString=function(e){return E(e.toLowerCase(),"nfd").replace(/[\u0300-\u036f]/g,"")},t.isNumberOverflow=function(e){return isNaN(e)||e===1/0||e===-1/0},t.normalizeString=E,t.numberCmp=h,t.zeroIfEmpty=function(e){return e===s.EmptyValue?0:e},r(2);var n=r(73),i=r(131),a=r(169),s=r(140),o=r(139);let u=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/;function l(e){return Number(e)}function c(e){return"string"==typeof e?"":(0,s.isExtendedNumber)(e)?0:"boolean"!=typeof e&&s.EmptyValue}function h(e,t){let r=(0,s.getRawValue)(e),n=(0,s.getRawValue)(t);return r>n?1:r<n?-1:0}function d(e){return["*","?"].includes(e)}t.ArithmeticHelper=class{constructor(e,t,r){this.config=e,this.dateTimeHelper=t,this.numberLiteralsHelper=r,this.lt=(e,t)=>0>this.compare(e,t),this.leq=(e,t)=>0>=this.compare(e,t),this.gt=(e,t)=>this.compare(e,t)>0,this.geq=(e,t)=>this.compare(e,t)>=0,this.eq=(e,t)=>0===this.compare(e,t),this.neq=(e,t)=>0!==this.compare(e,t),this.pow=(e,t)=>Math.pow((0,s.getRawValue)(e),(0,s.getRawValue)(t)),this.addWithEpsilonRaw=(e,t)=>{let r=e+t;return Math.abs(r)<this.actualEps*Math.abs(e)?0:r},this.addWithEpsilon=(e,t)=>{let r=g(e,t);return this.ExtendedNumberFactory(this.addWithEpsilonRaw((0,s.getRawValue)(e),(0,s.getRawValue)(t)),r)},this.unaryMinus=e=>(0,s.cloneNumber)(e,-(0,s.getRawValue)(e)),this.unaryPlus=e=>e,this.unaryPercent=e=>new s.PercentNumber((0,s.getRawValue)(e)/100),this.concat=(e,t)=>e.concat(t),this.nonstrictadd=(e,t)=>e instanceof n.CellError?e:t instanceof n.CellError?t:"number"==typeof e?"number"==typeof t?this.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0,this.subtract=(e,t)=>{let r=g(e,t),n=(0,s.getRawValue)(e),i=n-(0,s.getRawValue)(t);return Math.abs(i)<this.actualEps*Math.abs(n)&&(i=0),this.ExtendedNumberFactory(i,r)},this.divide=(e,t)=>{let r=(0,s.getRawValue)(e),i=(0,s.getRawValue)(t);if(0===i)return new n.CellError(n.ErrorType.DIV_BY_ZERO);{let n=f(e,t);return this.ExtendedNumberFactory(r/i,n)}},this.multiply=(e,t)=>{let r=f(e,t);return this.ExtendedNumberFactory((0,s.getRawValue)(e)*(0,s.getRawValue)(t),r)},this.manyToExactComplex=e=>{let t=[];for(let r of e){if(r instanceof n.CellError)return r;if((0,s.isExtendedNumber)(r)||"string"==typeof r){let e=this.coerceScalarToComplex(r);e instanceof n.CellError||t.push(e)}}return t},this.coerceNumbersExactRanges=e=>this.manyToNumbers(e,this.manyToExactNumbers),this.coerceNumbersCoerceRangesDropNulls=e=>this.manyToNumbers(e,this.manyToCoercedNumbersDropNulls),this.manyToExactNumbers=e=>{let t=[];for(let r of e){if(r instanceof n.CellError)return r;(0,s.isExtendedNumber)(r)&&t.push((0,s.getRawValue)(r))}return t},this.manyToOnlyNumbersDropNulls=e=>{let t=[];for(let r of e){if(r instanceof n.CellError)return r;if((0,s.isExtendedNumber)(r))t.push((0,s.getRawValue)(r));else if(r!==s.EmptyValue)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected)}return t},this.manyToCoercedNumbersDropNulls=e=>{let t=[];for(let r of e){if(r instanceof n.CellError)return r;if(r===s.EmptyValue)continue;let e=this.coerceScalarToNumberOrError(r);(0,s.isExtendedNumber)(e)&&t.push((0,s.getRawValue)(e))}return t},this.collator=(0,a.collatorFromConfig)(e),this.actualEps=e.smartRounding?e.precisionEpsilon:0}eqMatcherFunction(e){let t=this.buildRegex(e);return e=>"string"==typeof e&&t.test(this.normalizeString(e))}neqMatcherFunction(e){let t=this.buildRegex(e);return e=>!("string"==typeof e&&t.test(this.normalizeString(e)))}searchString(e,t){var r;let n=this.buildRegex(e,!1).exec(t);return null!=(r=null==n?void 0:n.index)?r:-1}requiresRegex(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(let t=0;t<e.length;t++){let r=e.charAt(t);if(d(r)||this.config.useRegularExpressions&&m(r))return!0}return!1}floatCmp(e,t){let r=(0,s.getRawValue)(e),n=(0,s.getRawValue)(t),i=1+this.actualEps;return n>=0&&r*i>=n&&r<=n*i||n<=0&&r*i<=n&&r>=n*i?0:r>n?1:-1}coerceScalarToNumberOrError(e){var t;return e instanceof n.CellError?e:null!=(t=this.coerceToMaybeNumber(e))?t:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberCoercion)}coerceToMaybeNumber(e){var t;return null!=(t=this.coerceNonDateScalarToMaybeNumber(e))?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}coerceNonDateScalarToMaybeNumber(e){if(e===s.EmptyValue)return 0;if("string"==typeof e){if(""===e)return 0;let t=this.coerceStringToMaybePercentNumber(e);if(void 0!==t)return t;let r=this.coerceStringToMaybeCurrencyNumber(e);return void 0!==r?r:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim())}return(0,s.isExtendedNumber)(e)?e:"boolean"==typeof e?Number(e):void 0}coerceStringToMaybePercentNumber(e){let t=e.trim();if(t.endsWith("%")){let e=t.slice(0,t.length-1).trim(),r=this.numberLiteralsHelper.numericStringToMaybeNumber(e);if(void 0!==r)return new s.PercentNumber(r/100)}}coerceStringToMaybeCurrencyNumber(e){let t=this.currencyMatcher(e.trim());if(void 0!==t){let[e,r]=t,n=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==n)return new s.CurrencyNumber(n,e)}}currencyMatcher(e){for(let t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length).trim()];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length).trim()]}}coerceComplexExactRanges(e){let t=[];for(let r of e)if(r instanceof o.SimpleRangeValue)t.push(r);else if(r!==s.EmptyValue){let e=this.coerceScalarToComplex(r);if(e instanceof n.CellError)return e;t.push(e)}let r=[];for(let e of t)if(e instanceof o.SimpleRangeValue){let t=this.manyToExactComplex(e.valuesFromTopLeftCorner());if(t instanceof n.CellError)return t;r.push(...t)}else r.push(e);return r}coerceScalarToComplex(e){return e instanceof n.CellError?e:e===s.EmptyValue?[0,0]:(0,s.isExtendedNumber)(e)?[(0,s.getRawValue)(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected)}ExtendedNumberFactory(e,t){let{type:r,format:n}=t;switch(r){case s.NumberType.NUMBER_RAW:return e;case s.NumberType.NUMBER_CURRENCY:return new s.CurrencyNumber(e,null!=n?n:this.config.currencySymbol[0]);case s.NumberType.NUMBER_DATE:return new s.DateNumber(e,n);case s.NumberType.NUMBER_DATETIME:return new s.DateTimeNumber(e,n);case s.NumberType.NUMBER_TIME:return new s.TimeNumber(e,n);case s.NumberType.NUMBER_PERCENT:return new s.PercentNumber(e,n)}}buildRegex(e,t=!0){let r;e=this.normalizeString(e);let n=this.config.useWildcards,i=this.config.useRegularExpressions;if(i)try{RegExp(e)}catch(e){i=!1,n=!1}return r=i?function(e,t){let r="";for(let n=0;n<e.length;n++){let i=e.charAt(n);d(i)||m(i)?r+=i:r+=t?i:i.toLowerCase()}return r}(e,this.config.caseSensitive):n?function(e,t){let r="";for(let n=0;n<e.length;n++){let i=e.charAt(n);if("~"===i){if(n==e.length-1){r+="~";continue}let t=e.charAt(n+1);d(t)||m(t)?r+="\\"+t:r+=t,n++}else d(i)?r+="."+i:m(i)?r+="\\"+i:r+=t?i:i.toLowerCase()}return r}(e,this.config.caseSensitive):function(e,t){let r="";for(let n=0;n<e.length;n++){let i=e.charAt(n);d(i)||m(i)?r+="\\"+i:r+=t?i:i.toLowerCase()}return r}(e,this.config.caseSensitive),this.config.matchWholeCell&&t?RegExp("^("+r+")$"):RegExp(r)}normalizeString(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=E(e,"nfd").replace(/[\u0300-\u036f]/g,"")),e}compare(e,t){if("string"==typeof e||"string"==typeof t){let r="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,n="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if((0,s.isExtendedNumber)(r)&&(0,s.isExtendedNumber)(n))return this.floatCmp(r,n)}return e===s.EmptyValue?e=c(t):t===s.EmptyValue&&(t=c(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?h(l(e),l(t)):(0,s.isExtendedNumber)(e)&&(0,s.isExtendedNumber)(t)?this.floatCmp(e,t):e===s.EmptyValue&&t===s.EmptyValue?0:h((0,n.CellValueTypeOrd)((0,n.getCellValueType)(e)),(0,n.CellValueTypeOrd)((0,n.getCellValueType)(t)))}stringCmp(e,t){return this.collator.compare(e,t)}manyToNumbers(e,t){let r=[];for(let t of e)if(t instanceof o.SimpleRangeValue)r.push(t);else{let e=(0,s.getRawValue)(this.coerceScalarToNumberOrError(t));if(e instanceof n.CellError)return e;r.push(e)}let i=[];for(let e of r)if(e instanceof o.SimpleRangeValue){let r=t(e.valuesFromTopLeftCorner());if(r instanceof n.CellError)return r;i.push(...r)}else i.push(e);return i}coerceStringToComplex(e){let t,r,a=u.exec(e);return null===a?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected):(t=void 0!==a[6]?"-"===a[1]?[0,-1]:[0,1]:this.parseComplexToken(a[1]+a[3],a[5]))instanceof n.CellError||void 0===a[8]?t:(r=void 0!==a[14]?"-"===a[9]?[0,-1]:[0,1]:this.parseComplexToken(a[9]+a[11],a[13]))instanceof n.CellError?r:""!==a[5]||""===a[13]?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected):"+"===a[8]?[t[0]+r[0],t[1]+r[1]]:[t[0]-r[0],t[1]-r[1]]}parseComplexToken(e,t){let r=(0,s.getRawValue)(this.coerceNonDateScalarToMaybeNumber(e));return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ComplexNumberExpected):""===t?[r,0]:[0,r]}};let p=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function m(e){return p.includes(e)}function g(e,t){let{type:r,format:n}=(0,s.getTypeFormatOfExtendedNumber)(e),{type:i,format:a}=(0,s.getTypeFormatOfExtendedNumber)(t);if(r===s.NumberType.NUMBER_RAW)return{type:i,format:a};if(i===s.NumberType.NUMBER_RAW)return{type:r,format:n};if((r===s.NumberType.NUMBER_DATETIME||r===s.NumberType.NUMBER_DATE)&&(i===s.NumberType.NUMBER_DATETIME||i===s.NumberType.NUMBER_DATE))return{type:s.NumberType.NUMBER_RAW};if(r===s.NumberType.NUMBER_TIME){if(i===s.NumberType.NUMBER_DATE)return{type:s.NumberType.NUMBER_DATETIME,format:`${a} ${n}`};if(i===s.NumberType.NUMBER_DATETIME)return{type:s.NumberType.NUMBER_DATETIME,format:a}}if(i===s.NumberType.NUMBER_TIME){if(r===s.NumberType.NUMBER_DATE)return{type:s.NumberType.NUMBER_DATETIME,format:`${n} ${a}`};if(r===s.NumberType.NUMBER_DATETIME)return{type:s.NumberType.NUMBER_DATETIME,format:n}}return{type:r,format:n}}function f(e,t){let{type:r,format:n}=(0,s.getTypeFormatOfExtendedNumber)(e),{type:i,format:a}=(0,s.getTypeFormatOfExtendedNumber)(t);return r===s.NumberType.NUMBER_PERCENT&&(r=s.NumberType.NUMBER_RAW,n=void 0),i===s.NumberType.NUMBER_PERCENT&&(i=s.NumberType.NUMBER_RAW,a=void 0),r===s.NumberType.NUMBER_RAW?{type:i,format:a}:i===s.NumberType.NUMBER_RAW?{type:r,format:n}:{type:s.NumberType.NUMBER_RAW}}function E(e,t){return e.normalize(t.toUpperCase())}},function(e,t,r){"use strict";t.__esModule=!0,t.collatorFromConfig=function(e){let t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",r=e.caseFirst,n=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:r,ignorePunctuation:n})}},function(e,t,r){"use strict";t.__esModule=!0,t.DetailedCellError=void 0,t.DetailedCellError=class{constructor(e,t,r){var n;this.value=t,this.address=r,this.type=e.type,this.message=null!=(n=e.message)?n:""}toString(){return this.value}valueOf(){return this.value}}},function(e,t,r){"use strict";t.__esModule=!0,t.Config=void 0,t.getDefaultConfig=function(){return p({})};var n=r(172),i=r(173),a=r(174),s=r(175),o=r(147),u=r(176),l=r(178),c=r(180);let h=new WeakMap;class d{constructor(e={},t=!0){let{accentSensitive:r,binarySearchThreshold:i,caseSensitive:s,caseFirst:o,chooseAddressMappingPolicy:u,context:p,currencySymbol:m,dateFormats:g,decimalSeparator:f,evaluateNullToZero:E,functionArgSeparator:T,functionPlugins:y,ignorePunctuation:A,leapYear1900:R,localeLang:N,language:S,ignoreWhiteSpace:C,licenseKey:O,matchWholeCell:v,arrayColumnSeparator:I,arrayRowSeparator:M,maxRows:b,maxColumns:F,nullYear:w,nullDate:_,parseDateTime:L,precisionEpsilon:x,precisionRounding:P,stringifyDateTime:U,stringifyDuration:V,smartRounding:D,timeFormats:B,thousandSeparator:k,useArrayArithmetic:G,useStats:j,undoLimit:W,useColumnIndex:H,useRegularExpressions:z,useWildcards:Y}=e;t&&d.warnDeprecatedOptions(e),this.useArrayArithmetic=(0,n.configValueFromParam)(G,"boolean","useArrayArithmetic"),this.accentSensitive=(0,n.configValueFromParam)(r,"boolean","accentSensitive"),this.caseSensitive=(0,n.configValueFromParam)(s,"boolean","caseSensitive"),this.caseFirst=(0,n.configValueFromParam)(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=(0,n.configValueFromParam)(A,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=u?u:d.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=[...(0,n.configValueFromParamCheck)(g,Array.isArray,"array","dateFormats")],this.timeFormats=[...(0,n.configValueFromParamCheck)(B,Array.isArray,"array","timeFormats")],this.functionArgSeparator=(0,n.configValueFromParam)(T,"string","functionArgSeparator"),this.decimalSeparator=(0,n.configValueFromParam)(f,[".",","],"decimalSeparator"),this.language=(0,n.configValueFromParam)(S,"string","language"),this.ignoreWhiteSpace=(0,n.configValueFromParam)(C,["standard","any"],"ignoreWhiteSpace"),this.licenseKey=(0,n.configValueFromParam)(O,"string","licenseKey"),this.thousandSeparator=(0,n.configValueFromParam)(k,["",","," ","."],"thousandSeparator"),this.arrayColumnSeparator=(0,n.configValueFromParam)(I,[",",";"],"arrayColumnSeparator"),this.arrayRowSeparator=(0,n.configValueFromParam)(M,[";","|"],"arrayRowSeparator"),this.localeLang=(0,n.configValueFromParam)(N,"string","localeLang"),this.functionPlugins=[...null!=y?y:d.defaultConfig.functionPlugins],this.smartRounding=(0,n.configValueFromParam)(D,"boolean","smartRounding"),this.evaluateNullToZero=(0,n.configValueFromParam)(E,"boolean","evaluateNullToZero"),this.nullYear=(0,n.configValueFromParam)(w,"number","nullYear"),(0,n.validateNumberToBeAtLeast)(this.nullYear,"nullYear",0),(0,n.validateNumberToBeAtMost)(this.nullYear,"nullYear",100),this.precisionRounding=(0,n.configValueFromParam)(P,"number","precisionRounding"),(0,n.validateNumberToBeAtLeast)(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=(0,n.configValueFromParam)(x,"number","precisionEpsilon"),(0,n.validateNumberToBeAtLeast)(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=(0,n.configValueFromParam)(H,"boolean","useColumnIndex"),this.useStats=(0,n.configValueFromParam)(j,"boolean","useStats"),this.binarySearchThreshold=null!=i?i:d.defaultConfig.binarySearchThreshold,this.parseDateTime=(0,n.configValueFromParam)(L,"function","parseDateTime"),this.stringifyDateTime=(0,n.configValueFromParam)(U,"function","stringifyDateTime"),this.stringifyDuration=(0,n.configValueFromParam)(V,"function","stringifyDuration"),this.translationPackage=c.HyperFormula.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=(0,n.configValueFromParamCheck)(_,a.instanceOfSimpleDate,"IDate","nullDate"),this.leapYear1900=(0,n.configValueFromParam)(R,"boolean","leapYear1900"),this.undoLimit=(0,n.configValueFromParam)(W,"number","undoLimit"),this.useRegularExpressions=(0,n.configValueFromParam)(z,"boolean","useRegularExpressions"),this.useWildcards=(0,n.configValueFromParam)(Y,"boolean","useWildcards"),this.matchWholeCell=(0,n.configValueFromParam)(v,"boolean","matchWholeCell"),(0,n.validateNumberToBeAtLeast)(this.undoLimit,"undoLimit",0),this.maxRows=(0,n.configValueFromParam)(b,"number","maxRows"),(0,n.validateNumberToBeAtLeast)(this.maxRows,"maxRows",1),this.maxColumns=(0,n.configValueFromParam)(F,"number","maxColumns"),this.currencySymbol=this.setupCurrencySymbol(m),(0,n.validateNumberToBeAtLeast)(this.maxColumns,"maxColumns",1),this.context=p,h.set(this,{licenseKeyValidityState:(0,l.checkLicenseKeyValidity)(this.licenseKey)}),(0,n.configCheckIfParametersNotInConflict)({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"}),(0,n.configCheckIfParametersNotInConflict)({value:this.arrayRowSeparator,name:"arrayRowSeparator"},{value:this.arrayColumnSeparator,name:"arrayColumnSeparator"})}setupCurrencySymbol(e){let t=[...(0,n.configValueFromParamCheck)(e,Array.isArray,"array","currencySymbol")];return t.forEach(e=>{if("string"!=typeof e)throw new o.ExpectedValueOfTypeError("string[]","currencySymbol");if(""===e)throw new o.ConfigValueEmpty("currencySymbol")}),t}get licenseKeyValidityState(){return h.get(this).licenseKeyValidityState}getConfig(){return p(this)}mergeConfig(e){let t=Object.assign({},this.getConfig(),e);return d.warnDeprecatedOptions(e),new d(t,!1)}static warnDeprecatedOptions(e){d.warnDeprecatedIfUsed(e.binarySearchThreshold,"binarySearchThreshold","1.1")}static warnDeprecatedIfUsed(e,t,r,n){void 0!==e&&(void 0===n?console.warn(`${t} option is deprecated since ${r}`):console.warn(`${t} option is deprecated since ${r}, please use ${n}`))}}function p(e){var t;let r={};for(let n in d.defaultConfig){let i=null!=(t=e[n])?t:d.defaultConfig[n];Array.isArray(i)?r[n]=[...i]:r[n]=i}return r}t.Config=d,d.defaultConfig={accentSensitive:!1,binarySearchThreshold:20,currencySymbol:["$"],caseSensitive:!1,caseFirst:"lower",context:void 0,chooseAddressMappingPolicy:new s.AlwaysDense,dateFormats:["DD/MM/YYYY","DD/MM/YY"],decimalSeparator:".",evaluateNullToZero:!1,functionArgSeparator:",",functionPlugins:[],ignorePunctuation:!1,language:"enGB",ignoreWhiteSpace:"standard",licenseKey:"",leapYear1900:!1,localeLang:"en",matchWholeCell:!0,arrayColumnSeparator:",",arrayRowSeparator:";",maxRows:4e4,maxColumns:18278,nullYear:30,nullDate:{year:1899,month:12,day:30},parseDateTime:i.defaultParseToDateTime,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,stringifyDateTime:u.defaultStringifyDateTime,stringifyDuration:u.defaultStringifyDuration,timeFormats:["hh:mm","hh:mm:ss.sss"],thousandSeparator:"",undoLimit:20,useRegularExpressions:!1,useWildcards:!0,useColumnIndex:!1,useStats:!1,useArrayArithmetic:!1}},function(e,t,r){"use strict";t.__esModule=!0,t.configCheckIfParametersNotInConflict=function(...e){let t=new Map;e.forEach(e=>{let r=t.get(e.value)||[];r.push(e.name),t.set(e.value,r)});let r=[];for(let e of t.values())e.length>1&&r.push(e);if(r.length>0)throw r.forEach(e=>e.sort()),Error("Config initialization failed. Parameters in conflict: "+r.map(e=>`[${e}]`).join("; "))},t.configValueFromParam=function(e,t,r){if(void 0===e)return n.Config.defaultConfig[r];if("string"==typeof t){if(typeof e===t)return e;throw new i.ExpectedValueOfTypeError(t,r)}if(t.includes(e))return e;throw new i.ExpectedOneOfValuesError(t.map(e=>`'${e}'`).join(" "),r)},t.configValueFromParamCheck=function(e,t,r,a){if(t(e))return e;if(void 0===e)return n.Config.defaultConfig[a];throw new i.ExpectedValueOfTypeError(r,a)},t.validateArgToType=function(e,t,r){if(typeof e!==t)throw new i.ExpectedValueOfTypeError(t,r)},t.validateNumberToBeAtLeast=function(e,t,r){if(e<r)throw new i.ConfigValueTooSmallError(t,r)},t.validateNumberToBeAtMost=function(e,t,r){if(e>r)throw new i.ConfigValueTooBigError(t,r)},r(2);var n=r(171),i=r(147)},function(e,t,r){"use strict";t.__esModule=!0,t.TIME_FORMAT_SECONDS_ITEM_REGEXP=void 0,t.defaultParseToDateTime=function(e,t,r){var n;if(void 0===t&&void 0===r)return;let o=e.replace(a," ").trim().toLowerCase();if(n=o,!i.test(n))return;let u=o.substring(o.length-2);"am"===u||"pm"===u?o=o.substring(0,o.length-2).trim():"a"===(u=o.substring(o.length-1))||"p"===u?o=o.substring(0,o.length-1).trim():u=void 0;let h=o.split(s);h.length>=2&&h[h.length-2].includes(":")&&(h[h.length-2]=h[h.length-2]+"."+h[h.length-1],h.pop());let d=h[h.length-1].split(":");if(void 0!==u&&d.push(u),1===h.length)return l(d,r);if(1===d.length)return c(h,t);let p=c(h.slice(0,h.length-1),t),m=l(d,r);return void 0===p||void 0===m?void 0:Object.assign(Object.assign({},p),m)},r(2);let n=t.TIME_FORMAT_SECONDS_ITEM_REGEXP=RegExp("^ss(\\.(s+|0+))?$"),i=RegExp("^[0-9/.\\-: ]+[ap]?m?$"),a=RegExp("\\s+"),s=RegExp("[ /.-]"),o=h(function(e){let t=e.toLowerCase().trim(),r=(t.endsWith("am/pm")?t.substring(0,t.length-5):t.endsWith("a/p")?t.substring(0,e.length-3):t).trim().split(":");return{itemsCount:r.length,hourItem:r.indexOf("hh"),minuteItem:r.indexOf("mm"),secondItem:r.findIndex(e=>n.test(e))}}),u=h(function(e){let t=e.toLowerCase().trim().split(s);return{itemsCount:t.length,dayItem:t.indexOf("dd"),monthItem:t.indexOf("mm"),shortYearItem:t.indexOf("yy"),longYearItem:t.indexOf("yyyy")}});function l(e,t){var r,n,i;let a;if(void 0===t)return;let{itemsCount:s,hourItem:u,minuteItem:l,secondItem:c}=o(t);if("am"===e[e.length-1]||"a"===e[e.length-1]?(a=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(a=!0,e.pop()),e.length!==s)return;let h=Number(null!=(r=e[c])?r:"0");if(!Number.isFinite(h))return;let d=Math.round(1e3*h)/1e3,p=Number(null!=(n=e[l])?n:"0");if(!Number.isFinite(p)||!Number.isInteger(p))return;let m=Number(null!=(i=e[u])?i:"0");if(Number.isFinite(m)&&Number.isInteger(m)&&(void 0===a||!(m<0)&&!(m>12)))return{hours:void 0!==a?m%12+12*!!a:m,minutes:p,seconds:d}}function c(e,t){var r;if(void 0===t)return;let{itemsCount:n,dayItem:i,monthItem:a,shortYearItem:s,longYearItem:o}=u(t);if(e.length!==n)return;let l=Number(e[i]);if(!Number.isFinite(l)||!Number.isInteger(l))return;let c=Number(e[a]);if(!Number.isFinite(c)||!Number.isInteger(c)||e[o]&&e[s])return;let h=Number(null!=(r=e[o])?r:e[s]);return Number.isFinite(h)&&Number.isInteger(h)&&!(e[o]&&(h<1e3||h>9999)||e[s]&&(h<0||h>99))?{year:h,month:c,day:l}:void 0}function h(e){let t={};return r=>{let n=t[r];if(void 0!==n)return n;let i=e(r);return t[r]=i,i}}},function(e,t,r){"use strict";t.__esModule=!0,t.DateTimeHelper=void 0,t.instanceOfSimpleDate=s,t.instanceOfSimpleTime=o,t.maxDate=void 0,t.numberToSimpleTime=l,t.offsetMonth=function(e,t){let r=12*e.year+e.month-1+t;return{year:Math.floor(r/12),month:r%12+1,day:e.day}},t.roundToNearestSecond=function(e){return Math.round(3600*e*24)/86400},t.timeToNumber=c,t.toBasisEU=function(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}},t.truncateDayInMonth=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,i[e.month-1])}};var n=r(140);let i=[31,28,31,30,31,30,31,31,30,31,30,31],a=[0,31,59,90,120,151,181,212,243,273,304,334];function s(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day}function o(e){return!(!e||"object"!=typeof e&&"function"!=typeof e)&&"hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds}let u=t.maxDate={year:9999,month:12,day:31};function l(e){let t=24*e*3600,r=function(e,t=1){return Math.round(e*t)/t}(t%60,1e5)%60,n=(t-r)/60,i=Math.round(n%60)%60;return{hours:Math.round((n-i)/60),minutes:i,seconds:r}}function c(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}t.DateTimeHelper=class{constructor(e){this.config=e,this.minDateAbsoluteValue=this.dateToNumberFromZero(e.nullDate),this.maxDateValue=this.dateToNumber(u),this.leapYear1900=e.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=e.parseDateTime}getWithinBounds(e){return e<=this.maxDateValue&&e>=0?e:void 0}dateStringToDateNumber(e){let{dateTime:t,dateFormat:r="",timeFormat:i=""}=this.parseDateTimeFromConfigFormats(e);if(void 0!==t)return o(t)?s(t)?new n.DateTimeNumber(c(t)+this.dateToNumber(t),r+" "+i):new n.TimeNumber(c(t),i):s(t)?new n.DateNumber(this.dateToNumber(t),r):0}parseDateTimeFromConfigFormats(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}getNullYear(){return this.config.nullYear}getEpochYearZero(){return this.epochYearZero}isValidDate(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day))&&e.day===Math.round(e.day)&&e.month===Math.round(e.month)&&e.year===Math.round(e.year)&&!(e.year<1582)&&!(e.month<1||e.month>12)&&!(e.day<1)&&(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=i[e.month-1])}dateToNumber(e){return this.dateToNumberFromZero(e)-this.minDateAbsoluteValue}relativeNumberToAbsoluteNumber(e){return e+this.minDateAbsoluteValue-!!this.leapYear1900}numberToSimpleDate(e){var t;let r,n=Math.floor(e)+this.minDateAbsoluteValue,i=Math.floor(n/365.2425);this.dateToNumberFromZero({year:i+1,month:1,day:1})<=n?i++:this.dateToNumberFromZero({year:i-1,month:1,day:1})>n&&i--;let s=n-this.dateToNumberFromZero({year:i,month:1,day:1}),o=(t=s-(this.isLeapYear(i)&&s>=59?1:0),r=0,a[6]<=t&&(r+=6),a[r+3]<=t&&(r+=3),a[r+2]<=t?r+=2:a[r+1]<=t&&(r+=1),r);return{year:i,month:o+1,day:s-a[o]-(this.isLeapYear(i)&&o>1?1:0)+1}}numberToSimpleDateTime(e){let t=l(e%1),r=Math.floor(t.hours/24);return t.hours=t.hours%24,Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e)+r)),t)}leapYearsCount(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}daysInMonth(e,t){return this.isLeapYear(e)&&2===t?29:i[t-1]}endOfMonth(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}toBasisUS(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}yearLengthForBasis(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}parseSingleFormat(e,t,r){let n=this.parseDateTime(e,t,r);if(!s(n)||(n.year>=0&&n.year<100&&(n.year<this.getNullYear()?n.year+=2e3:n.year+=1900),this.isValidDate(n)))return n}parseDateTimeFromFormats(e,t,r){let n=0===t.length?[void 0]:t,i=0===r.length?[void 0]:r;for(let t of n)for(let r of i){let n=this.parseSingleFormat(e,t,r);if(void 0!==n)return{dateTime:n,timeFormat:r,dateFormat:t}}return{}}countLeapDays(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}dateToNumberFromZero(e){return 365*e.year+a[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}isLeapYear(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}}},function(e,t,r){"use strict";t.__esModule=!0,t.DenseSparseChooseBasedOnThreshold=t.AlwaysSparse=t.AlwaysDense=void 0;var n=r(164),i=r(163);t.DenseSparseChooseBasedOnThreshold=class{constructor(e){this.threshold=e}call(e){return e>this.threshold?n.DenseStrategy:i.SparseStrategy}},t.AlwaysSparse=class{call(){return i.SparseStrategy}},t.AlwaysDense=class{call(){return n.DenseStrategy}}},function(e,t,r){"use strict";t.__esModule=!0,t.defaultStringifyDateTime=function(e,t){let r=(0,a.parseForDateTimeFormat)(t);if(void 0===r)return;let i=r.tokens,o="",u=!1,l=i.some(e=>e.type===a.TokenType.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value));for(let t=0;t<i.length;t++){let r=i[t];if(r.type!==a.TokenType.FREE_TEXT)switch(r.value.toLowerCase()){case"h":case"hh":u=!0,o+=s(l?(e.hours+11)%12+1:e.hours,r.value.length);break;case"d":case"dd":o+=s(e.day,r.value.length);break;case"s":case"ss":o+=s(Math.floor(e.seconds),r.value.length);break;case"m":case"mm":t+1<i.length&&i[t+1].value.startsWith(":")&&(u=!0),o+=s(u?e.minutes:e.month,r.value.length),u=!0;break;case"yy":o+=s(e.year%100,r.value.length);break;case"yyyy":o+=e.year;break;case"am/pm":case"a/p":{let[t,n]=r.value.split("/");o+=e.hours<12?t:n;break}default:if(n.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(r.value)){let t=r.value.length-3;o+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,t))/Math.pow(10,t)}`;continue}return}else o+=r.value}return o},t.defaultStringifyDuration=function(e,t){let r=(0,a.parseForDateTimeFormat)(t);if(void 0===r)return;let i=r.tokens,o="";for(let t of i)if(t.type!==a.TokenType.FREE_TEXT)switch(t.value.toLowerCase()){case"h":case"hh":o+=s(e.hours,t.value.length),e.hours=0;break;case"[hh]":o+=s(e.hours,t.value.length-2),e.hours=0;break;case"m":case"mm":o+=s(e.minutes,t.value.length),e.minutes=0;break;case"[mm]":o+=s(e.minutes+60*e.hours,t.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":o+=s(Math.floor(e.seconds),t.value.length);break;default:if(n.TIME_FORMAT_SECONDS_ITEM_REGEXP.test(t.value)){let r=Math.max(t.value.length-3,0);o+=`${e.seconds<10?"0":""}${Math.floor(e.seconds*Math.pow(10,r))/Math.pow(10,r)}`;continue}return}else o+=t.value;return o},t.format=function(e,t,r,n){let l=r.stringifyDateTime(n.numberToSimpleDateTime(e),t);if(void 0!==l)return l;let c=r.stringifyDuration((0,i.numberToSimpleTime)(e),t);if(void 0!==c)return c;let h=(0,a.parseForNumberFormat)(t);return void 0!==h?function(e,t){let r="";for(let n=0;n<e.length;++n){let i=e[n];if(i.type===a.TokenType.FREE_TEXT){r+=i.value;continue}let l=i.value.split("."),c=l[0],h=l[1]||"",d=l[1]?".":"",p=Number(t.toFixed(h.length)).toString().split("."),m=p[0]||"",g=p[1]||"";if(c.length>m.length){let e=u(c.substr(0,c.length-m.length),"0");m=s(m,e+m.length)}let f=u(h.substr(g.length,h.length-g.length),"0");r+=m+d+(g=o(g,f+g.length))}return r}(h.tokens,e):t},t.padLeft=s,t.padRight=o;var n=r(173),i=r(174),a=r(177);function s(e,t){let r=""+e;for(;r.length<t;)r="0"+r;return r}function o(e,t){let r=""+e;for(;r.length<t;)r+="0";return r}function u(e,t){return e.split(t).length-1}},function(e,t,r){"use strict";var n,i,a,s;t.__esModule=!0,t.TokenType=t.FormatExpressionType=void 0,t.formatToken=l,t.isEscapeToken=p,t.parse=function(e){var t,r;return null!=(r=null!=(t=h(e))?t:d(e))?r:{type:i.STRING,tokens:[{type:n.FREE_TEXT,value:e}]}},t.parseForDateTimeFormat=h,t.parseForNumberFormat=d,r(2);let o=/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g,u=/(\\.|[#0]+(\.[#0]*)?)/g;function l(e,t){return{type:e,value:t}}function c(e,t){let r=[],i=0;for(let a=0;a<e.length;++a){let s=e[a];if(s.index!==i){let e=t.substr(i,s.index-i);r.push(l(n.FREE_TEXT,e))}s[0].startsWith("\\")?r.push(l(n.FREE_TEXT,s[0])):r.push(l(n.FORMAT,s[0])),i=s.index+s[0].length}let a=e[e.length-1];if(a.index+a[0].length<t.length){let e=t.substr(a.index+a[0].length,t.length);r.push(l(n.FREE_TEXT,e))}return r}function h(e){let t=function(e){let t;o.lastIndex=0;let r=[];do null!==(t=o.exec(e))&&r.push(t);while(t)return r}(e);return t.every(e=>p(e))?void 0:{type:i.DATE,tokens:c(t,e)}}function d(e){let t=function(e){u.lastIndex=0;let t=u.exec(e);return null!==t?[t]:[]}(e);return t.every(e=>p(e))?void 0:{type:i.NUMBER,tokens:c(t,e)}}function p(e){return e[0].startsWith("\\")}(a=n||(t.TokenType=n={})).FORMAT="FORMAT",a.FREE_TEXT="FREE_TEXT",(s=i||(t.FormatExpressionType=i={})).DATE="DATE",s.NUMBER="NUMBER",s.STRING="STRING"},function(e,t,r){"use strict";t.__esModule=!0,t.checkLicenseKeyValidity=function(e){let t={template:"missing",vars:{}};if("gpl-v3"===e||"internal-use-in-handsontable"===e)t.template="valid";else if("string"==typeof e&&(0,n.checkKeySchema)(e)){let[r,i,a]="18/07/2024".split("/"),s=Math.floor(new Date(`${i}/${r}/${a}`).getTime()/864e5),o=(0,n.extractTime)(e);t.vars.keyValidityDate=function(e){let t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],r=e.getDate(),n=e.getFullYear();return`${t} ${r}, ${n}`}(new Date(864e5*(o+1))),t.template=s>o?"expired":"valid"}else""!==e&&(t.template="invalid");return a||"valid"===t.template||(console.warn(i[t.template](t.vars)),a=!0),t.template};var n=r(179);let i={invalid:()=>"The license key for HyperFormula is invalid.",expired:({keyValidityDate:e})=>`The license key for HyperFormula expired on ${e}, and is not valid for the installed version.`,missing:()=>"The license key for HyperFormula is missing."},a=!1},function(e,t,r){"use strict";t.__esModule=!0,t.checkKeySchema=function(e){if((e=(e+"").replace(/\-/g,""))[n]!==u("Z"))return!1;let t=0;return 0===[[0,u("G")+1],[u("H"),u("H")-1],[u("G")+u("H"),u("G")]].reduce((r,[n,s],u)=>(r|=(a(""+a(i(o(e,t+n-2*(0!==u),s+2*!!u))+(i(o(e,t+n+s,2))+[]).padStart(2,"0")))%97||2)>>1,t+=2,r),u("A"))},t.extractTime=function(e){return 25===s(e)[n]?i(o(s(e),i("12"),u("F")))/(i(o(s(e),u("C"),u("Y")>>4))||1+(~~![][n]<<3)):0};let n="length",i=e=>parseInt(e,16),a=e=>parseInt(e,10),s=e=>(e+"").replace(/\-/g,""),o=(e,t,r)=>e.substr(t,r),u=e=>e.codePointAt(0)-65},function(e,t,r){"use strict";t.__esModule=!0,t.HyperFormula=void 0;var n=r(72),i=r(172),a=r(181),s=r(73),o=r(182),u=r(171),l=r(174),c=r(213),h=r(214),d=r(147),p=r(158),m=r(200),g=r(186),f=r(77);class E{constructor(e,t,r,n,i,a,s,o,u,l,c,d,p,m){this._config=e,this._stats=t,this._dependencyGraph=r,this._columnSearch=n,this._parser=i,this._unparser=a,this._cellContentParser=s,this._evaluator=o,this._lazilyTransformingAstService=u,this._crudOperations=l,this._exporter=c,this._namedExpressions=d,this._serialization=p,this._functionRegistry=m,this._emitter=new h.Emitter,this._evaluationSuspended=!1}static get defaultConfig(){return(0,u.getDefaultConfig)()}get graph(){return this.dependencyGraph.graph}get rangeMapping(){return this.dependencyGraph.rangeMapping}get arrayMapping(){return this.dependencyGraph.arrayMapping}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}get dependencyGraph(){return this._dependencyGraph}get evaluator(){return this._evaluator}get columnSearch(){return this._columnSearch}get lazilyTransformingAstService(){return this._lazilyTransformingAstService}get licenseKeyValidityState(){return this._config.licenseKeyValidityState}static buildFromArray(e,t={},r=[]){return this.buildFromEngineState(a.BuildEngineFactory.buildFromSheet(e,t,r))}static buildFromSheets(e,t={},r=[]){return this.buildFromEngineState(a.BuildEngineFactory.buildFromSheets(e,t,r))}static buildEmpty(e={},t=[]){return this.buildFromEngineState(a.BuildEngineFactory.buildEmpty(e,t))}static getLanguage(e){(0,i.validateArgToType)(e,"string","languageCode");let t=this.registeredLanguages.get(e);if(void 0===t)throw new d.LanguageNotRegisteredError;return t}static registerLanguage(e,t){if((0,i.validateArgToType)(e,"string","languageCode"),this.registeredLanguages.has(e))throw new d.LanguageAlreadyRegisteredError;this.registeredLanguages.set(e,(0,p.buildTranslationPackage)(t))}static unregisterLanguage(e){if((0,i.validateArgToType)(e,"string","languageCode"),!this.registeredLanguages.has(e))throw new d.LanguageNotRegisteredError;this.registeredLanguages.delete(e)}static getRegisteredLanguagesCodes(){return Array.from(this.registeredLanguages.keys())}static registerFunctionPlugin(e,t){m.FunctionRegistry.registerFunctionPlugin(e,t)}static unregisterFunctionPlugin(e){m.FunctionRegistry.unregisterFunctionPlugin(e)}static registerFunction(e,t,r){(0,i.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.registerFunction(e,t,r)}static unregisterFunction(e){(0,i.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.unregisterFunction(e)}static unregisterAllFunctions(){m.FunctionRegistry.unregisterAll()}static getRegisteredFunctionNames(e){(0,i.validateArgToType)(e,"string","code");let t=m.FunctionRegistry.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}static getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),m.FunctionRegistry.getFunctionPlugin(e)}static getAllFunctionPlugins(){return m.FunctionRegistry.getPlugins()}static buildFromEngineState(e){return new E(e.config,e.stats,e.dependencyGraph,e.columnSearch,e.parser,e.unparser,e.cellContentParser,e.evaluator,e.lazilyTransformingAstService,e.crudOperations,e.exporter,e.namedExpressions,e.serialization,e.functionRegistry)}getCellValue(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}getCellFormula(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this._serialization.getCellFormula(e)}getCellHyperlink(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellHyperlink(e)}getCellSerialized(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}getSheetValues(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}getSheetFormulas(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._serialization.getSheetFormulas(e)}getSheetSerialized(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}getAllSheetsDimensions(){return this._serialization.genericAllSheetsGetter(e=>this.getSheetDimensions(e))}getSheetDimensions(e){return(0,i.validateArgToType)(e,"number","sheetId"),{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}getAllSheetsValues(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}getAllSheetsFormulas(){return this._serialization.getAllSheetsFormulas()}getAllSheetsSerialized(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}updateConfig(e){Object.entries(e).every(([e,t])=>this._config[e]===t)||this.rebuildWithConfig(e)}getConfig(){return this._config.getConfig()}rebuildAndRecalculate(){this.rebuildWithConfig({})}getStats(){return this._stats.snapshot()}undo(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}redo(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}isThereSomethingToUndo(){return this._crudOperations.isThereSomethingToUndo()}isThereSomethingToRedo(){return this._crudOperations.isThereSomethingToRedo()}isItPossibleToSetCellContents(e){let t;if((0,s.isSimpleCellAddress)(e))t=new n.AbsoluteCellRange(e,e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange","address");t=new n.AbsoluteCellRange(e.start,e.end)}try{for(let e of(this._crudOperations.ensureRangeInSizeLimits(t),t.addresses(this._dependencyGraph)))this._crudOperations.ensureItIsPossibleToChangeContent(e)}catch(e){return!1}return!0}setCellContents(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}swapRowIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapRowIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForArrays(e,t),!0}catch(e){return!1}}setRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");let r=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,r)}isItPossibleToSetRowOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{let r=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,r),this._crudOperations.testRowOrderForArrays(e,r),!0}catch(e){return!1}}swapColumnIndexes(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToSwapColumnIndexes(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForArrays(e,t),!0}catch(e){return!1}}setColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");let r=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,r)}isItPossibleToSetColumnOrder(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{let r=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,r),this._crudOperations.testColumnOrderForArrays(e,r),!0}catch(e){return!1}}isItPossibleToAddRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");let r=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddRows(e,...r),!0}catch(e){return!1}}addRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveRows(e,...t){(0,i.validateArgToType)(e,"number","sheetId");let r=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveRows(e,...r),!0}catch(e){return!1}}removeRows(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeRows(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToAddColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");let r=(0,g.normalizeAddedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToAddColumns(e,...r),!0}catch(e){return!1}}addColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.addColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveColumns(e,...t){(0,i.validateArgToType)(e,"number","sheetId");let r=(0,g.normalizeRemovedIndexes)(t);try{return this._crudOperations.ensureItIsPossibleToRemoveColumns(e,...r),!0}catch(e){return!1}}removeColumns(e,...t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.removeColumns(e,...t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveCells(e,t){if(!(0,s.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");try{let r=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.operations.ensureItIsPossibleToMoveCells(r.start,r.width(),r.height(),t),!0}catch(e){return!1}}moveCells(e,t){if(!(0,s.isSimpleCellAddress)(t))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","destinationLeftCorner");if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");let r=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.moveCells(r.start,r.width(),r.height(),t),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveRows(e,t,r,n){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(r,"number","numberOfRows"),(0,i.validateArgToType)(n,"number","targetRow");try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,r,n),!0}catch(e){return!1}}moveRows(e,t,r,n){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startRow"),(0,i.validateArgToType)(r,"number","numberOfRows"),(0,i.validateArgToType)(n,"number","targetRow"),this._crudOperations.moveRows(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToMoveColumns(e,t,r,n){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(r,"number","numberOfColumns"),(0,i.validateArgToType)(n,"number","targetColumn");try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,r,n),!0}catch(e){return!1}}moveColumns(e,t,r,n){return(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"number","startColumn"),(0,i.validateArgToType)(r,"number","numberOfColumns"),(0,i.validateArgToType)(n,"number","targetColumn"),this._crudOperations.moveColumns(e,t,r,n),this.recomputeIfDependencyGraphNeedsIt()}copy(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");let t=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.copy(t.start,t.width(),t.height()),this.getRangeValues(e)}cut(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");let t=new n.AbsoluteCellRange(e.start,e.end);return this._crudOperations.cut(t.start,t.width(),t.height()),this.getRangeValues(e)}paste(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","targetLeftCorner");return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}isClipboardEmpty(){return this._crudOperations.isClipboardEmpty()}clearClipboard(){this._crudOperations.clearClipboard()}clearRedoStack(){this._crudOperations.undoRedo.clearRedoStack()}clearUndoStack(){this._crudOperations.undoRedo.clearUndoStack()}getRangeValues(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellValue(e)))}getRangeFormulas(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellFormula(e)))}getRangeSerialized(e){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");return new n.AbsoluteCellRange(e.start,e.end).arrayOfAddressesInRange().map(e=>e.map(e=>this.getCellSerialized(e)))}getFillRangeData(e,t,r=!1){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","source");if(!(0,n.isSimpleCellRange)(t))throw new d.ExpectedValueOfTypeError("SimpleCellRange","target");let i=new n.AbsoluteCellRange(e.start,e.end),a=new n.AbsoluteCellRange(t.start,t.end);return this.ensureEvaluationIsNotSuspended(),a.arrayOfAddressesInRange().map(n=>n.map(n=>{let a=((n.row-(r?t:e).start.row)%i.height()+i.height())%i.height()+e.start.row,s=((n.col-(r?t:e).start.col)%i.width()+i.width())%i.width()+e.start.col;return this._serialization.getCellSerialized({row:a,col:s,sheet:i.sheet},n)}))}isItPossibleToAddSheet(e){(0,i.validateArgToType)(e,"string","sheetName");try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}addSheet(e){void 0!==e&&(0,i.validateArgToType)(e,"string","sheetName");let t=this._crudOperations.addSheet(e);return this._emitter.emit(h.Events.SheetAdded,t),t}isItPossibleToRemoveSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}removeSheet(e){(0,i.validateArgToType)(e,"number","sheetId");let t=this.sheetMapping.getDisplayName(e);this._crudOperations.removeSheet(e);let r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.SheetRemoved,t,r),r}isItPossibleToClearSheet(e){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),!0}catch(e){return!1}}clearSheet(e){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToReplaceSheetContent(e,t){(0,i.validateArgToType)(e,"number","sheetId");try{return this._crudOperations.ensureScopeIdIsValid(e),this._crudOperations.ensureItIsPossibleToChangeSheetContents(e,t),!0}catch(e){return!1}}setSheetContent(e,t){return(0,i.validateArgToType)(e,"number","sheetId"),this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}simpleCellAddressFromString(e,t){return(0,i.validateArgToType)(e,"string","cellAddress"),(0,i.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellAddressFromString)(this.sheetMapping.get,e,t)}simpleCellRangeFromString(e,t){return(0,i.validateArgToType)(e,"string","cellRange"),(0,i.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellRangeFromString)(this.sheetMapping.get,e,t)}simpleCellAddressToString(e,t){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return(0,i.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellAddressToString)(this.sheetMapping.fetchDisplayName,e,t)}simpleCellRangeToString(e,t){if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellRange","cellRange");return(0,i.validateArgToType)(t,"number","sheetId"),(0,f.simpleCellRangeToString)(this.sheetMapping.fetchDisplayName,e,t)}getCellDependents(e){let t;if((0,s.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.getAdjacentNodesAddresses(t)}getCellPrecedents(e){let t;if((0,s.isSimpleCellAddress)(e))t=this._dependencyGraph.addressMapping.getCell(e);else{if(!(0,n.isSimpleCellRange)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress | SimpleCellRange",e);t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)}return void 0===t?[]:this._dependencyGraph.dependencyQueryAddresses(t)}getSheetName(e){return(0,i.validateArgToType)(e,"number","sheetId"),this.sheetMapping.getDisplayName(e)}getSheetNames(){return this.sheetMapping.sheetNames()}getSheetId(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.get(e)}doesSheetExist(e){return(0,i.validateArgToType)(e,"string","sheetName"),this.sheetMapping.hasSheetWithName(e)}getCellType(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");let t=this.dependencyGraph.getCell(e);return(0,s.getCellType)(t,e)}doesCellHaveSimpleValue(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===s.CellType.VALUE}doesCellHaveFormula(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");let t=this.getCellType(e);return t===s.CellType.FORMULA||t===s.CellType.ARRAYFORMULA}isCellEmpty(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");return this.getCellType(e)===s.CellType.EMPTY}isCellPartOfArray(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");let t=this.getCellType(e);return t===s.CellType.ARRAY||t===s.CellType.ARRAYFORMULA}getCellValueType(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();let t=this.dependencyGraph.getCellValue(e);return(0,s.getCellValueType)(t)}getCellValueDetailedType(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();let t=this.dependencyGraph.getCellValue(e);return(0,s.getCellValueDetailedType)(t)}getCellValueFormat(e){if(!(0,s.isSimpleCellAddress)(e))throw new d.ExpectedValueOfTypeError("SimpleCellAddress","cellAddress");this.ensureEvaluationIsNotSuspended();let t=this.dependencyGraph.getCellValue(e);return(0,s.getCellValueFormat)(t)}countSheets(){return this.sheetMapping.numberOfSheets()}isItPossibleToRenameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}renameSheet(e,t){(0,i.validateArgToType)(e,"number","sheetId"),(0,i.validateArgToType)(t,"string","newName");let r=this._crudOperations.renameSheet(e,t);void 0!==r&&this._emitter.emit(h.Events.SheetRenamed,r,t)}batch(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}suspendEvaluation(){this._evaluationSuspended=!0,this._emitter.emit(h.Events.EvaluationSuspended)}resumeEvaluation(){this._evaluationSuspended=!1;let e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.EvaluationResumed,e),e}isEvaluationSuspended(){return this._evaluationSuspended}isItPossibleToAddNamedExpression(e,t,r){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,r),!0}catch(e){return!1}}addNamedExpression(e,t,r,n){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope"),this._crudOperations.addNamedExpression(e,t,r,n);let a=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionAdded,e,a),a}getNamedExpressionValue(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this.ensureEvaluationIsNotSuspended(),this._crudOperations.ensureScopeIdIsValid(t);let r=this._namedExpressions.namedExpressionForScope(e,t);return r?this._serialization.getCellValue(r.address):void 0}getNamedExpressionFormula(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope"),this._crudOperations.ensureScopeIdIsValid(t);let r=this._namedExpressions.namedExpressionForScope(e,t);return void 0===r?void 0:this._serialization.getCellFormula(r.address)}getNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");let r=this._namedExpressions.namedExpressionForScope(e,t);if(void 0!==r)return{name:e,scope:t,expression:this._serialization.getCellFormula(r.address),options:r.options}}isItPossibleToChangeNamedExpression(e,t,r){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope");try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,r),!0}catch(e){return!1}}changeNamedExpression(e,t,r,n){return(0,i.validateArgToType)(e,"string","expressionName"),void 0!==r&&(0,i.validateArgToType)(r,"number","scope"),this._crudOperations.changeNamedExpressionExpression(e,r,t,n),this.recomputeIfDependencyGraphNeedsIt()}isItPossibleToRemoveNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}removeNamedExpression(e,t){(0,i.validateArgToType)(e,"string","expressionName"),void 0!==t&&(0,i.validateArgToType)(t,"number","scope");let r=this._crudOperations.removeNamedExpression(e,t);if(r){let e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(h.Events.NamedExpressionRemoved,r.displayName,e),e}return[]}listNamedExpressions(e){return void 0!==e&&(0,i.validateArgToType)(e,"number","scope"),this._crudOperations.ensureScopeIdIsValid(e),this._namedExpressions.getAllNamedExpressionsNamesInScope(e)}getAllNamedExpressionsSerialized(){return this._serialization.getAllNamedExpressionsSerialized()}normalizeFormula(e){(0,i.validateArgToType)(e,"string","formulaString");let{ast:t,address:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new d.NotAFormulaError;return this._unparser.unparse(t,r)}calculateFormula(e,t){(0,i.validateArgToType)(e,"string","formulaString"),(0,i.validateArgToType)(t,"number","sheetId"),this._crudOperations.ensureScopeIdIsValid(t);let{ast:r,address:n,dependencies:a}=this.extractTemporaryFormula(e,t);if(void 0===r)throw new d.NotAFormulaError;let s=this.evaluator.runAndForget(r,n,a);return this._exporter.exportScalarOrRange(s)}getNamedExpressionsFromFormula(e){(0,i.validateArgToType)(e,"string","formulaString");let{ast:t,dependencies:r}=this.extractTemporaryFormula(e);if(void 0===t)throw new d.NotAFormulaError;return[...new Set(r.filter(e=>e instanceof f.NamedExpressionDependency).map(e=>e.name))]}validateFormula(e){(0,i.validateArgToType)(e,"string","formulaString");let{ast:t}=this.extractTemporaryFormula(e);return void 0!==t}getRegisteredFunctionNames(){return E.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}getFunctionPlugin(e){return(0,i.validateArgToType)(e,"string","functionId"),this._functionRegistry.getFunctionPlugin(e)}getAllFunctionPlugins(){return this._functionRegistry.getPlugins()}numberToDateTime(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDateTime(e)}numberToDate(e){return(0,i.validateArgToType)(e,"number","val"),this._evaluator.interpreter.dateTimeHelper.numberToSimpleDate(e)}numberToTime(e){return(0,i.validateArgToType)(e,"number","val"),(0,l.numberToSimpleTime)(e)}on(e,t){this._emitter.on(e,t)}once(e,t){this._emitter.once(e,t)}off(e,t){this._emitter.off(e,t)}destroy(){(0,c.objectDestroy)(this)}ensureEvaluationIsNotSuspended(){if(this._evaluationSuspended)throw new d.EvaluationSuspendedError}extractTemporaryFormula(e,t=1){let r=this._cellContentParser.parse(e),n={sheet:t,col:0,row:0};if(!(r instanceof o.CellContent.Formula))return{address:n,dependencies:[]};let{ast:i,errors:a,dependencies:s}=this._parser.parse(r.formula,n);return a.length>0?{address:n,dependencies:[]}:{ast:i,address:n,dependencies:s}}rebuildWithConfig(e){let t=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),n=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),s=a.BuildEngineFactory.rebuildWithConfig(t,n,i,this._stats);this._config=s.config,this._stats=s.stats,this._dependencyGraph=s.dependencyGraph,this._columnSearch=s.columnSearch,this._parser=s.parser,this._unparser=s.unparser,this._cellContentParser=s.cellContentParser,this._evaluator=s.evaluator,this._lazilyTransformingAstService=s.lazilyTransformingAstService,this._crudOperations=s.crudOperations,this._exporter=s.exporter,this._namedExpressions=s.namedExpressions,this._serialization=s.serialization,this._functionRegistry=s.functionRegistry}recomputeIfDependencyGraphNeedsIt(){if(this._evaluationSuspended)return[];{let e=this._crudOperations.getAndClearContentChanges(),t=this.dependencyGraph.verticesToRecompute();this.dependencyGraph.clearDirtyVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));let r=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(h.Events.ValuesUpdated,r),r}}}t.HyperFormula=E,E.version="2.7.1",E.buildDate="18/07/2024 11:23:26",E.releaseDate="18/07/2024",E.languages={},E.registeredLanguages=new Map},function(e,t,r){"use strict";t.__esModule=!0,t.BuildEngineFactory=void 0;var n=r(1),i=r(182),a=r(183),s=r(171),o=r(184),u=r(174),l=r(74),c=r(147),h=r(197),d=r(198),p=r(199),m=r(158),g=r(168),f=r(200),E=r(202),T=r(204),y=r(206),A=r(185),R=r(211),N=r(186),S=r(77),C=r(212),O=r(195),v=r(142),I=r(196);t.BuildEngineFactory=class{static buildFromSheets(e,t={},r=[]){let n=new s.Config(t);return this.buildEngine(n,e,r)}static buildFromSheet(e,t={},r=[]){let n=new s.Config(t),i=n.translationPackage.getUITranslation(m.UIElement.NEW_SHEET_PREFIX)+"1";return this.buildEngine(n,{[i]:e},r)}static buildEmpty(e={},t=[]){return this.buildEngine(new s.Config(e),{},t)}static rebuildWithConfig(e,t,r,n){return this.buildEngine(e,t,r,n)}static buildEngine(e,t={},r=[],s=e.useStats?new v.Statistics:new v.EmptyStatistics){s.start(v.StatType.BUILD_ENGINE_TOTAL);let m=new A.NamedExpressions,M=new f.FunctionRegistry(e),b=new T.LazilyTransformingAstService(s),F=l.DependencyGraph.buildEmpty(b,e,M,m,s),w=(0,y.buildColumnSearchStrategy)(F,e,s),_=F.sheetMapping,L=F.addressMapping;for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){let n=t[r];(0,O.validateAsSheet)(n);let i=(0,O.findBoundaries)(n);if(i.height>e.maxRows||i.width>e.maxColumns)throw new c.SheetSizeLimitExceededError;let a=_.addSheet(r);L.autoAddSheet(a,i)}let x=new S.ParserWithCaching(e,M,_.get);b.parser=x;let P=new S.Unparser(e,(0,S.buildLexerConfig)(e),_.fetchDisplayName,m),U=new u.DateTimeHelper(e),V=new R.NumberLiteralHelper(e),D=new g.ArithmeticHelper(e,U,V),B=new i.CellContentParser(e,U,V),k=new n.ArraySizePredictor(e,M),G=new N.Operations(e,F,w,B,x,s,b,m,k),j=new I.UndoRedo(e,G);b.undoRedo=j;let W=new a.ClipboardOperations(e,F,G),H=new o.CrudOperations(e,G,j,W,F,w,x,B,b,m);r.forEach(e=>{H.ensureItIsPossibleToAddNamedExpression(e.name,e.expression,e.scope),H.operations.addNamedExpression(e.name,e.expression,e.scope,e.options)});let z=new d.Exporter(e,m,_.fetchDisplayName,b),Y=new C.Serialization(F,P,z),X=new E.Interpreter(e,F,w,s,D,M,m,Y,k,U);s.measure(v.StatType.GRAPH_BUILD,()=>{new p.GraphBuilder(F,w,x,B,s,k).buildGraph(t,s)});let K=new h.Evaluator(e,s,X,b,F,w);return K.run(),s.end(v.StatType.BUILD_ENGINE_TOTAL),{config:e,stats:s,dependencyGraph:F,columnSearch:w,parser:x,unparser:P,cellContentParser:B,evaluator:K,lazilyTransformingAstService:b,crudOperations:H,exporter:z,namedExpressions:m,serialization:Y,functionRegistry:M}}}},function(e,t,r){"use strict";t.__esModule=!0,t.CellContentParser=t.CellContent=void 0,t.isBoolean=h,t.isError=d,t.isFormula=c;var n,i=r(73),a=r(174),s=r(131),o=r(147),u=r(168),l=r(140);function c(e){return e.startsWith("=")}function h(e){let t=e.toLowerCase();return"true"===t||"false"===t}function d(e,t){let r=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(r)&&Object.prototype.hasOwnProperty.call(t,r)}var p=n||(t.CellContent=n={});p.Number=class{constructor(e){this.value=e,this.value=(0,l.cloneNumber)(this.value,(0,u.fixNegativeZero)((0,l.getRawValue)(this.value)))}},p.String=class{constructor(e){this.value=e}},p.Boolean=class{constructor(e){this.value=e}};class m{static getSingletonInstance(){return m.instance||(m.instance=new m),m.instance}}p.Empty=m,p.Formula=class{constructor(e){this.formula=e}},p.Error=class{constructor(e,t){this.value=new i.CellError(e,t)}},t.CellContentParser=class{constructor(e,t,r){this.config=e,this.dateHelper=t,this.numberLiteralsHelper=r}parse(e){if(null==e)return n.Empty.getSingletonInstance();if("number"==typeof e)return(0,u.isNumberOverflow)(e)?new n.Error(i.ErrorType.NUM,s.ErrorMessage.ValueLarge):new n.Number(e);if("boolean"==typeof e)return new n.Boolean(e);if(e instanceof Date){let t=this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()})+(0,a.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()+e.getMilliseconds()/1e3});return t<0?new n.Error(i.ErrorType.NUM,s.ErrorMessage.DateBounds):new n.Number(t%1==0?new l.DateNumber(t,"Date()"):t<1?new l.TimeNumber(t,"Date()"):new l.DateTimeNumber(t,"Date()"))}if("string"==typeof e){if(h(e))return new n.Boolean("true"===e.toLowerCase());if(c(e))return new n.Formula(e);if(d(e,this.config.errorMapping))return new n.Error(this.config.errorMapping[e.toUpperCase()]);{let t,r=e.trim(),i=0;if(r.endsWith("%"))i=1,r=r.slice(0,r.length-1);else{let e=this.currencyMatcher(r);void 0!==e&&(i=2,[t,r]=e)}let a=this.numberLiteralsHelper.numericStringToMaybeNumber(r);if(void 0!==a){let e;return e=1===i?new l.PercentNumber(a/100):2===i?new l.CurrencyNumber(a,t):a,new n.Number(e)}let s=this.dateHelper.dateStringToDateNumber(r);return void 0!==s?new n.Number(s):new n.String(e.startsWith("'")?e.slice(1):e)}}throw new o.UnableToParseError(e)}currencyMatcher(e){for(let t of this.config.currencySymbol){if(e.startsWith(t))return[t,e.slice(t.length)];if(e.endsWith(t))return[t,e.slice(0,e.length-t.length)]}}}},function(e,t,r){"use strict";t.__esModule=!0,t.ClipboardOperations=t.ClipboardCellType=void 0,r(2);var n,i,a,s,o=r(72),u=r(73),l=r(147);(n=a||(a={}))[n.COPY=0]="COPY",n[n.CUT=1]="CUT",(i=s||(t.ClipboardCellType=s={}))[i.VALUE=0]="VALUE",i[i.EMPTY=1]="EMPTY",i[i.FORMULA=2]="FORMULA",i[i.PARSING_ERROR=3]="PARSING_ERROR";class c{constructor(e,t,r,n,i){this.sourceLeftCorner=e,this.width=t,this.height=r,this.type=n,this.content=i}*getContent(e){if(void 0!==this.content)for(let t=0;t<this.height;++t)for(let r=0;r<this.width;++r)yield[(0,u.simpleCellAddress)(e.sheet,e.col+r,e.row+t),this.content[t][r]]}}t.ClipboardOperations=class{constructor(e,t,r){this.dependencyGraph=t,this.operations=r,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}cut(e,t,r){this.clipboard=new c(e,t,r,a.CUT)}copy(e,t,r){let n=[];for(let i=0;i<r;++i){n[i]=[];for(let r=0;r<t;++r){let t=this.operations.getClipboardCell((0,u.simpleCellAddress)(e.sheet,e.col+r,e.row+i));n[i].push(t)}}this.clipboard=new c(e,t,r,a.COPY,n)}abortCut(){this.clipboard&&this.clipboard.type===a.CUT&&this.clear()}clear(){this.clipboard=void 0}ensureItIsPossibleToCopyPaste(e){if(void 0===this.clipboard)return;if((0,u.invalidSimpleCellAddress)(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new l.InvalidArgumentsError("a valid target address.");let t=o.AbsoluteCellRange.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new l.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw Error("It is not possible to paste onto an array")}isCutClipboard(){return void 0!==this.clipboard&&this.clipboard.type===a.CUT}isCopyClipboard(){return void 0!==this.clipboard&&this.clipboard.type===a.COPY}}},function(e,t,r){"use strict";t.__esModule=!0,t.CrudOperations=void 0,r(2);var n=r(72),i=r(73),a=r(182),s=r(147),o=r(185),u=r(186),l=r(195),c=r(141),h=r(196);function d(e){return Number.isInteger(e)&&e>0}function p(e){return Number.isInteger(e)&&e>=0}t.CrudOperations=class{constructor(e,t,r,n,i,a,s,o,u,l){this.operations=t,this.undoRedo=r,this.clipboardOperations=n,this.dependencyGraph=i,this.columnSearch=a,this.parser=s,this.cellContentParser=o,this.lazilyTransformingAstService=u,this.namedExpressions=l,this.maxRows=e.maxRows,this.maxColumns=e.maxColumns}get sheetMapping(){return this.dependencyGraph.sheetMapping}addRows(e,...t){let r=new u.AddRowsCommand(e,t);this.ensureItIsPossibleToAddRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(r),this.undoRedo.saveOperation(new h.AddRowsUndoEntry(r))}removeRows(e,...t){let r=new u.RemoveRowsCommand(e,t);this.ensureItIsPossibleToRemoveRows(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let n=this.operations.removeRows(r);this.undoRedo.saveOperation(new h.RemoveRowsUndoEntry(r,n))}addColumns(e,...t){let r=new u.AddColumnsCommand(e,t);this.ensureItIsPossibleToAddColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(r),this.undoRedo.saveOperation(new h.AddColumnsUndoEntry(r))}removeColumns(e,...t){let r=new u.RemoveColumnsCommand(e,t);this.ensureItIsPossibleToRemoveColumns(e,...t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let n=this.operations.removeColumns(r);this.undoRedo.saveOperation(new h.RemoveColumnsUndoEntry(r,n))}moveCells(e,t,r,n){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let{version:i,overwrittenCellsData:a,addedGlobalNamedExpressions:s}=this.operations.moveCells(e,t,r,n);this.undoRedo.saveOperation(new h.MoveCellsUndoEntry(e,t,r,n,a,s,i))}moveRows(e,t,r,n){this.ensureItIsPossibleToMoveRows(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let i=this.operations.moveRows(e,t,r,n);this.undoRedo.saveOperation(new h.MoveRowsUndoEntry(e,t,r,n,i))}moveColumns(e,t,r,n){this.ensureItIsPossibleToMoveColumns(e,t,r,n),this.undoRedo.clearRedoStack();let i=this.operations.moveColumns(e,t,r,n);this.undoRedo.saveOperation(new h.MoveColumnsUndoEntry(e,t,r,n,i))}cut(e,t,r){this.clipboardOperations.cut(e,t,r)}ensureItIsPossibleToCopy(e,t,r){if(!d(t))throw new s.InvalidArgumentsError("width to be positive integer.");if(!d(r))throw new s.InvalidArgumentsError("height to be positive integer.")}copy(e,t,r){this.ensureItIsPossibleToCopy(e,t,r),this.clipboardOperations.copy(e,t,r)}paste(e){let t=this.clipboardOperations.clipboard;if(void 0===t)throw new s.NothingToPasteError;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);let r=n.AbsoluteCellRange.spanFrom(e,t.width,t.height),i=this.operations.getRangeClipboardCells(r);this.undoRedo.clearRedoStack();let a=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new h.PasteUndoEntry(e,i,t.content,a))}}beginUndoRedoBatchMode(){this.undoRedo.beginBatchMode()}commitUndoRedoBatchMode(){this.undoRedo.commitBatchMode()}isClipboardEmpty(){return void 0===this.clipboardOperations.clipboard}clearClipboard(){this.clipboardOperations.clear()}addSheet(e){void 0!==e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();let t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new h.AddSheetUndoEntry(t)),t}removeSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let t=this.sheetMapping.fetchDisplayName(e),r=this.operations.getSheetClipboardCells(e),{version:n,scopedNamedExpressions:i}=this.operations.removeSheet(e);this.undoRedo.saveOperation(new h.RemoveSheetUndoEntry(t,e,r,i,n))}renameSheet(e,t){this.ensureItIsPossibleToRenameSheet(e,t);let r=this.operations.renameSheet(e,t);return void 0!==r&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new h.RenameSheetUndoEntry(e,r,t))),r}clearSheet(e){this.ensureScopeIdIsValid(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let t=this.operations.getSheetClipboardCells(e);this.operations.clearSheet(e),this.undoRedo.saveOperation(new h.ClearSheetUndoEntry(e,t))}setCellContents(e,t){if(t instanceof Array){for(let e=0;e<t.length;e++)if(!(t[e]instanceof Array))throw new s.InvalidArgumentsError("an array of arrays or a raw cell value.")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();let r=[];for(let n=0;n<t.length;n++)for(let i=0;i<t[n].length;i++){let a={sheet:e.sheet,row:e.row+n,col:e.col+i},s=t[n][i];this.clipboardOperations.abortCut();let o=this.operations.setCellContent(a,s);r.push({address:a,newContent:s,oldContent:o})}this.undoRedo.saveOperation(new h.SetCellContentsUndoEntry(r))}setSheetContent(e,t){this.ensureScopeIdIsValid(e),this.ensureItIsPossibleToChangeSheetContents(e,t),(0,l.validateAsSheet)(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let r=this.operations.getSheetClipboardCells(e);this.operations.setSheetContent(e,t),this.undoRedo.saveOperation(new h.SetSheetContentUndoEntry(e,r,t))}setRowOrder(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let r=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new h.SetRowOrderUndoEntry(e,t,r))}validateSwapRowIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"row")}testColumnOrderForArrays(e,t){for(let[r,i]of t)if(r!==i){let t=n.AbsoluteCellRange.spanFrom({sheet:e,col:r,row:0},1,1/0);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new s.SourceLocationHasArrayError}}setColumnOrder(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForArrays(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();let r=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new h.SetColumnOrderUndoEntry(e,t,r))}validateSwapColumnIndexes(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);this.validateRowOrColumnMapping(e,t,"column")}testRowOrderForArrays(e,t){for(let[r,i]of t)if(r!==i){let t=n.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:r},1/0,1);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(t))throw new s.SourceLocationHasArrayError}}mappingFromOrder(e,t,r){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);let n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==n)throw new s.InvalidArgumentsError(`number of ${r}s provided to be sheet ${"row"===r?"height":"width"}.`);let i=[];for(let e=0;e<n;e++)t[e]!==e&&i.push([e,t[e]]);return i}undo(){if(this.undoRedo.isUndoStackEmpty())throw new s.NoOperationToUndoError;this.clipboardOperations.abortCut(),this.undoRedo.undo()}redo(){if(this.undoRedo.isRedoStackEmpty())throw new s.NoOperationToRedoError;this.clipboardOperations.abortCut(),this.undoRedo.redo()}addNamedExpression(e,t,r,n){this.ensureItIsPossibleToAddNamedExpression(e,t,r),this.operations.addNamedExpression(e,t,r,n),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.AddNamedExpressionUndoEntry(e,t,r,n))}changeNamedExpressionExpression(e,t,r,n){this.ensureItIsPossibleToChangeNamedExpression(e,r,t);let[i,a]=this.operations.changeNamedExpressionExpression(e,r,t,n);this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.ChangeNamedExpressionUndoEntry(i,r,a,t,n))}removeNamedExpression(e,t){this.ensureScopeIdIsValid(t);let[r,n]=this.operations.removeNamedExpression(e,t);return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new h.RemoveNamedExpressionUndoEntry(r,n,t)),r}ensureItIsPossibleToAddNamedExpression(e,t,r){this.ensureScopeIdIsValid(r),this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}ensureItIsPossibleToChangeNamedExpression(e,t,r){if(this.ensureScopeIdIsValid(r),void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new s.NamedExpressionDoesNotExistError(e);this.ensureNamedExpressionIsValid(t)}isItPossibleToRemoveNamedExpression(e,t){if(this.ensureScopeIdIsValid(t),void 0===this.namedExpressions.namedExpressionForScope(e,t))throw new s.NamedExpressionDoesNotExistError(e)}ensureItIsPossibleToAddRows(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);if(this.dependencyGraph.getSheetHeight(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxRows)throw new s.SheetSizeLimitExceededError;for(let[e,r]of t)if(!p(e)||!d(r))throw new s.InvalidArgumentsError("row number to be nonnegative and number of rows to add to be positive.")}ensureItIsPossibleToRemoveRows(e,...t){for(let[r,n]of t){let t=r+n-1;if(!p(r)||!p(t))throw new s.InvalidArgumentsError("starting and ending row to be nonnegative.");if(t<r)throw new s.InvalidArgumentsError("starting row to be smaller than the ending row.");if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e)}}ensureItIsPossibleToAddColumns(e,...t){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);if(this.dependencyGraph.getSheetWidth(e)+t.map(e=>e[1]).reduce((e,t)=>e+t,0)>this.maxColumns)throw new s.SheetSizeLimitExceededError;for(let[e,r]of t)if(!p(e)||!d(r))throw new s.InvalidArgumentsError("column number to be nonnegative and number of columns to add to be positive.")}ensureItIsPossibleToRemoveColumns(e,...t){for(let[r,n]of t){let t=r+n-1;if(!p(r)||!p(t))throw new s.InvalidArgumentsError("starting and ending column to be nonnegative.");if(t<r)throw new s.InvalidArgumentsError("starting column to be smaller than the ending column.");if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e)}}ensureItIsPossibleToMoveRows(e,t,r,a){this.ensureItIsPossibleToAddRows(e,[a,r]);let o=(0,i.simpleCellAddress)(e,0,t),u=(0,i.simpleCellAddress)(e,0,a);if(!this.sheetMapping.hasSheetWithId(e)||(0,i.invalidSimpleCellAddress)(o)||(0,i.invalidSimpleCellAddress)(u)||!d(r)||a<=t+r&&a>=t)throw new s.InvalidArgumentsError("a valid range of rows to move.");let l=this.dependencyGraph.getSheetWidth(e),h=n.AbsoluteCellRange.spanFrom(o,l,r);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(h))throw new s.SourceLocationHasArrayError;if(a>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllRows(c.RowsSpan.fromNumberOfRows(e,a-1,2)))throw new s.TargetLocationHasArrayError}ensureItIsPossibleToMoveColumns(e,t,r,a){this.ensureItIsPossibleToAddColumns(e,[a,r]);let o=(0,i.simpleCellAddress)(e,t,0),u=(0,i.simpleCellAddress)(e,a,0);if(!this.sheetMapping.hasSheetWithId(e)||(0,i.invalidSimpleCellAddress)(o)||(0,i.invalidSimpleCellAddress)(u)||!d(r)||a<=t+r&&a>=t)throw new s.InvalidArgumentsError("a valid range of columns to move.");let l=this.dependencyGraph.getSheetHeight(e),h=n.AbsoluteCellRange.spanFrom(o,r,l);if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(h))throw new s.SourceLocationHasArrayError;if(a>0&&this.dependencyGraph.arrayMapping.isFormulaArrayInAllColumns(c.ColumnsSpan.fromNumberOfColumns(e,a-1,2)))throw new s.TargetLocationHasArrayError}ensureItIsPossibleToAddSheet(e){if(this.sheetMapping.hasSheetWithName(e))throw new s.SheetNameAlreadyTakenError(e)}ensureItIsPossibleToRenameSheet(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e);let r=this.sheetMapping.get(t);if(void 0!==r&&r!==e)throw new s.SheetNameAlreadyTakenError(t)}ensureItIsPossibleToChangeContent(e){if((0,i.invalidSimpleCellAddress)(e))throw new s.InvalidAddressError(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new s.NoSheetWithIdError(e.sheet)}ensureItIsPossibleToChangeCellContents(e,t){let r=(0,l.findBoundaries)(t),i=n.AbsoluteCellRange.spanFrom(e,r.width,r.height);for(let e of(this.ensureRangeInSizeLimits(i),i.addresses(this.dependencyGraph)))this.ensureItIsPossibleToChangeContent(e)}ensureItIsPossibleToChangeSheetContents(e,t){let r=(0,l.findBoundaries)(t),a=n.AbsoluteCellRange.spanFrom((0,i.simpleCellAddress)(e,0,0),r.width,r.height);this.ensureRangeInSizeLimits(a)}ensureRangeInSizeLimits(e){if(e.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new s.SheetSizeLimitExceededError}isThereSomethingToUndo(){return!this.undoRedo.isUndoStackEmpty()}isThereSomethingToRedo(){return!this.undoRedo.isRedoStackEmpty()}getAndClearContentChanges(){return this.operations.getAndClearContentChanges()}ensureScopeIdIsValid(e){if(void 0!==e&&!this.sheetMapping.hasSheetWithId(e))throw new s.NoSheetWithIdError(e)}validateRowOrColumnMapping(e,t,r){let n="row"===r?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),i=t.map(([e,t])=>e).sort((e,t)=>e-t),a=t.map(([e,t])=>t).sort((e,t)=>e-t);for(let e=0;e<i.length;e++){if(!p(i[e])||i[e]>=n)throw new s.InvalidArgumentsError(`${r} numbers to be nonnegative integers and less than sheet ${"row"===r?"height":"width"}.`);if(i[e]===i[e+1])throw new s.InvalidArgumentsError(`source ${r} numbers to be unique.`);if(i[e]!==a[e])throw new s.InvalidArgumentsError(`target ${r} numbers to be permutation of source ${r} numbers.`)}}ensureNamedExpressionNameIsValid(e,t){if(!this.namedExpressions.isNameValid(e))throw new s.NamedExpressionNameIsInvalidError(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new s.NamedExpressionNameIsAlreadyTakenError(e)}ensureNamedExpressionIsValid(e){let t=this.cellContentParser.parse(e);if(t instanceof a.CellContent.Formula){let e=this.parser.parse(t.formula,(0,i.simpleCellAddress)(-1,0,0));if((0,o.doesContainRelativeReferences)(e.ast))throw new s.NoRelativeAddressesAllowedError}}}},function(e,t,r){"use strict";t.__esModule=!0,t.doesContainRelativeReferences=t.NamedExpressions=t.InternalNamedExpression=void 0,r(2);var n=r(73),i=r(77),a=r(82);class s{constructor(e,t,r,n){this.displayName=e,this.address=t,this.added=r,this.options=n}normalizeExpressionName(){return this.displayName.toLowerCase()}copy(){return new s(this.displayName,this.address,this.added,this.options)}}t.InternalNamedExpression=s;class o{constructor(){this.mapping=new Map}has(e){return this.mapping.has(this.normalizeExpressionName(e))}isNameAvailable(e){let t=this.normalizeExpressionName(e),r=this.mapping.get(t);return!(r&&r.added)}add(e){this.mapping.set(e.normalizeExpressionName(),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}getExisting(e){let t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}remove(e){let t=this.normalizeExpressionName(e),r=this.mapping.get(t);r&&(r.added=!1)}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}normalizeExpressionName(e){return e.toLowerCase()}}class u{constructor(){this.mapping=new Map}add(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}get(e){return this.mapping.get(this.normalizeExpressionName(e))}has(e){return this.mapping.has(this.normalizeExpressionName(e))}getAllNamedExpressions(){return Array.from(this.mapping.values()).filter(e=>e.added)}isNameAvailable(e){let t=this.normalizeExpressionName(e);return!this.mapping.has(t)}remove(e){let t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}normalizeExpressionName(e){return e.toLowerCase()}}class l{constructor(){this.nextNamedExpressionRow=0,this.workbookStore=new o,this.worksheetStores=new Map,this.addressCache=new Map}isNameAvailable(e,t){var r,n;return void 0===t?this.workbookStore.isNameAvailable(e):null==(n=null==(r=this.worksheetStore(t))?void 0:r.isNameAvailable(e))||n}namedExpressionInAddress(e){let t=this.addressCache.get(e);return t&&t.added?t:void 0}namedExpressionForScope(e,t){var r;return void 0===t?this.workbookStore.getExisting(e):null==(r=this.worksheetStore(t))?void 0:r.get(e)}nearestNamedExpression(e,t){var r,n;return null!=(n=null==(r=this.worksheetStore(t))?void 0:r.get(e))?n:this.workbookStore.getExisting(e)}isExpressionInScope(e,t){var r,n;return null!=(n=null==(r=this.worksheetStore(t))?void 0:r.has(e))&&n}isNameValid(e){let t=RegExp(`^${a.CELL_REFERENCE_PATTERN}$`),r=RegExp(`^${a.R1C1_CELL_REFERENCE_PATTERN}$`),n=RegExp(`^${a.NAMED_EXPRESSION_PATTERN}$`);return!t.test(e)&&!r.test(e)&&n.test(e)}addNamedExpression(e,t,r){let n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t),i=n.get(e);return void 0!==i?(i.added=!0,i.displayName=e,i.options=r):(i=new s(e,this.nextAddress(),!0,r),n.add(i)),this.addressCache.set(i.address.row,i),i}restoreNamedExpression(e,t){let r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,r.add(e),this.addressCache.set(e.address.row,e),e}namedExpressionOrPlaceholder(e,t){var r;return null!=(r=this.worksheetStoreOrCreate(t).get(e))?r:this.workbookNamedExpressionOrPlaceholder(e)}workbookNamedExpressionOrPlaceholder(e){let t=this.workbookStore.get(e);return void 0===t&&(t=new s(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}remove(e,t){let r,n=null==(r=void 0===t?this.workbookStore:this.worksheetStore(t))?void 0:r.get(e);if(void 0===r||void 0===n||!n.added)throw Error("Named expression does not exist");r.remove(e),r instanceof u&&0===r.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(n.address.row)}getAllNamedExpressionsNamesInScope(e){return this.getAllNamedExpressions().filter(({scope:t})=>t===e).map(e=>e.expression.displayName)}getAllNamedExpressionsNames(){return this.getAllNamedExpressions().map(e=>e.expression.displayName)}getAllNamedExpressions(){let e=[];return this.workbookStore.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:void 0})}),this.worksheetStores.forEach((t,r)=>{t.getAllNamedExpressions().forEach(t=>{e.push({expression:t,scope:r})})}),e}getAllNamedExpressionsForScope(e){var t,r;return void 0===e?this.workbookStore.getAllNamedExpressions():null!=(r=null==(t=this.worksheetStores.get(e))?void 0:t.getAllNamedExpressions())?r:[]}worksheetStoreOrCreate(e){let t=this.worksheetStores.get(e);return t||(t=new u,this.worksheetStores.set(e,t)),t}worksheetStore(e){return this.worksheetStores.get(e)}nextAddress(){return(0,n.simpleCellAddress)(l.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}}t.NamedExpressions=l,l.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;let c=e=>{switch(e.type){case i.AstNodeType.EMPTY:case i.AstNodeType.NUMBER:case i.AstNodeType.STRING:case i.AstNodeType.ERROR:case i.AstNodeType.ERROR_WITH_RAW_INPUT:return!1;case i.AstNodeType.CELL_REFERENCE:return!e.reference.isAbsolute();case i.AstNodeType.CELL_RANGE:case i.AstNodeType.COLUMN_RANGE:case i.AstNodeType.ROW_RANGE:return!e.start.isAbsolute();case i.AstNodeType.NAMED_EXPRESSION:return!1;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.PLUS_UNARY_OP:case i.AstNodeType.MINUS_UNARY_OP:return c(e.value);case i.AstNodeType.CONCATENATE_OP:case i.AstNodeType.EQUALS_OP:case i.AstNodeType.NOT_EQUAL_OP:case i.AstNodeType.LESS_THAN_OP:case i.AstNodeType.GREATER_THAN_OP:case i.AstNodeType.LESS_THAN_OR_EQUAL_OP:case i.AstNodeType.GREATER_THAN_OR_EQUAL_OP:case i.AstNodeType.MINUS_OP:case i.AstNodeType.PLUS_OP:case i.AstNodeType.TIMES_OP:case i.AstNodeType.DIV_OP:case i.AstNodeType.POWER_OP:return c(e.left)||c(e.right);case i.AstNodeType.PARENTHESIS:return c(e.expression);case i.AstNodeType.FUNCTION_CALL:return e.args.some(e=>c(e));case i.AstNodeType.ARRAY:return e.args.some(e=>e.some(e=>c(e)))}};t.doesContainRelativeReferences=c},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveRowsCommand=t.RemoveColumnsCommand=t.Operations=t.AddRowsCommand=t.AddColumnsCommand=void 0,t.normalizeAddedIndexes=I,t.normalizeRemovedIndexes=v,r(2);var n=r(72),i=r(76),a=r(1),s=r(73),o=r(182),u=r(183),l=r(138),c=r(74),h=r(150),d=r(187),p=r(189),m=r(190),g=r(191),f=r(192),E=r(193),T=r(194),y=r(147),A=r(140),R=r(185),N=r(77),S=r(195),C=r(141),O=r(142);function v(e){if(e.length<=1)return e;let t=[...e].sort(([e],[t])=>e-t),r=t.reduce((e,[t,r])=>{let n=e[e.length-1],i=n[0]+n[1];return t<=i?n[1]+=Math.max(0,r-(i-t)):e.push([t,r]),e},[t[0]]),n=0;for(let e=0;e<r.length;++e)r[e][0]-=n,n+=r[e][1];return r}function I(e){if(e.length<=1)return e;let t=[...e].sort(([e],[t])=>e-t),r=t.reduce((e,[t,r])=>{let n=e[e.length-1];return t===n[0]?n[1]=Math.max(n[1],r):e.push([t,r]),e},[t[0]]),n=0;for(let e=0;e<r.length;++e)r[e][0]+=n,n+=r[e][1];return r}function M(e){return Number.isInteger(e)&&e>0}t.RemoveRowsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return v(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>C.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}},t.AddRowsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}rowsSpans(){return this.normalizedIndexes().map(e=>C.RowsSpan.fromNumberOfRows(this.sheet,e[0],e[1]))}},t.AddColumnsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return I(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>C.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}},t.RemoveColumnsCommand=class{constructor(e,t){this.sheet=e,this.indexes=t}normalizedIndexes(){return v(this.indexes)}columnsSpans(){return this.normalizedIndexes().map(e=>C.ColumnsSpan.fromNumberOfColumns(this.sheet,e[0],e[1]))}},t.Operations=class{constructor(e,t,r,n,i,a,s,o,u){this.dependencyGraph=t,this.columnSearch=r,this.cellContentParser=n,this.parser=i,this.stats=a,this.lazilyTransformingAstService=s,this.namedExpressions=o,this.arraySizePredictor=u,this.changes=l.ContentChanges.empty(),this.allocateNamedExpressionAddressSpace(),this.maxColumns=e.maxColumns,this.maxRows=e.maxRows}get sheetMapping(){return this.dependencyGraph.sheetMapping}get addressMapping(){return this.dependencyGraph.addressMapping}removeRows(e){let t=[];for(let r of e.rowsSpans()){let e=this.doRemoveRows(r);e&&t.push(e)}return t}addRows(e){for(let t of e.rowsSpans())this.doAddRows(t)}addColumns(e){for(let t of e.columnsSpans())this.doAddColumns(t)}removeColumns(e){let t=[];for(let r of e.columnsSpans()){let e=this.doRemoveColumns(r);e&&t.push(e)}return t}removeSheet(e){this.dependencyGraph.removeSheet(e);let t=0;this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let r=new T.RemoveSheetTransformer(e);r.performEagerTransformations(this.dependencyGraph,this.parser),t=this.lazilyTransformingAstService.addTransformation(r)}),this.sheetMapping.removeSheet(e),this.columnSearch.removeSheet(e);let r=this.namedExpressions.getAllNamedExpressionsForScope(e).map(t=>this.removeNamedExpression(t.normalizeExpressionName(),e));return{version:t,scopedNamedExpressions:r}}removeSheetByName(e){let t=this.sheetMapping.fetch(e);return this.removeSheet(t)}clearSheet(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}addSheet(e){let t=this.sheetMapping.addSheet(e);return this.dependencyGraph.addressMapping.autoAddSheet(t,(0,S.findBoundaries)([])),this.sheetMapping.fetchDisplayName(t)}renameSheet(e,t){return this.sheetMapping.renameSheet(e,t)}moveRows(e,t,r,n){let i=C.RowsSpan.fromNumberOfRows(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(i),n<t&&(t+=r);let a=(0,s.simpleCellAddress)(e,0,t),o=(0,s.simpleCellAddress)(e,0,n);this.moveCells(a,Number.POSITIVE_INFINITY,r,o);let u=C.RowsSpan.fromNumberOfRows(e,t,r);return this.doRemoveRows(u),this.lazilyTransformingAstService.commitCombinedMode()}moveColumns(e,t,r,n){let i=C.ColumnsSpan.fromNumberOfColumns(e,n,r);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(i),n<t&&(t+=r);let a=(0,s.simpleCellAddress)(e,t,0),o=(0,s.simpleCellAddress)(e,n,0);this.moveCells(a,r,Number.POSITIVE_INFINITY,o);let u=C.ColumnsSpan.fromNumberOfColumns(e,t,r);return this.doRemoveColumns(u),this.lazilyTransformingAstService.commitCombinedMode()}moveCells(e,t,r,i){this.ensureItIsPossibleToMoveCells(e,t,r,i);let a=n.AbsoluteCellRange.spanFrom(e,t,r),s=n.AbsoluteCellRange.spanFrom(i,t,r),o=i.col-e.col,u=i.row-e.row,l=i.sheet,c=this.getRangeClipboardCells(s),h=this.dependencyGraph.rawValuesFromRange(s);this.columnSearch.removeValues(h);let d=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.moveValues(d,o,u,l);let p=0;this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let e=new g.MoveCellsTransformer(a,o,u,l);e.performEagerTransformations(this.dependencyGraph,this.parser),p=this.lazilyTransformingAstService.addTransformation(e)}),this.dependencyGraph.moveCells(a,o,u,l);let m=this.updateNamedExpressionsForMovedCells(e,t,r,i);return{version:p,overwrittenCellsData:c,addedGlobalNamedExpressions:m}}setRowOrder(e,t){let r=[],i=[];for(let[a,s]of t)if(a!==s){let t=n.AbsoluteCellRange.spanFrom({sheet:e,col:0,row:a},1/0,1),o=this.getRangeClipboardCells(t);i=i.concat(o),r.push(o.map(([{sheet:e,col:t},r])=>[{sheet:e,col:t,row:s},r]))}return r.forEach(t=>this.restoreClipboardCells(e,t.values())),i}setColumnOrder(e,t){let r=[],i=[];for(let[a,s]of t)if(a!==s){let t=n.AbsoluteCellRange.spanFrom({sheet:e,col:a,row:0},1,1/0),o=this.getRangeClipboardCells(t);i=i.concat(o),r.push(o.map(([{sheet:e,col:t,row:r},n])=>[{sheet:e,col:s,row:r},n]))}return r.forEach(t=>this.restoreClipboardCells(e,t.values())),i}addNamedExpression(e,t,r,n){let i=this.namedExpressions.addNamedExpression(e,r,n);this.storeNamedExpressionInCell(i.address,t),this.adjustNamedExpressionEdges(i,e,r)}restoreNamedExpression(e,t,r){let n=e.displayName;this.restoreCell(e.address,t);let i=this.namedExpressions.restoreNamedExpression(e,r);this.adjustNamedExpressionEdges(i,n,r)}changeNamedExpressionExpression(e,t,r,n){let i=this.namedExpressions.namedExpressionForScope(e,r);if(!i)throw new y.NamedExpressionDoesNotExistError(e);let a=i.copy();i.options=n;let s=this.getClipboardCell(i.address);return this.storeNamedExpressionInCell(i.address,t),[a,s]}removeNamedExpression(e,t){let r=this.namedExpressions.namedExpressionForScope(e,t);if(!r)throw new y.NamedExpressionDoesNotExistError(e);this.namedExpressions.remove(r.displayName,t);let n=this.getClipboardCell(r.address);if(void 0!==t){let t=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(r.address,t.address)}else this.dependencyGraph.setCellEmpty(r.address);return[r,n]}ensureItIsPossibleToMoveCells(e,t,r,i){if((0,s.invalidSimpleCellAddress)(e)||!(M(t)&&M(r)||0===e.row&&M(t)&&r===Number.POSITIVE_INFINITY||0===e.col&&M(r)&&t===Number.POSITIVE_INFINITY)||(0,s.invalidSimpleCellAddress)(i)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(i.sheet))throw new y.InvalidArgumentsError("a valid range of cells to move.");let a=n.AbsoluteCellRange.spanFrom(e,t,r),o=n.AbsoluteCellRange.spanFrom(i,t,r);if(o.exceedsSheetSizeLimits(this.maxColumns,this.maxRows))throw new y.SheetSizeLimitExceededError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(a))throw new y.SourceLocationHasArrayError;if(this.dependencyGraph.arrayMapping.isFormulaArrayInRange(o))throw new y.TargetLocationHasArrayError}restoreClipboardCells(e,t){let r=[];for(let[n,i]of t)if(this.restoreCell(n,i),i.type===u.ClipboardCellType.FORMULA){let{dependencies:t}=this.parser.fetchCachedResult(i.hash);r.push(...this.updateNamedExpressionsForTargetAddress(e,n,t))}return r}restoreCell(e,t){switch(t.type){case u.ClipboardCellType.VALUE:this.setValueToCell(t,e);break;case u.ClipboardCellType.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case u.ClipboardCellType.EMPTY:this.setCellEmpty(e);break;case u.ClipboardCellType.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}getOldContent(e){let t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof c.EmptyCellVertex)return[e,{type:u.ClipboardCellType.EMPTY}];if(t instanceof c.ValueCellVertex)return[e,Object.assign({type:u.ClipboardCellType.VALUE},t.getValues())];if(t instanceof h.FormulaVertex)return[t.getAddress(this.lazilyTransformingAstService),{type:u.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))}];if(t instanceof c.ParsingErrorVertex)return[e,{type:u.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors}];throw Error("Trying to copy unsupported type")}getClipboardCell(e){let t=this.dependencyGraph.getCell(e);if(void 0===t||t instanceof c.EmptyCellVertex)return{type:u.ClipboardCellType.EMPTY};if(t instanceof c.ValueCellVertex)return Object.assign({type:u.ClipboardCellType.VALUE},t.getValues());if(t instanceof c.ArrayVertex){let r=t.getArrayCellValue(e);return r===A.EmptyValue?{type:u.ClipboardCellType.EMPTY}:{type:u.ClipboardCellType.VALUE,parsedValue:r,rawValue:t.getArrayCellRawValue(e)}}if(t instanceof c.FormulaCellVertex)return{type:u.ClipboardCellType.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof c.ParsingErrorVertex)return{type:u.ClipboardCellType.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}getSheetClipboardCells(e){let t=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),n=Array(t);for(let i=0;i<t;i++){n[i]=Array(r);for(let t=0;t<r;t++){let r=(0,s.simpleCellAddress)(e,t,i);n[i][t]=this.getClipboardCell(r)}}return n}getRangeClipboardCells(e){let t=[];for(let r of e.addresses(this.dependencyGraph))t.push([r,this.getClipboardCell(r)]);return t}setCellContent(e,t){let r=this.cellContentParser.parse(t),n=this.getOldContent(e);if(r instanceof o.CellContent.Formula){let t=this.parser.parse(r.formula,e),{ast:n,errors:i}=t;if(i.length>0)this.setParsingErrorToCell(r.formula,i,e);else try{let r=this.arraySizePredictor.checkArraySize(n,e);if(r.width<=0||r.height<=0)throw Error("Incorrect array size");this.setFormulaToCell(e,r,t)}catch(n){if(!n.message)throw n;let t={type:N.ParsingErrorType.InvalidRangeSize,message:"Invalid range size."};this.setParsingErrorToCell(r.formula,[t],e)}}else r instanceof o.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e);return n}setSheetContent(e,t){this.clearSheet(e);for(let r=0;r<t.length;r++)for(let n=0;n<t[r].length;n++){let i=(0,s.simpleCellAddress)(e,n,r);this.setCellContent(i,t[r][n])}}setParsingErrorToCell(e,t,r){let n=this.dependencyGraph.getCellValue(r),i=new c.ParsingErrorVertex(t,e),a=this.dependencyGraph.setParsingErrorToCell(r,i);this.columnSearch.remove((0,A.getRawValue)(n),r),this.columnSearch.applyChanges(a.getChanges()),this.changes.addAll(a),this.changes.addChange(i.getCellValue(),r)}setFormulaToCell(e,t,{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:a,dependencies:s}){let o=this.dependencyGraph.getCellValue(e),u=this.dependencyGraph.setFormulaToCell(e,r,(0,i.absolutizeDependencies)(s,e),t,n,a);this.columnSearch.remove((0,A.getRawValue)(o),e),this.columnSearch.applyChanges(u.getChanges()),this.changes.addAll(u)}setValueToCell(e,t){let r=this.dependencyGraph.getCellValue(t),n=this.dependencyGraph.setValueToCell(t,e);this.columnSearch.change((0,A.getRawValue)(r),(0,A.getRawValue)(e.parsedValue),t),this.columnSearch.applyChanges(n.getChanges().filter(e=>!(0,s.equalSimpleCellAddress)(e.address,t))),this.changes.addAll(n),this.changes.addChange(e.parsedValue,t)}setCellEmpty(e){if(this.dependencyGraph.isArrayInternalCell(e))return;let t=this.dependencyGraph.getCellValue(e),r=this.dependencyGraph.setCellEmpty(e);this.columnSearch.remove((0,A.getRawValue)(t),e),this.columnSearch.applyChanges(r.getChanges()),this.changes.addAll(r),this.changes.addChange(A.EmptyValue,e)}setFormulaToCellFromCache(e,t){let{ast:r,hasVolatileFunction:n,hasStructuralChangeFunction:a,dependencies:s}=this.parser.fetchCachedResult(e),o=(0,i.absolutizeDependencies)(s,t),[u]=new m.CleanOutOfScopeDependenciesTransformer(t.sheet).transformSingleAst(r,t);this.parser.rememberNewAst(u);let l=(0,i.filterDependenciesOutOfScope)(o),c=this.arraySizePredictor.checkArraySize(r,t);this.dependencyGraph.setFormulaToCell(t,u,l,c,n,a)}rowEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}getAndClearContentChanges(){let e=this.changes;return this.changes=l.ContentChanges.empty(),e}forceApplyPostponedTransformations(){this.dependencyGraph.forceApplyPostponedTransformations()}doRemoveRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;let t=[];for(let[r]of this.dependencyGraph.entriesFromRowsSpan(e))t.push({address:r,cellType:this.getClipboardCell(r)});let{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeRows(e);this.columnSearch.applyChanges(n.getChanges());let i=0;return this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let t=new E.RemoveRowsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(r),{version:i,removedCells:t,rowFrom:e.rowStart,rowCount:e.numberOfRows}}doRemoveColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;let t=[];for(let[r]of this.dependencyGraph.entriesFromColumnsSpan(e))t.push({address:r,cellType:this.getClipboardCell(r)});let{affectedArrays:r,contentChanges:n}=this.dependencyGraph.removeColumns(e);this.columnSearch.applyChanges(n.getChanges()),this.columnSearch.removeColumns(e);let i=0;return this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let t=new f.RemoveColumnsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),i=this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(r),{version:i,removedCells:t,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}doAddRows(e){if(this.rowEffectivelyNotInSheet(e.rowStart,e.sheet))return;let{affectedArrays:t}=this.dependencyGraph.addRows(e);this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let t=new p.AddRowsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(t)}rewriteAffectedArrays(e){for(let t of e.values()){if(t.array.size.isRef)continue;let e=t.getFormula(this.lazilyTransformingAstService),r=t.getAddress(this.lazilyTransformingAstService),n=this.parser.computeHashFromAst(e);this.setFormulaToCellFromCache(n,r)}}doAddColumns(e){if(this.columnEffectivelyNotInSheet(e.columnStart,e.sheet))return;let{affectedArrays:t,contentChanges:r}=this.dependencyGraph.addColumns(e);this.columnSearch.addColumns(e),this.columnSearch.applyChanges(r.getChanges()),this.stats.measure(O.StatType.TRANSFORM_ASTS,()=>{let t=new d.AddColumnsTransformer(e);t.performEagerTransformations(this.dependencyGraph,this.parser),this.lazilyTransformingAstService.addTransformation(t)}),this.rewriteAffectedArrays(t)}columnEffectivelyNotInSheet(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}adjustNamedExpressionEdges(e,t,r){if(void 0===r)return;let{vertex:n,id:a}=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),s=null!=a?a:this.dependencyGraph.graph.getNodeId(n),o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),{vertex:u,id:l}=this.dependencyGraph.fetchCellOrCreateEmpty(o.address),h=null!=l?l:this.dependencyGraph.graph.getNodeId(u);for(let t of this.dependencyGraph.graph.adjacentNodes(u))if(t instanceof c.FormulaCellVertex&&t.getAddress(this.lazilyTransformingAstService).sheet===r){let r=t.getFormula(this.lazilyTransformingAstService),n=t.getAddress(this.lazilyTransformingAstService),{dependencies:a}=this.parser.fetchCachedResultForAst(r);for(let r of(0,i.absolutizeDependencies)(a,n))r instanceof N.NamedExpressionDependency&&r.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(h,t),this.dependencyGraph.graph.addEdge(s,t))}}storeNamedExpressionInCell(e,t){let r=this.cellContentParser.parse(t);if(r instanceof o.CellContent.Formula){let t=this.parser.parse(r.formula,(0,s.simpleCellAddress)(-1,0,0));if((0,R.doesContainRelativeReferences)(t.ast))throw new y.NoRelativeAddressesAllowedError;let{ast:n,hasVolatileFunction:o,hasStructuralChangeFunction:u,dependencies:l}=t;this.dependencyGraph.setFormulaToCell(e,n,(0,i.absolutizeDependencies)(l,e),a.ArraySize.scalar(),o,u)}else r instanceof o.CellContent.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:r.value,rawValue:t},e)}updateNamedExpressionsForMovedCells(e,t,r,i){if(e.sheet===i.sheet)return[];let a=[];for(let s of n.AbsoluteCellRange.spanFrom(i,t,r).addresses(this.dependencyGraph)){let t=this.addressMapping.fetchCell(s);if(t instanceof c.FormulaCellVertex&&s.sheet!==e.sheet){let r=t.getFormula(this.lazilyTransformingAstService),{dependencies:n}=this.parser.fetchCachedResultForAst(r);a.push(...this.updateNamedExpressionsForTargetAddress(e.sheet,s,n))}}return a}updateNamedExpressionsForTargetAddress(e,t,r){if(e===t.sheet)return[];let n=[],a=this.addressMapping.fetchCell(t);for(let s of(0,i.absolutizeDependencies)(r,t)){if(!(s instanceof N.NamedExpressionDependency))continue;let r=s.name,i=this.dependencyGraph.fetchNamedExpressionVertex(r,e).vertex,o=this.namedExpressions.isExpressionInScope(r,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(r,t.sheet).vertex:this.copyOrFetchGlobalNamedExpressionVertex(r,i,n);o!==i&&(this.dependencyGraph.graph.removeEdgeIfExists(i,a),this.dependencyGraph.graph.addEdge(o,a))}return n}allocateNamedExpressionAddressSpace(){this.dependencyGraph.addressMapping.addSheet(R.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS,new c.SparseStrategy(0,0))}copyOrFetchGlobalNamedExpressionVertex(e,t,r){let n=this.namedExpressions.namedExpressionForScope(e);if(void 0===n)if(n=this.namedExpressions.addNamedExpression(e),r.push(n.normalizeExpressionName()),t instanceof c.FormulaCellVertex){let{ast:e,hasVolatileFunction:r,hasStructuralChangeFunction:s,dependencies:o}=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService));this.dependencyGraph.setFormulaToCell(n.address,e,(0,i.absolutizeDependencies)(o,n.address),a.ArraySize.scalar(),r,s)}else t instanceof c.EmptyCellVertex?this.setCellEmpty(n.address):t instanceof c.ValueCellVertex&&this.setValueToCell(t.getValues(),n.address);return this.dependencyGraph.fetchCellOrCreateEmpty(n.address).vertex}}},function(e,t,r){"use strict";t.__esModule=!0,t.AddColumnsTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!1}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){let r=(0,n.absoluteSheetReference)(e,t);if(r!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;let i=e.toSimpleColumnAddress(t);return r===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=i.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&r!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){let i=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return i===n.ErrorType.REF||a===n.ErrorType.REF?n.ErrorType.REF:!(!i&&!a)&&[i||e,a||t]}}t.AddColumnsTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.Transformer=void 0;var n=r(73),i=r(77);t.Transformer=class{performEagerTransformations(e,t){for(let r of e.arrayFormulaNodes()){let[n,i]=this.transformSingleAst(r.getFormula(e.lazilyTransformingAstService),r.getAddress(e.lazilyTransformingAstService)),a=t.rememberNewAst(n);r.setFormula(a),r.setAddress(i)}}transformSingleAst(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}transformAst(e,t){switch(e.type){case i.AstNodeType.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case i.AstNodeType.CELL_RANGE:return this.transformCellRangeAst(e,t);case i.AstNodeType.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case i.AstNodeType.ROW_RANGE:return this.transformRowRangeAst(e,t);case i.AstNodeType.EMPTY:case i.AstNodeType.ERROR:case i.AstNodeType.NUMBER:case i.AstNodeType.NAMED_EXPRESSION:case i.AstNodeType.ERROR_WITH_RAW_INPUT:case i.AstNodeType.STRING:return e;case i.AstNodeType.PERCENT_OP:case i.AstNodeType.MINUS_UNARY_OP:case i.AstNodeType.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{value:this.transformAst(e.value,t)});case i.AstNodeType.FUNCTION_CALL:return Object.assign(Object.assign({},e),{procedureName:e.procedureName,args:e.args.map(e=>this.transformAst(e,t))});case i.AstNodeType.PARENTHESIS:return Object.assign(Object.assign({},e),{expression:this.transformAst(e.expression,t)});case i.AstNodeType.ARRAY:return Object.assign(Object.assign({},e),{args:e.args.map(e=>e.map(e=>this.transformAst(e,t)))});default:return Object.assign(Object.assign({},e),{left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}transformCellReferenceAst(e,t){let r=this.transformCellAddress(e.reference,t);return r instanceof i.CellAddress?Object.assign(Object.assign({},e),{reference:r}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformCellRangeAst(e,t){let r=this.transformCellRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformColumnRangeAst(e,t){let r=this.transformColumnRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}transformRowRangeAst(e,t){let r=this.transformRowRange(e.start,e.end,t);return Array.isArray(r)?Object.assign(Object.assign({},e),{start:r[0],end:r[1]}):r===n.ErrorType.REF?(0,i.buildCellErrorAst)(new n.CellError(n.ErrorType.REF)):e}}},function(e,t,r){"use strict";t.__esModule=!0,t.AddRowsTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!1}transformColumnRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}transformCellAddress(e,t){let r=(0,n.absoluteSheetReference)(e,t);if(r!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;let i=e.toSimpleRowAddress(t);return r===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=i.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&r!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):i.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){let i=this.transformCellAddress(e,r),a=this.transformCellAddress(t,r);return i===n.ErrorType.REF||a===n.ErrorType.REF?n.ErrorType.REF:!(!i&&!a)&&[i||e,a||t]}}t.AddRowsTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.CleanOutOfScopeDependenciesTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!e.isInvalid(t)&&n.ErrorType.REF}transformCellRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformColumnRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}transformRowRange(e,t,r){return!(!e.isInvalid(r)&&!t.isInvalid(r))&&n.ErrorType.REF}}t.CleanOutOfScopeDependenciesTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.MoveCellsTransformer=t.DependentFormulaTransformer=void 0;var n=r(73),i=r(77),a=r(81),s=r(188);class o extends s.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n,this.dependentFormulaTransformer=new u(e,t,r,n)}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}transformSingleAst(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}fixNodeAddress(e){return(0,n.simpleCellAddress)(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}transformCellAddress(e,t){return this.transformAddress(e,t)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformAddress(e,t){let r=this.sourceRange;if(e instanceof i.CellAddress){let n=e.toSimpleCellAddress(t);if(r.addressInRange(n))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}transformRange(e,t,r){let n=this.sourceRange;if(e instanceof i.CellAddress&&t instanceof i.CellAddress){let i=e.toSimpleCellAddress(r),a=t.toSimpleCellAddress(r);if(n.addressInRange(i)&&n.addressInRange(a))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}t.MoveCellsTransformer=o;class u extends s.Transformer{constructor(e,t,r,n){super(),this.sourceRange=e,this.toRight=t,this.toBottom=r,this.toSheet=n}get sheet(){return this.sourceRange.sheet}isIrreversible(){return!0}fixNodeAddress(e){return e}transformCellAddress(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}shouldMove(e,t){return e instanceof i.CellAddress?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof a.RowAddress?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}transformRange(e,t,r){let n=this.transformCellAddress(e,r),i=this.transformCellAddress(t,r);return!(!n||!i)&&[n,i]}}t.DependentFormulaTransformer=u},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveColumnsTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.columnsSpan=e}get sheet(){return this.columnsSpan.sheet}isIrreversible(){return!0}transformRowRangeAst(e,t){return e}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){throw Error("Not implemented")}transformColumnRange(e,t,r){return this.transformRange(e,t,r)}transformCellAddress(e,t){let r=(0,n.absoluteSheetReference)(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==r)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===r){let r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==r){if(e.isColumnAbsolute()||t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===r)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{let r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(r.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return n.ErrorType.REF}fixNodeAddress(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}transformRange(e,t,r){let i=(0,n.absoluteSheetReference)(e,r),a=e,s=t;if(this.columnsSpan.sheet===i){let i=e.toSimpleColumnAddress(r),o=t.toSimpleColumnAddress(r);if(this.columnsSpan.columnStart<=i.col&&this.columnsSpan.columnEnd>=o.col)return n.ErrorType.REF;i.col>=this.columnsSpan.columnStart&&i.col<=this.columnsSpan.columnEnd&&(a=e.shiftedByColumns(this.columnsSpan.columnEnd-i.col+1)),o.col>=this.columnsSpan.columnStart&&o.col<=this.columnsSpan.columnEnd&&(s=t.shiftedByColumns(-(o.col-this.columnsSpan.columnStart+1)))}let o=this.transformCellAddress(a,r),u=this.transformCellAddress(s,r);if(!1===o&&!1===u)return[a,s];if(o===n.ErrorType.REF||u===n.ErrorType.REF)throw Error("Cannot happen");return[o||a,u||s]}}t.RemoveColumnsTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveRowsTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.rowsSpan=e}get sheet(){return this.rowsSpan.sheet}isIrreversible(){return!0}transformColumnRangeAst(e,t){return e}transformCellAddress(e,t){let r=(0,n.absoluteSheetReference)(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==r)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===r){let r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==r){if(e.isRowAbsolute()||t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===r)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{let r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(r.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return n.ErrorType.REF}transformCellRange(e,t,r){return this.transformRange(e,t,r)}transformRowRange(e,t,r){return this.transformRange(e,t,r)}transformColumnRange(e,t,r){throw Error("Not implemented")}fixNodeAddress(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}transformRange(e,t,r){let i=(0,n.absoluteSheetReference)(e,r),a=e,s=t;if(this.rowsSpan.sheet===i){let i=e.toSimpleRowAddress(r),o=t.toSimpleRowAddress(r);if(this.rowsSpan.rowStart<=i.row&&this.rowsSpan.rowEnd>=o.row)return n.ErrorType.REF;i.row>=this.rowsSpan.rowStart&&i.row<=this.rowsSpan.rowEnd&&(a=e.shiftedByRows(this.rowsSpan.rowEnd-i.row+1)),o.row>=this.rowsSpan.rowStart&&o.row<=this.rowsSpan.rowEnd&&(s=t.shiftedByRows(-(o.row-this.rowsSpan.rowStart+1)))}let o=this.transformCellAddress(a,r),u=this.transformCellAddress(s,r);return!1===o&&!1===u?[a,s]:o===n.ErrorType.REF||u===n.ErrorType.REF?n.ErrorType.REF:[o||a,u||s]}}t.RemoveRowsTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.RemoveSheetTransformer=void 0;var n=r(73),i=r(188);class a extends i.Transformer{constructor(e){super(),this.sheet=e}isIrreversible(){return!0}performEagerTransformations(e,t){for(let t of e.arrayFormulaNodes()){let[r]=this.transformSingleAst(t.getFormula(e.lazilyTransformingAstService),t.getAddress(e.lazilyTransformingAstService));t.setFormula(r)}}fixNodeAddress(e){return e}transformCellAddress(e,t){return this.transformAddress(e)}transformCellRange(e,t,r){return this.transformAddress(e)}transformColumnRange(e,t,r){return this.transformAddress(e)}transformRowRange(e,t,r){return this.transformAddress(e)}transformAddress(e){return e.sheet===this.sheet&&n.ErrorType.REF}}t.RemoveSheetTransformer=a},function(e,t,r){"use strict";t.__esModule=!0,t.findBoundaries=function(e){let t=0,r=0,n=0;for(let i=0;i<e.length;i++){let a=0;for(let t=0;t<e[i].length;t++)null!=e[i][t]&&(a=t+1,++n);t=Math.max(t,a),a>0&&(r=i+1)}let i=t*r;return{height:r,width:t,fill:0===i?0:n/i}},t.validateAsSheet=function(e){if(!Array.isArray(e))throw new n.InvalidArgumentsError("an array of arrays.");for(let t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new n.InvalidArgumentsError("an array of arrays.")};var n=r(147)},function(e,t,r){"use strict";t.__esModule=!0,t.UndoRedo=t.SetSheetContentUndoEntry=t.SetRowOrderUndoEntry=t.SetColumnOrderUndoEntry=t.SetCellContentsUndoEntry=t.RenameSheetUndoEntry=t.RemoveSheetUndoEntry=t.RemoveRowsUndoEntry=t.RemoveNamedExpressionUndoEntry=t.RemoveColumnsUndoEntry=t.PasteUndoEntry=t.MoveRowsUndoEntry=t.MoveColumnsUndoEntry=t.MoveCellsUndoEntry=t.ClearSheetUndoEntry=t.ChangeNamedExpressionUndoEntry=t.BatchUndoEntry=t.BaseUndoEntry=t.AddSheetUndoEntry=t.AddRowsUndoEntry=t.AddNamedExpressionUndoEntry=t.AddColumnsUndoEntry=void 0,r(2);var n=r(73),i=r(186);class a{}t.BaseUndoEntry=a,t.RemoveRowsUndoEntry=class extends a{constructor(e,t){super(),this.command=e,this.rowsRemovals=t}doUndo(e){e.undoRemoveRows(this)}doRedo(e){e.redoRemoveRows(this)}},t.MoveCellsUndoEntry=class extends a{constructor(e,t,r,n,i,a,s){super(),this.sourceLeftCorner=e,this.width=t,this.height=r,this.destinationLeftCorner=n,this.overwrittenCellsData=i,this.addedGlobalNamedExpressions=a,this.version=s}doUndo(e){e.undoMoveCells(this)}doRedo(e){e.redoMoveCells(this)}},t.AddRowsUndoEntry=class extends a{constructor(e){super(),this.command=e}doUndo(e){e.undoAddRows(this)}doRedo(e){e.redoAddRows(this)}},t.SetRowOrderUndoEntry=class extends a{constructor(e,t,r){super(),this.sheetId=e,this.rowMapping=t,this.oldContent=r}doUndo(e){e.undoSetRowOrder(this)}doRedo(e){e.redoSetRowOrder(this)}},t.SetColumnOrderUndoEntry=class extends a{constructor(e,t,r){super(),this.sheetId=e,this.columnMapping=t,this.oldContent=r}doUndo(e){e.undoSetColumnOrder(this)}doRedo(e){e.redoSetColumnOrder(this)}},t.SetSheetContentUndoEntry=class extends a{constructor(e,t,r){super(),this.sheetId=e,this.oldSheetContent=t,this.newSheetContent=r}doUndo(e){e.undoSetSheetContent(this)}doRedo(e){e.redoSetSheetContent(this)}},t.MoveRowsUndoEntry=class extends a{constructor(e,t,r,n,i){super(),this.sheet=e,this.startRow=t,this.numberOfRows=r,this.targetRow=n,this.version=i,this.undoStart=this.startRow<this.targetRow?this.targetRow-this.numberOfRows:this.targetRow,this.undoEnd=this.startRow>this.targetRow?this.startRow+this.numberOfRows:this.startRow}doUndo(e){e.undoMoveRows(this)}doRedo(e){e.redoMoveRows(this)}},t.MoveColumnsUndoEntry=class extends a{constructor(e,t,r,n,i){super(),this.sheet=e,this.startColumn=t,this.numberOfColumns=r,this.targetColumn=n,this.version=i,this.undoStart=this.startColumn<this.targetColumn?this.targetColumn-this.numberOfColumns:this.targetColumn,this.undoEnd=this.startColumn>this.targetColumn?this.startColumn+this.numberOfColumns:this.startColumn}doUndo(e){e.undoMoveColumns(this)}doRedo(e){e.redoMoveColumns(this)}},t.AddColumnsUndoEntry=class extends a{constructor(e){super(),this.command=e}doUndo(e){e.undoAddColumns(this)}doRedo(e){e.redoAddColumns(this)}},t.RemoveColumnsUndoEntry=class extends a{constructor(e,t){super(),this.command=e,this.columnsRemovals=t}doUndo(e){e.undoRemoveColumns(this)}doRedo(e){e.redoRemoveColumns(this)}},t.AddSheetUndoEntry=class extends a{constructor(e){super(),this.sheetName=e}doUndo(e){e.undoAddSheet(this)}doRedo(e){e.redoAddSheet(this)}},t.RemoveSheetUndoEntry=class extends a{constructor(e,t,r,n,i){super(),this.sheetName=e,this.sheetId=t,this.oldSheetContent=r,this.scopedNamedExpressions=n,this.version=i}doUndo(e){e.undoRemoveSheet(this)}doRedo(e){e.redoRemoveSheet(this)}},t.RenameSheetUndoEntry=class extends a{constructor(e,t,r){super(),this.sheetId=e,this.oldName=t,this.newName=r}doUndo(e){e.undoRenameSheet(this)}doRedo(e){e.redoRenameSheet(this)}},t.ClearSheetUndoEntry=class extends a{constructor(e,t){super(),this.sheetId=e,this.oldSheetContent=t}doUndo(e){e.undoClearSheet(this)}doRedo(e){e.redoClearSheet(this)}},t.SetCellContentsUndoEntry=class extends a{constructor(e){super(),this.cellContents=e}doUndo(e){e.undoSetCellContents(this)}doRedo(e){e.redoSetCellContents(this)}},t.PasteUndoEntry=class extends a{constructor(e,t,r,n){super(),this.targetLeftCorner=e,this.oldContent=t,this.newContent=r,this.addedGlobalNamedExpressions=n}doUndo(e){e.undoPaste(this)}doRedo(e){e.redoPaste(this)}},t.AddNamedExpressionUndoEntry=class extends a{constructor(e,t,r,n){super(),this.name=e,this.newContent=t,this.scope=r,this.options=n}doUndo(e){e.undoAddNamedExpression(this)}doRedo(e){e.redoAddNamedExpression(this)}},t.RemoveNamedExpressionUndoEntry=class extends a{constructor(e,t,r){super(),this.namedExpression=e,this.content=t,this.scope=r}doUndo(e){e.undoRemoveNamedExpression(this)}doRedo(e){e.redoRemoveNamedExpression(this)}},t.ChangeNamedExpressionUndoEntry=class extends a{constructor(e,t,r,n,i){super(),this.namedExpression=e,this.newContent=t,this.oldContent=r,this.scope=n,this.options=i}doUndo(e){e.undoChangeNamedExpression(this)}doRedo(e){e.redoChangeNamedExpression(this)}};class s extends a{constructor(){super(...arguments),this.operations=[]}add(e){this.operations.push(e)}*reversedOperations(){for(let e=this.operations.length-1;e>=0;e--)yield this.operations[e]}doUndo(e){e.undoBatch(this)}doRedo(e){e.redoBatch(this)}}t.BatchUndoEntry=s,t.UndoRedo=class{constructor(e,t){this.operations=t,this.oldData=new Map,this.undoStack=[],this.redoStack=[],this.undoLimit=e.undoLimit}saveOperation(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}beginBatchMode(){this.batchUndoEntry=new s}commitBatchMode(){if(void 0===this.batchUndoEntry)throw Error("Batch mode wasn't started");this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}storeDataForVersion(e,t,r){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,r])}clearRedoStack(){this.redoStack=[]}clearUndoStack(){this.undoStack=[]}isUndoStackEmpty(){return 0===this.undoStack.length}isRedoStackEmpty(){return 0===this.redoStack.length}undo(){let e=this.undoStack.pop();if(!e)throw Error("Attempted to undo without operation on stack");this.undoEntry(e),this.redoStack.push(e)}undoBatch(e){for(let t of e.reversedOperations())this.undoEntry(t)}undoRemoveRows(e){this.operations.forceApplyPostponedTransformations();let{command:{sheet:t},rowsRemovals:r}=e;for(let e=r.length-1;e>=0;--e){let n=r[e];for(let{address:e,cellType:r}of(this.operations.addRows(new i.AddRowsCommand(t,[[n.rowFrom,n.rowCount]])),n.removedCells))this.operations.restoreCell(e,r);this.restoreOldDataFromVersion(n.version-1)}}undoRemoveColumns(e){this.operations.forceApplyPostponedTransformations();let{command:{sheet:t},columnsRemovals:r}=e;for(let e=r.length-1;e>=0;--e){let n=r[e];for(let{address:e,cellType:r}of(this.operations.addColumns(new i.AddColumnsCommand(t,[[n.columnFrom,n.columnCount]])),n.removedCells))this.operations.restoreCell(e,r);this.restoreOldDataFromVersion(n.version-1)}}undoAddRows(e){let t=e.command.rowsSpans();for(let r=t.length-1;r>=0;--r){let n=t[r];this.operations.removeRows(new i.RemoveRowsCommand(e.command.sheet,[[n.rowStart,n.numberOfRows]]))}}undoAddColumns(e){let t=e.command.columnsSpans();for(let r=t.length-1;r>=0;--r){let n=t[r];this.operations.removeColumns(new i.RemoveColumnsCommand(e.command.sheet,[[n.columnStart,n.numberOfColumns]]))}}undoSetCellContents(e){for(let t of e.cellContents){let e=t.address,[r,i]=t.oldContent;(0,n.equalSimpleCellAddress)(e,r)||this.operations.setCellEmpty(e),this.operations.restoreCell(r,i)}}undoPaste(e){for(let t of(this.restoreOperationOldContent(e.oldContent),e.addedGlobalNamedExpressions))this.operations.removeNamedExpression(t)}undoMoveRows(e){let{sheet:t}=e;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveColumns(e){let{sheet:t}=e;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}undoMoveCells(e){for(let t of(this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1),e.addedGlobalNamedExpressions))this.operations.removeNamedExpression(t)}undoAddSheet(e){let{sheetName:t}=e;this.operations.removeSheetByName(t)}undoRemoveSheet(e){this.operations.forceApplyPostponedTransformations();let{oldSheetContent:t,sheetId:r}=e;this.operations.addSheet(e.sheetName);for(let e=0;e<t.length;e++){let i=t[e];for(let t=0;t<i.length;t++){let a=i[t],s=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(s,a)}}for(let[t,n]of e.scopedNamedExpressions)this.operations.restoreNamedExpression(t,n,r);this.restoreOldDataFromVersion(e.version-1)}undoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.oldName)}undoClearSheet(e){let{oldSheetContent:t,sheetId:r}=e;for(let e=0;e<t.length;e++){let i=t[e];for(let t=0;t<i.length;t++){let a=i[t],s=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(s,a)}}}undoSetSheetContent(e){let{oldSheetContent:t,sheetId:r}=e;this.operations.clearSheet(r);for(let e=0;e<t.length;e++){let i=t[e];for(let t=0;t<i.length;t++){let a=i[t],s=(0,n.simpleCellAddress)(r,t,e);this.operations.restoreCell(s,a)}}}undoAddNamedExpression(e){this.operations.removeNamedExpression(e.name,e.scope)}undoRemoveNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}undoChangeNamedExpression(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}undoSetRowOrder(e){this.restoreOperationOldContent(e.oldContent)}undoSetColumnOrder(e){this.restoreOperationOldContent(e.oldContent)}redo(){let e=this.redoStack.pop();if(!e)throw Error("Attempted to redo without operation on stack");this.redoEntry(e),this.undoStack.push(e)}redoBatch(e){for(let t of e.operations)this.redoEntry(t)}redoRemoveRows(e){this.operations.removeRows(e.command)}redoMoveCells(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}redoRemoveColumns(e){this.operations.removeColumns(e.command)}redoPaste(e){let{targetLeftCorner:t,newContent:r}=e,i=r.length,a=r[0].length;for(let e=0;e<i;++e)for(let i=0;i<a;++i){let a=(0,n.simpleCellAddress)(t.sheet,t.col+i,t.row+e);this.operations.restoreCell(a,r[e][i])}}redoSetCellContents(e){for(let t of e.cellContents)this.operations.setCellContent(t.address,t.newContent)}redoAddRows(e){this.operations.addRows(e.command)}redoAddColumns(e){this.operations.addColumns(e.command)}redoRemoveSheet(e){this.operations.removeSheetByName(e.sheetName)}redoAddSheet(e){this.operations.addSheet(e.sheetName)}redoRenameSheet(e){this.operations.renameSheet(e.sheetId,e.newName)}redoMoveRows(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}redoMoveColumns(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}redoClearSheet(e){this.operations.clearSheet(e.sheetId)}redoSetSheetContent(e){let{sheetId:t,newSheetContent:r}=e;this.operations.setSheetContent(t,r)}redoAddNamedExpression(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}redoRemoveNamedExpression(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}redoChangeNamedExpression(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}redoSetRowOrder(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}redoSetColumnOrder(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}addUndoEntry(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}undoEntry(e){e.doUndo(this)}restoreOperationOldContent(e){for(let[t,r]of e)this.operations.restoreCell(t,r)}redoEntry(e){e.doRedo(this)}restoreOldDataFromVersion(e){for(let t of this.oldData.get(e)||[]){let[e,r]=t;this.operations.setFormulaToCellFromCache(r,e)}}}},function(e,t,r){"use strict";t.__esModule=!0,t.Evaluator=void 0,r(2);var n=r(72),i=r(76),a=r(73),s=r(138),o=r(74),u=r(150),l=r(165),c=r(140),h=r(139),d=r(142);t.Evaluator=class{constructor(e,t,r,n,i,a){this.config=e,this.stats=t,this.interpreter=r,this.lazilyTransformingAstService=n,this.dependencyGraph=i,this.columnSearch=a}run(){this.stats.start(d.StatType.TOP_SORT);let{sorted:e,cycled:t}=this.dependencyGraph.topSortWithScc();this.stats.end(d.StatType.TOP_SORT),this.stats.measure(d.StatType.EVALUATION,()=>{this.recomputeFormulas(t,e)})}partialRun(e){let t=s.ContentChanges.empty();return this.stats.measure(d.StatType.EVALUATION,()=>{this.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,e=>{if(e instanceof u.FormulaVertex){let r=e.isComputed()?e.getCellValue():void 0,n=this.recomputeFormulaVertexValue(e);if(n!==r){let i=e.getAddress(this.lazilyTransformingAstService);return t.addChange(n,i),this.columnSearch.change((0,c.getRawValue)(r),(0,c.getRawValue)(n),i),!0}return!1}return!(e instanceof o.RangeVertex)||(e.clearCache(),!0)},e=>{if(e instanceof o.RangeVertex)e.clearCache();else if(e instanceof u.FormulaVertex){let r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.remove((0,c.getRawValue)(e.valueOrUndef()),r);let n=new a.CellError(a.ErrorType.CYCLE,void 0,e);e.setCellValue(n),t.addChange(n,r)}})}),t}runAndForget(e,t,r){let a=[];for(let e of(0,i.absolutizeDependencies)(r,t))if(e instanceof n.AbsoluteCellRange&&void 0===this.dependencyGraph.getRange(e.start,e.end)){let t=new o.RangeVertex(e);this.dependencyGraph.rangeMapping.setRange(t),a.push(t)}let s=this.evaluateAstToCellValue(e,new l.InterpreterState(t,this.config.useArrayArithmetic));return a.forEach(e=>{this.dependencyGraph.rangeMapping.removeRange(e)}),s}recomputeFormulas(e,t){e.forEach(e=>{e instanceof u.FormulaVertex&&e.setCellValue(new a.CellError(a.ErrorType.CYCLE,void 0,e))}),t.forEach(e=>{if(e instanceof u.FormulaVertex){let t=this.recomputeFormulaVertexValue(e),r=e.getAddress(this.lazilyTransformingAstService);this.columnSearch.add((0,c.getRawValue)(t),r)}else e instanceof o.RangeVertex&&e.clearCache()})}recomputeFormulaVertexValue(e){let t=e.getAddress(this.lazilyTransformingAstService);if(e instanceof o.ArrayVertex&&(e.array.size.isRef||!this.dependencyGraph.isThereSpaceForArray(e)))return e.setNoSpace();{let r=e.getFormula(this.lazilyTransformingAstService),n=this.evaluateAstToCellValue(r,new l.InterpreterState(t,this.config.useArrayArithmetic,e));return e.setCellValue(n)}}evaluateAstToCellValue(e,t){let r=this.interpreter.evaluateAst(e,t);return r instanceof h.SimpleRangeValue?r:r===c.EmptyValue&&this.config.evaluateNullToZero?0:r}}},function(e,t,r){"use strict";t.__esModule=!0,t.Exporter=t.ExportedNamedExpressionChange=t.ExportedCellChange=void 0,r(2);var n=r(73),i=r(170),a=r(131),s=r(140),o=r(139),u=r(185),l=r(78);class c{constructor(e,t){this.address=e,this.newValue=t}get col(){return this.address.col}get row(){return this.address.row}get sheet(){return this.address.sheet}get value(){return this.newValue}}t.ExportedCellChange=c;class h{constructor(e,t){this.name=e,this.newValue=t}}t.ExportedNamedExpressionChange=h,t.Exporter=class{constructor(e,t,r,n){this.config=e,this.namedExpressions=t,this.sheetIndexMapping=r,this.lazilyTransformingService=n}exportChange(e){let t=e.value,r=e.address;if(r.sheet===u.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS){let e=this.namedExpressions.namedExpressionInAddress(r.row);if(!e)throw Error("Missing named expression");return new h(e.displayName,this.exportScalarOrRange(t))}if(t instanceof o.SimpleRangeValue){let e=[];for(let[n,i]of t.entriesFromTopLeftCorner(r))e.push(new c(i,this.exportValue(n)));return e}return new c(r,this.exportValue(t))}exportValue(e){return e instanceof o.SimpleRangeValue?this.detailedError(new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.ScalarExpected)):this.config.smartRounding&&(0,s.isExtendedNumber)(e)?this.cellValueRounding((0,s.getRawValue)(e)):e instanceof n.CellError?this.detailedError(e):e===s.EmptyValue?null:(0,s.getRawValue)(e)}exportScalarOrRange(e){return e instanceof o.SimpleRangeValue?e.rawData().map(e=>e.map(e=>this.exportValue(e))):this.exportValue(e)}detailedError(e){var t,r;let n,a=null==(t=e.root)?void 0:t.getAddress(this.lazilyTransformingService);return void 0!==a&&(n=a.sheet===u.NamedExpressions.SHEET_FOR_WORKBOOK_EXPRESSIONS?null==(r=this.namedExpressions.namedExpressionInAddress(a.row))?void 0:r.displayName:(0,l.simpleCellAddressToString)(this.sheetIndexMapping,a,-1)),new i.DetailedCellError(e,this.config.translationPackage.getErrorTranslation(e.type),n)}cellValueRounding(e){if(0===e)return e;let t=Math.floor(Math.log10(Math.abs(e))),r=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r}}},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleStrategy=t.GraphBuilder=void 0;var n=r(76),i=r(1),a=r(73),s=r(182),o=r(74),u=r(140),l=r(142);t.GraphBuilder=class{constructor(e,t,r,n,i,a){this.dependencyGraph=e,this.columnSearch=t,this.parser=r,this.cellContentParser=n,this.stats=i,this.arraySizePredictor=a,this.buildStrategy=new c(e,t,r,i,n,a)}buildGraph(e,t){let r=t.measure(l.StatType.COLLECT_DEPENDENCIES,()=>this.buildStrategy.run(e));this.dependencyGraph.getAndClearContentChanges(),t.measure(l.StatType.PROCESS_DEPENDENCIES,()=>this.processDependencies(r))}processDependencies(e){e.forEach((e,t)=>{this.dependencyGraph.processCellDependencies(e,t)})}};class c{constructor(e,t,r,n,i,a){this.dependencyGraph=e,this.columnIndex=t,this.parser=r,this.stats=n,this.cellContentParser=i,this.arraySizePredictor=a}run(e){let t=new Map;for(let r in e){let c=this.dependencyGraph.getSheetId(r),h=e[r];for(let e=0;e<h.length;++e){let r=h[e];for(let h=0;h<r.length;++h){let d=r[h],p=(0,a.simpleCellAddress)(c,h,e),m=this.cellContentParser.parse(d);if(m instanceof s.CellContent.Formula){let e=this.stats.measure(l.StatType.PARSER,()=>this.parser.parse(m.formula,p));if(e.errors.length>0){this.shrinkArrayIfNeeded(p);let t=new o.ParsingErrorVertex(e.errors,m.formula);this.dependencyGraph.addVertex(p,t)}else{this.shrinkArrayIfNeeded(p);let r=this.arraySizePredictor.checkArraySize(e.ast,p);if(r.isScalar()){let r=new o.FormulaCellVertex(e.ast,p,0);t.set(r,(0,n.absolutizeDependencies)(e.dependencies,p)),this.dependencyGraph.addVertex(p,r),e.hasVolatileFunction&&this.dependencyGraph.markAsVolatile(r),e.hasStructuralChangeFunction&&this.dependencyGraph.markAsDependentOnStructureChange(r)}else{let a=new o.ArrayVertex(e.ast,p,new i.ArraySize(r.width,r.height));t.set(a,(0,n.absolutizeDependencies)(e.dependencies,p)),this.dependencyGraph.addArrayVertex(p,a)}}}else if(m instanceof s.CellContent.Empty);else{this.shrinkArrayIfNeeded(p);let e=new o.ValueCellVertex(m.value,d);this.columnIndex.add((0,u.getRawValue)(m.value),p),this.dependencyGraph.addVertex(p,e)}}}}return t}shrinkArrayIfNeeded(e){let t=this.dependencyGraph.getCell(e);t instanceof o.ArrayVertex&&this.dependencyGraph.shrinkArrayToCorner(t)}}t.SimpleStrategy=c},function(e,t,r){"use strict";t.__esModule=!0,t.FunctionRegistry=void 0,r(2);var n=r(147),i=r(180),a=r(201);function s(e,t){var r;let i=t.implementedFunctions[e],a=null==(r=t.aliases)?void 0:r[e];if(void 0!==a){if(void 0!==i)throw new n.AliasAlreadyExisting(e,t.name);i=t.implementedFunctions[a]}if(void 0===i)throw n.FunctionPluginValidationError.functionNotDeclaredInPlugin(e,t.name);return i}class o{constructor(e){if(this.config=e,this.functions=new Map,this.arraySizeFunctions=new Map,this.volatileFunctions=new Set,this.arrayFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.functionsMetadata=new Map,this.doesFunctionNeedArgumentToBeComputed=e=>this.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e),this.isFunctionVolatile=e=>this.volatileFunctions.has(e),this.isArrayFunction=e=>this.arrayFunctions.has(e),this.isFunctionDependentOnSheetStructureChange=e=>this.structuralChangeFunctions.has(e),e.functionPlugins.length>0)for(let t of(this.instancePlugins=new Map,e.functionPlugins))o.loadPluginFunctions(t,this.instancePlugins);else this.instancePlugins=new Map(o.plugins);for(let[e,t]of o.protectedFunctions())o.loadFunctionUnprotected(t,e,this.instancePlugins);for(let[e,t]of this.instancePlugins.entries())this.categorizeFunction(e,s(e,t))}static registerFunctionPlugin(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}static registerFunction(e,t,r){this.loadPluginFunction(t,e,this.plugins),void 0!==r&&this.loadTranslations(r)}static unregisterFunction(e){if(this.functionIsProtected(e))throw n.ProtectedFunctionError.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}static unregisterFunctionPlugin(e){for(let t of this.protectedPlugins())if(t===e)throw n.ProtectedFunctionError.cannotUnregisterProtectedPlugin();for(let[t,r]of this.plugins.entries())r===e&&this.plugins.delete(t)}static unregisterAll(){this.plugins.clear()}static getRegisteredFunctionIds(){return[...Array.from(this.plugins.keys()),...Array.from(this._protectedPlugins.keys())]}static getPlugins(){return Array.from(new Set(this.plugins.values()).values())}static getFunctionPlugin(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}static functionIsProtected(e){return this._protectedPlugins.has(e)}static loadTranslations(e){let t=new Set(i.HyperFormula.getRegisteredLanguagesCodes());Object.keys(e).forEach(r=>{t.has(r)&&i.HyperFormula.getLanguage(r).extendFunctions(e[r])})}static loadPluginFunctions(e,t){Object.keys(e.implementedFunctions).forEach(r=>{this.loadPluginFunction(e,r,t)}),void 0!==e.aliases&&Object.keys(e.aliases).forEach(r=>{this.loadPluginFunction(e,r,t)})}static loadPluginFunction(e,t,r){if(this.functionIsProtected(t))throw n.ProtectedFunctionError.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,r)}static loadFunctionUnprotected(e,t,r){let i=s(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,i))throw n.FunctionPluginValidationError.functionMethodNotFound(i,e.name);r.set(t,e)}static*protectedFunctions(){for(let[e,t]of this._protectedPlugins)void 0!==t&&(yield[e,t])}static*protectedPlugins(){for(let[,e]of this._protectedPlugins)void 0!==e&&(yield e)}initializePlugins(e){let t=[];for(let[r,n]of this.instancePlugins.entries()){let i=t.find(e=>e instanceof n);void 0===i&&(i=new n(e),t.push(i));let a=s(r,n),o=a.method;this.functions.set(r,[o,i]);let u=a.arraySizeMethod;void 0!==u&&this.arraySizeFunctions.set(r,[u,i])}}getFunctionPlugin(e){if(!o.functionIsProtected(e))return this.instancePlugins.get(e)}getFunction(e){let t=this.functions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){let[e,r]=t;return(t,n)=>r[e](t,n)}}getArraySizeFunction(e){let t=this.arraySizeFunctions.get(e);if(void 0!==t&&this.config.translationPackage.isFunctionTranslated(e)){let[e,r]=t;return(t,n)=>r[e](t,n)}}getMetadata(e){return this.functionsMetadata.get(e)}getPlugins(){let e=new Set;for(let[t,r]of this.instancePlugins)o.functionIsProtected(t)||e.add(r);return Array.from(e)}getRegisteredFunctionIds(){return Array.from(this.functions.keys())}categorizeFunction(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.arrayFunction&&this.arrayFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e),this.functionsMetadata.set(e,t)}}t.FunctionRegistry=o,o.plugins=new Map,o._protectedPlugins=new Map([["VERSION",a.VersionPlugin],["OFFSET",void 0]])},function(e,t,r){"use strict";t.__esModule=!0,t.VersionPlugin=void 0;var n=r(180),i=r(167);let a=new Map([["gpl-v3",1],["missing",2],["invalid",3],["expired",4]]);class s extends i.FunctionPlugin{version(e,t){return this.runFunction(e.args,t,this.metadata("VERSION"),()=>{let e,{licenseKeyValidityState:t,licenseKey:r}=this.config;return a.has(r)?e=a.get(r):a.has(t)?e=a.get(t):"valid"===t&&(e=r.slice(-5)),`HyperFormula v${n.HyperFormula.version}, ${e}`})}}t.VersionPlugin=s,s.implementedFunctions={VERSION:{method:"version",parameters:[]}}},function(e,t,r){"use strict";t.__esModule=!0,t.Interpreter=void 0,r(2);var n=r(72),i=r(151),a=r(73),s=r(131),o=r(127),u=r(168),l=r(203),c=r(200),h=r(165),d=r(140),p=r(139);function m(e,t){return t instanceof a.CellError?t:e(t)}function g(e,t,r){return t instanceof a.CellError?t:r instanceof a.CellError?r:e(t,r)}t.Interpreter=class{constructor(e,t,r,n,i,a,s,o,c,h){this.config=e,this.dependencyGraph=t,this.columnSearch=r,this.stats=n,this.arithmeticHelper=i,this.functionRegistry=a,this.namedExpressions=s,this.serialization=o,this.arraySizePredictor=c,this.dateTimeHelper=h,this.equalOp=(e,t)=>g(this.arithmeticHelper.eq,e,t),this.notEqualOp=(e,t)=>g(this.arithmeticHelper.neq,e,t),this.greaterThanOp=(e,t)=>g(this.arithmeticHelper.gt,e,t),this.lessThanOp=(e,t)=>g(this.arithmeticHelper.lt,e,t),this.greaterThanOrEqualOp=(e,t)=>g(this.arithmeticHelper.geq,e,t),this.lessThanOrEqualOp=(e,t)=>g(this.arithmeticHelper.leq,e,t),this.concatOp=(e,t)=>g(this.arithmeticHelper.concat,(0,u.coerceScalarToString)(e),(0,u.coerceScalarToString)(t)),this.plusOp=(e,t)=>g(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.minusOp=(e,t)=>g(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.timesOp=(e,t)=>g(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.powerOp=(e,t)=>g(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.divOp=(e,t)=>g(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(e),this.arithmeticHelper.coerceScalarToNumberOrError(t)),this.unaryMinusOp=e=>m(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.percentOp=e=>m(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(e)),this.unaryPlusOp=e=>this.arithmeticHelper.unaryPlus(e),this.functionRegistry.initializePlugins(this),this.criterionBuilder=new l.CriterionBuilder(e)}evaluateAst(e,t){var r,n;let i=this.evaluateAstWithoutPostprocessing(e,t);if((0,d.isExtendedNumber)(i)){if((0,u.isNumberOverflow)((0,d.getRawValue)(i)))return new a.CellError(a.ErrorType.NUM,s.ErrorMessage.NaN);i=(0,d.cloneNumber)(i,(0,u.fixNegativeZero)((0,d.getRawValue)(i)))}return i instanceof p.SimpleRangeValue&&1===i.height()&&1===i.width()&&([[i]]=i.data),r=i,n=t.formulaVertex,r instanceof a.CellError&&void 0!==n?r.attachRootVertex(n):r}evaluateAstWithoutPostprocessing(e,t){switch(e.type){case o.AstNodeType.EMPTY:return d.EmptyValue;case o.AstNodeType.CELL_REFERENCE:{let r=e.reference.toSimpleCellAddress(t.formulaAddress);return(0,a.invalidSimpleCellAddress)(r)?new a.CellError(a.ErrorType.REF,s.ErrorMessage.BadRef):this.dependencyGraph.getCellValue(r)}case o.AstNodeType.NUMBER:case o.AstNodeType.STRING:return e.value;case o.AstNodeType.CONCATENATE_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.concatOp,r,n,t)}case o.AstNodeType.EQUALS_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.equalOp,r,n,t)}case o.AstNodeType.NOT_EQUAL_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.notEqualOp,r,n,t)}case o.AstNodeType.GREATER_THAN_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOp,r,n,t)}case o.AstNodeType.LESS_THAN_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOp,r,n,t)}case o.AstNodeType.GREATER_THAN_OR_EQUAL_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.greaterThanOrEqualOp,r,n,t)}case o.AstNodeType.LESS_THAN_OR_EQUAL_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.lessThanOrEqualOp,r,n,t)}case o.AstNodeType.PLUS_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.plusOp,r,n,t)}case o.AstNodeType.MINUS_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.minusOp,r,n,t)}case o.AstNodeType.TIMES_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.timesOp,r,n,t)}case o.AstNodeType.POWER_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.powerOp,r,n,t)}case o.AstNodeType.DIV_OP:{let r=this.evaluateAst(e.left,t),n=this.evaluateAst(e.right,t);return this.binaryRangeWrapper(this.divOp,r,n,t)}case o.AstNodeType.PLUS_UNARY_OP:{let r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryPlusOp,r,t)}case o.AstNodeType.MINUS_UNARY_OP:{let r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.unaryMinusOp,r,t)}case o.AstNodeType.PERCENT_OP:{let r=this.evaluateAst(e.value,t);return this.unaryRangeWrapper(this.percentOp,r,t)}case o.AstNodeType.FUNCTION_CALL:{if("valid"!==this.config.licenseKeyValidityState&&!c.FunctionRegistry.functionIsProtected(e.procedureName))return new a.CellError(a.ErrorType.LIC,s.ErrorMessage.LicenseKey(this.config.licenseKeyValidityState));let r=this.functionRegistry.getFunction(e.procedureName);return void 0!==r?r(e,new h.InterpreterState(t.formulaAddress,t.arraysFlag||this.functionRegistry.isArrayFunction(e.procedureName),t.formulaVertex)):new a.CellError(a.ErrorType.NAME,s.ErrorMessage.FunctionName(e.procedureName))}case o.AstNodeType.NAMED_EXPRESSION:{let r=this.namedExpressions.nearestNamedExpression(e.expressionName,t.formulaAddress.sheet);return r?this.dependencyGraph.getCellValue(r.address):new a.CellError(a.ErrorType.NAME,s.ErrorMessage.NamedExpressionName(e.expressionName))}case o.AstNodeType.CELL_RANGE:{if(!this.rangeSpansOneSheet(e))return new a.CellError(a.ErrorType.REF,s.ErrorMessage.RangeManySheets);let r=n.AbsoluteCellRange.fromCellRange(e,t.formulaAddress),o=this.dependencyGraph.getArray(r);if(o){let e=o.array;if(e instanceof i.NotComputedArray)throw Error("Array should be already computed");if(e instanceof a.CellError)return e;if(e instanceof i.ArrayValue)return p.SimpleRangeValue.fromRange(e.raw(),r,this.dependencyGraph);throw Error("Unknown array")}return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case o.AstNodeType.COLUMN_RANGE:{if(!this.rangeSpansOneSheet(e))return new a.CellError(a.ErrorType.REF,s.ErrorMessage.RangeManySheets);let r=n.AbsoluteColumnRange.fromColumnRange(e,t.formulaAddress);return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case o.AstNodeType.ROW_RANGE:{if(!this.rangeSpansOneSheet(e))return new a.CellError(a.ErrorType.REF,s.ErrorMessage.RangeManySheets);let r=n.AbsoluteRowRange.fromRowRangeAst(e,t.formulaAddress);return p.SimpleRangeValue.onlyRange(r,this.dependencyGraph)}case o.AstNodeType.PARENTHESIS:return this.evaluateAst(e.expression,t);case o.AstNodeType.ARRAY:{let r,n=[];for(let i of e.args){let e,o=[];for(let r of i){let n=(0,u.coerceToRange)(this.evaluateAst(r,t)),i=n.height();if(void 0===e)e=i,o.push(...n.data);else{if(e!==i)return new a.CellError(a.ErrorType.REF,s.ErrorMessage.SizeMismatch);for(let e=0;e<i;e++)o[e].push(...n.data[e])}}let l=o[0].length;if(void 0===r)r=l,n.push(...o);else{if(r!==l)return new a.CellError(a.ErrorType.REF,s.ErrorMessage.SizeMismatch);n.push(...o)}}return p.SimpleRangeValue.onlyValues(n)}case o.AstNodeType.ERROR_WITH_RAW_INPUT:case o.AstNodeType.ERROR:return e.error}}rangeSpansOneSheet(e){return e.start.sheet===e.end.sheet}unaryRangeWrapper(e,t,r){var n;if(t instanceof p.SimpleRangeValue&&!r.arraysFlag&&(t=null!=(n=(0,u.coerceRangeToScalar)(t,r))?n:new a.CellError(a.ErrorType.VALUE,s.ErrorMessage.ScalarExpected)),t instanceof a.CellError)return t;if(t instanceof p.SimpleRangeValue){let r=t.data.map(t=>t.map(e));return p.SimpleRangeValue.onlyValues(r)}return e(t)}binaryRangeWrapper(e,t,r,n){var i,o;if(t instanceof p.SimpleRangeValue&&!n.arraysFlag&&(t=null!=(i=(0,u.coerceRangeToScalar)(t,n))?i:new a.CellError(a.ErrorType.VALUE,s.ErrorMessage.ScalarExpected)),t instanceof a.CellError)return t;if(r instanceof p.SimpleRangeValue&&!n.arraysFlag&&(r=null!=(o=(0,u.coerceRangeToScalar)(r,n))?o:new a.CellError(a.ErrorType.VALUE,s.ErrorMessage.ScalarExpected)),r instanceof a.CellError)return r;if(t instanceof p.SimpleRangeValue||r instanceof p.SimpleRangeValue){if(!(t instanceof p.SimpleRangeValue)){if(r.isAdHoc()){let n=r.data;for(let r=0;r<n.length;r++)for(let i=0;i<n[0].length;i++)n[r][i]=e(t,n[r][i]);return p.SimpleRangeValue.onlyValues(n)}t=p.SimpleRangeValue.fromScalar(t)}if(!(r instanceof p.SimpleRangeValue)){if(t.isAdHoc()){let n=t.data;for(let t=0;t<n.length;t++)for(let i=0;i<n[0].length;i++)n[t][i]=e(n[t][i],r);return p.SimpleRangeValue.onlyValues(n)}r=p.SimpleRangeValue.fromScalar(r)}if(t.width()===r.width()&&t.height()===r.height()){if(t.isAdHoc()){let n=t.data,i=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)n[t][r]=e(n[t][r],i[t][r]);return p.SimpleRangeValue.onlyValues(n)}if(r.isAdHoc()){let n=t.data,i=r.data;for(let t=0;t<n.length;t++)for(let r=0;r<n[0].length;r++)i[t][r]=e(n[t][r],i[t][r]);return p.SimpleRangeValue.onlyValues(i)}}let n=Math.max(t.width(),r.width()),i=Math.max(t.height(),r.height()),s=Array(i);for(let e=0;e<i;e++)s[e]=Array(n);for(let o=0;o<i;o++){let i=1!==t.height()?o:0,u=1!==r.height()?o:0;for(let l=0;l<n;l++){let n=1!==t.width()?l:0,c=1!==r.width()?l:0;i<t.height()&&u<r.height()&&n<t.width()&&c<r.width()?s[o][l]=e(t.data[i][n],r.data[u][c]):s[o][l]=new a.CellError(a.ErrorType.NA)}}return p.SimpleRangeValue.onlyValues(s)}return e(t,r)}}},function(e,t,r){"use strict";t.__esModule=!0,t.buildCriterionLambda=t.buildCriterion=t.CriterionType=t.CriterionBuilder=void 0;var n,i,a=r(140);(n=i||(t.CriterionType=i={})).GREATER_THAN="GREATER_THAN",n.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",n.LESS_THAN="LESS_THAN",n.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",n.NOT_EQUAL="NOT_EQUAL",n.EQUAL="EQUAL";let s=(e,t)=>({operator:e,value:t});t.buildCriterion=s,t.CriterionBuilder=class{constructor(e){var t,r,n,i;this.trueString=null!=(r=null==(t=e.translationPackage.getMaybeFunctionTranslation("TRUE"))?void 0:t.toLowerCase())?r:"true",this.falseString=null!=(i=null==(n=e.translationPackage.getMaybeFunctionTranslation("FALSE"))?void 0:n.toLowerCase())?i:"false"}fromCellValue(e,t){if("string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e)return;let r=this.parseCriterion(e,t);return void 0!==r?{raw:e,lambda:u(r,t)}:void 0}parseCriterion(e,t){if("number"==typeof e||"boolean"==typeof e)return s(i.EQUAL,e);if("string"==typeof e){let r,n,u=o.exec(e);u?(n=function(e){switch(e){case">":return i.GREATER_THAN;case">=":return i.GREATER_THAN_OR_EQUAL;case"<":return i.LESS_THAN;case"<=":return i.LESS_THAN_OR_EQUAL;case"<>":return i.NOT_EQUAL;case"=":return i.EQUAL;default:return}}(u[1]),r=u[2]):(n=i.EQUAL,r=e);let l=t.coerceToMaybeNumber(r),c=r.toLowerCase()===this.trueString||r.toLowerCase()!==this.falseString&&void 0;if(void 0===n)return;if(""===r)return s(n,null);if(void 0!==l)return s(n,(0,a.getRawValue)(l));if(n===i.EQUAL||n===i.NOT_EQUAL)return s(n,null!=c?c:r)}}};let o=/([<>=]+)(.*)/,u=(e,t)=>{switch(e.operator){case i.GREATER_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>0:e=>!1;case i.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&t.floatCmp(r,e.value)>=0:e=>!1;case i.LESS_THAN:return"number"==typeof e.value?r=>"number"==typeof r&&0>t.floatCmp(r,e.value):e=>!1;case i.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?r=>"number"==typeof r&&0>=t.floatCmp(r,e.value):e=>!1;case i.EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0===t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!1;let n=t.coerceToMaybeNumber(r);return void 0!==n&&0===t.floatCmp(n,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"==typeof t&&t===e.value:e=>e===a.EmptyValue;case i.NOT_EQUAL:return"number"==typeof e.value?r=>{if("number"==typeof r)return 0!==t.floatCmp(r,e.value);if("string"==typeof r){if(""===r)return!0;let n=t.coerceToMaybeNumber(r);return void 0===n||0!==t.floatCmp(n,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?t=>"boolean"!=typeof t||t!==e.value:e=>e!==a.EmptyValue}};t.buildCriterionLambda=u},function(e,t,r){"use strict";t.__esModule=!0,t.LazilyTransformingAstService=void 0,r(2);var n=r(205),i=r(142);t.LazilyTransformingAstService=class{constructor(e){this.stats=e,this.transformations=[]}version(){return this.transformations.length}addTransformation(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}beginCombinedMode(e){this.combinedTransformer=new n.CombinedTransformer(e)}commitCombinedMode(){if(void 0===this.combinedTransformer)throw Error("Combined mode wasn't started");return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}applyTransformations(e,t,r){this.stats.start(i.StatType.TRANSFORM_ASTS_POSTPONED);for(let n=r;n<this.transformations.length;n++){let r=this.transformations[n];r.isIrreversible()&&(this.undoRedo.storeDataForVersion(n,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));let[i,a]=r.transformSingleAst(e,t);e=i,t=a}let n=this.parser.rememberNewAst(e);return this.stats.end(i.StatType.TRANSFORM_ASTS_POSTPONED),[n,t,this.transformations.length]}*getTransformationsFrom(e,t){for(let r=e;r<this.transformations.length;r++){let e=this.transformations[r];t&&!t(e)||(yield e)}}}},function(e,t,r){"use strict";t.__esModule=!0,t.CombinedTransformer=void 0,r(2),t.CombinedTransformer=class{constructor(e){this.sheet=e,this.transformations=[]}add(e){this.transformations.push(e)}performEagerTransformations(e,t){this.transformations.forEach(r=>r.performEagerTransformations(e,t))}transformSingleAst(e,t){let[r,n]=[e,t];return this.transformations.forEach(e=>{[r,n]=e.transformSingleAst(r,n)}),[r,n]}isIrreversible(){return!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.buildColumnSearchStrategy=function(e,t,r){return t.useColumnIndex?new i.ColumnIndex(e,t,r):new n.ColumnBinarySearch(e)};var n=r(207),i=r(210)},function(e,t,r){"use strict";t.__esModule=!0,t.ColumnBinarySearch=void 0;var n=r(208);class i extends n.AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}add(e,t){}remove(e,t){}change(e,t,r){}applyChanges(e){}addColumns(e){}removeColumns(e){}removeSheet(e){}moveValues(e,t,r,n){}removeValues(e){}find(e,t,r){return this.basicFind(e,t,"row",r)}}t.ColumnBinarySearch=i},function(e,t,r){"use strict";t.__esModule=!0,t.AdvancedFind=void 0;var n=r(140),i=r(168),a=r(209);t.AdvancedFind=class{constructor(e){this.dependencyGraph=e}advancedFind(e,t){let r,i=t.range;r=void 0===i?t.valuesFromTopLeftCorner():this.dependencyGraph.computeListOfValuesInRange(i);for(let t=0;t<r.length;t++)if(e((0,n.getRawValue)(r[t])))return t;return -1}basicFind(e,t,r,{ordering:n,matchExactly:s}){let o="string"==typeof e?(0,i.forceNormalizeString)(e):e,u=t.range;return void 0===u?this.findNormalizedValue(o,t.valuesFromTopLeftCorner()):"none"===n?this.findNormalizedValue(o,this.dependencyGraph.computeListOfValuesInRange(u)):(0,a.findLastOccurrenceInOrderedRange)(o,u,{searchCoordinate:r,orderingDirection:n,matchExactly:s},this.dependencyGraph)}findNormalizedValue(e,t){return t.map(n.getRawValue).map(e=>"string"==typeof e?(0,i.forceNormalizeString)(e):e).indexOf(e)}}},function(e,t,r){"use strict";t.__esModule=!0,t.compare=s,t.findLastMatchingIndex=a,t.findLastOccurrenceInOrderedArray=function(e,t,r="asc"){return a("asc"===r?r=>s(e,t[r])>=0:r=>-s(e,t[r])>=0,0,t.length-1)},t.findLastOccurrenceInOrderedRange=function(e,t,{searchCoordinate:r,orderingDirection:o,matchExactly:u},l){let c=t.start[r],h="col"===r?t.effectiveEndColumn(l):t.effectiveEndRow(l),d="col"===r?e=>(0,i.getRawValue)(l.getCellValue((0,n.simpleCellAddress)(t.sheet,e,t.start.row))):e=>(0,i.getRawValue)(l.getCellValue((0,n.simpleCellAddress)(t.sheet,t.start.col,e))),p="asc"===o?(e,t)=>s(e,t):(e,t)=>-s(e,t),m=a(t=>p(e,d(t))>=0,c,h),g=d(m);return -1===m||typeof g!=typeof e||u&&g!==e?-1:m-c};var n=r(73),i=r(140);function a(e,t,r){let n=t,i=r;for(;n<i;){let t=Math.ceil((n+i)/2);e(t)?n=t:i=t-1}return n===i&&e(n)?n:-1}function s(e,t){return typeof e==typeof t?e===i.EmptyValue?0:e<t?-1:+(e>t):e===i.EmptyValue?-1:t===i.EmptyValue?1:t instanceof n.CellError||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}},function(e,t,r){"use strict";t.__esModule=!0,t.ColumnIndex=void 0,t.findInOrderedArray=d;var n=r(73),i=r(189),a=r(193),s=r(168),o=r(140),u=r(139),l=r(142),c=r(207);class h{constructor(e,t,r){this.dependencyGraph=e,this.config=t,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new c.ColumnBinarySearch(e)}add(e,t){if(!(e===o.EmptyValue||e instanceof n.CellError))if(e instanceof u.SimpleRangeValue)for(let[r,n]of e.entriesFromTopLeftCorner(t))this.addSingleCellValue((0,o.getRawValue)(r),n);else this.addSingleCellValue(e,t)}remove(e,t){if(void 0!==e)if(e instanceof u.SimpleRangeValue)for(let[r,n]of e.entriesFromTopLeftCorner(t))this.removeSingleValue((0,o.getRawValue)(r),n);else this.removeSingleValue(e,t)}change(e,t,r){e!==t&&(this.remove(e,r),this.add(t,r))}applyChanges(e){for(let t of e)void 0!==t.oldValue&&this.change((0,o.getRawValue)(t.oldValue),(0,o.getRawValue)(t.value),t.address)}moveValues(e,t,r,i){for(let[a,s]of e){let e=(0,n.movedSimpleCellAddress)(s,i,t,r);this.remove(a,s),this.add(a,e)}}removeValues(e){for(let[t,r]of e)this.remove(t,r)}find(e,t,{ordering:r,matchExactly:n}){let i=this.findUsingColumnIndex(e,t,!0===n?"findFirst":"findLast");return void 0!==i?i:this.binarySearchStrategy.find(e,t,{ordering:r,matchExactly:n})}findUsingColumnIndex(e,t,r){let n=t.range;if(void 0===n)return;this.ensureRecentData(n.sheet,n.start.col,e);let i=this.getColumnMap(n.sheet,n.start.col);if(!i)return -1;let a="string"==typeof e?(0,s.forceNormalizeString)(e):e,o=i.get(a);if(!o||!o.index||0===o.index.length)return;let u=h.findRowBelongingToRange(o,n,r);return void 0!==u?u-n.start.row:void 0}static findRowBelongingToRange(e,t,r){let n=t.start.row,i=t.end.row,a="findFirst"===r?d(n,e.index,"upperBound"):d(i,e.index,"lowerBound");if(-1===a)return;let s=e.index[a];return s>=n&&s<=i?s:void 0}advancedFind(e,t){return this.binarySearchStrategy.advancedFind(e,t)}addColumns(e){let t=this.index.get(e.sheet);t&&t.splice(e.columnStart,0,...Array(e.numberOfColumns))}removeColumns(e){let t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}removeSheet(e){this.index.delete(e)}getColumnMap(e,t){this.index.has(e)||this.index.set(e,[]);let r=this.index.get(e),n=r[t];return n||(n=new Map,r[t]=n),n}getValueIndex(e,t,r){let n=this.getColumnMap(e,t),i=this.getColumnMap(e,t).get(r);return i||(i={version:this.transformingService.version(),index:[]},n.set(r,i)),i}ensureRecentData(e,t,r){let n=this.getValueIndex(e,t,r),s=this.transformingService.version();if(n.version!==s){for(let s of this.transformingService.getTransformationsFrom(n.version,t=>t.sheet===e&&(t instanceof i.AddRowsTransformer||t instanceof a.RemoveRowsTransformer)))s instanceof i.AddRowsTransformer?this.addRows(t,s.rowsSpan,r):s instanceof a.RemoveRowsTransformer&&this.removeRows(t,s.rowsSpan,r);n.version=s}}addSingleCellValue(e,t){this.stats.measure(l.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=(0,s.forceNormalizeString)(e));let r=this.getValueIndex(t.sheet,t.col,e);h.addValue(r,t.row)})}removeSingleValue(e,t){this.stats.measure(l.StatType.BUILD_COLUMN_INDEX,()=>{this.ensureRecentData(t.sheet,t.col,e);let r=this.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=(0,s.forceNormalizeString)(e));let n=r.get(e);if(!n)return;let i=d(t.row,n.index);i>-1&&n.index.splice(i,1),0===n.index.length&&r.delete(e),0===r.size&&delete this.index.get(t.sheet)[t.col]})}addRows(e,t,r){let n=this.getValueIndex(t.sheet,e,r);h.shiftRows(n,t.rowStart,t.numberOfRows)}removeRows(e,t,r){let n=this.getValueIndex(t.sheet,e,r);h.removeRowsFromValues(n,t),h.shiftRows(n,t.rowEnd+1,-t.numberOfRows)}static addValue(e,t){let r=d(t,e.index,"lowerBound");e.index[r]===t||e.index.splice(r+1,0,t)}static removeRowsFromValues(e,t){let r=d(t.rowStart,e.index,"upperBound"),n=d(t.rowEnd,e.index,"lowerBound");r>-1&&n>-1&&r<=n&&e.index[r]<=t.rowEnd&&e.index.splice(r,n-r+1)}static shiftRows(e,t,r){let n=d(t,e.index,"upperBound");if(-1!==n)for(let t=n;t<e.index.length;++t)e.index[t]+=r}}function d(e,t,r="upperBound"){let n=0,i=t.length-1;for(;n<=i;){let r=Math.floor((n+i)/2);if(e>t[r])n=r+1;else{if(!(e<t[r]))return r;i=r-1}}let a="lowerBound"===r?i:n;return a>=0&&a<=t.length?a:-1}t.ColumnIndex=h},function(e,t,r){"use strict";t.__esModule=!0,t.NumberLiteralHelper=void 0,t.NumberLiteralHelper=class{constructor(e){this.config=e;let t="."===this.config.thousandSeparator?"\\"+this.config.thousandSeparator:this.config.thousandSeparator,r="."===this.config.decimalSeparator?"\\"+this.config.decimalSeparator:this.config.decimalSeparator;this.numberPattern=RegExp(`^([+-]?((${r}\\d+)|(\\d+(${t}\\d{3,})*(${r}\\d*)?)))(e[+-]?\\d+)?$`),this.allThousandSeparatorsRegex=RegExp(""+t,"g")}numericStringToMaybeNumber(e){if(this.numberPattern.test(e)){let t=this.numericStringToNumber(e);if(!isNaN(t))return t}}numericStringToNumber(e){return Number(e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,"."))}}},function(e,t,r){"use strict";t.__esModule=!0,t.Serialization=void 0;var n=r(73),i=r(74),a=r(77);class s{constructor(e,t,r){this.dependencyGraph=e,this.unparser=t,this.exporter=r}getCellHyperlink(e){let t=this.dependencyGraph.getCell(e);if(t instanceof i.FormulaCellVertex){let e=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);if("HYPERLINK"===e.procedureName)return e.hyperlink}}getCellFormula(e,t){let r=this.dependencyGraph.getCell(e);if(r instanceof i.FormulaCellVertex){let n=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);return t=null!=t?t:e,this.unparser.unparse(n,t)}if(r instanceof i.ArrayVertex){let n=r.getAddress(this.dependencyGraph.lazilyTransformingAstService);if(n.row!==e.row||n.col!==e.col||n.sheet!==e.sheet)return;t=null!=t?t:e;let i=r.getFormula(this.dependencyGraph.lazilyTransformingAstService);if(void 0!==i)return this.unparser.unparse(i,t)}else if(r instanceof i.ParsingErrorVertex)return r.getFormula()}getCellSerialized(e,t){var r;return null!=(r=this.getCellFormula(e,t))?r:this.getRawValue(e)}getCellValue(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}getRawValue(e){return this.dependencyGraph.getRawValue(e)}getSheetValues(e){return this.genericSheetGetter(e,e=>this.getCellValue(e))}getSheetFormulas(e){return this.genericSheetGetter(e,e=>this.getCellFormula(e))}genericSheetGetter(e,t){let r=this.dependencyGraph.getSheetHeight(e),i=this.dependencyGraph.getSheetWidth(e),a=Array(r);for(let s=0;s<r;s++){a[s]=Array(i);for(let r=0;r<i;r++){let i=(0,n.simpleCellAddress)(e,r,s);a[s][r]=t(i)}for(let e=i-1;e>=0&&(null===a[s][e]||void 0===a[s][e]);e--)a[s].pop()}for(let e=r-1;e>=0&&0===a[e].length;e--)a.pop();return a}genericAllSheetsGetter(e){let t={};for(let r of this.dependencyGraph.sheetMapping.displayNames()){let n=this.dependencyGraph.sheetMapping.fetch(r);t[r]=e(n)}return t}getSheetSerialized(e){return this.genericSheetGetter(e,e=>this.getCellSerialized(e))}getAllSheetsValues(){return this.genericAllSheetsGetter(e=>this.getSheetValues(e))}getAllSheetsFormulas(){return this.genericAllSheetsGetter(e=>this.getSheetFormulas(e))}getAllSheetsSerialized(){return this.genericAllSheetsGetter(e=>this.getSheetSerialized(e))}getAllNamedExpressionsSerialized(){let e=[],t=0;for(let r of this.dependencyGraph.sheetMapping.displayNames())e[this.dependencyGraph.sheetMapping.fetch(r)]=t,t++;return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map(t=>({name:t.expression.displayName,expression:this.getCellSerialized(t.expression.address),scope:void 0!==t.scope?e[t.scope]:void 0,options:t.expression.options}))}withNewConfig(e,t){let r=new a.Unparser(e,(0,a.buildLexerConfig)(e),this.dependencyGraph.sheetMapping.fetchDisplayName,t);return new s(this.dependencyGraph,r,this.exporter)}}t.Serialization=s},function(e,t,r){"use strict";t.__esModule=!0,t.objectDestroy=function(e){for(let[t,r]of Object.entries(e))r instanceof Function?e[t]=function(e){return()=>{throw Error(`The "${e}" method cannot be called because this HyperFormula instance has been destroyed`)}}(r):delete e[t]}},function(e,t,r){"use strict";t.__esModule=!0,t.Events=t.Emitter=void 0;var n,i,a=r(215);(n=i||(t.Events=i={})).SheetAdded="sheetAdded",n.SheetRemoved="sheetRemoved",n.SheetRenamed="sheetRenamed",n.NamedExpressionAdded="namedExpressionAdded",n.NamedExpressionRemoved="namedExpressionRemoved",n.ValuesUpdated="valuesUpdated",n.EvaluationSuspended="evaluationSuspended",n.EvaluationResumed="evaluationResumed";class s extends a.TinyEmitter{emit(e,...t){return super.emit(e,...t),this}}t.Emitter=s},function(e,t){function r(){}r.prototype={on:function(e,t,r){var n=this.e||(this.e={});return(n[e]||(n[e]=[])).push({fn:t,ctx:r}),this},once:function(e,t,r){var n=this;function i(){n.off(e,i),t.apply(r,arguments)}return i._=t,this.on(e,i,r)},emit:function(e){for(var t=[].slice.call(arguments,1),r=((this.e||(this.e={}))[e]||[]).slice(),n=0,i=r.length;n<i;n++)r[n].fn.apply(r[n].ctx,t);return this},off:function(e,t){var r=this.e||(this.e={}),n=r[e],i=[];if(n&&t)for(var a=0,s=n.length;a<s;a++)n[a].fn!==t&&n[a].fn._!==t&&i.push(n[a]);return i.length?r[e]=i:delete r[e],this}},e.exports=r,e.exports.TinyEmitter=r},function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0,t.default={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",SPILL:"#SPILL!",VALUE:"#VALUE!"},functions:{FILTER:"FILTER",ADDRESS:"ADDRESS",ARRAY_CONSTRAIN:"ARRAY_CONSTRAIN",ARRAYFORMULA:"ARRAYFORMULA",ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",HYPERLINK:"HYPERLINK",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",IFS:"IFS",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXIFS:"MAXIFS",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINIFS:"MINIFS",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}}},function(e,t,r){"use strict";t.__esModule=!0,t.TrigonometryPlugin=t.TextPlugin=t.SumprodPlugin=t.StatisticalPlugin=t.StatisticalAggregationPlugin=t.SqrtPlugin=t.SimpleArithmerticPlugin=t.RoundingPlugin=t.RomanPlugin=t.RandomPlugin=t.RadixConversionPlugin=t.RadiansPlugin=t.PowerPlugin=t.NumericAggregationPlugin=t.ModuloPlugin=t.MedianPlugin=t.MatrixPlugin=t.MathPlugin=t.MathConstantsPlugin=t.LookupPlugin=t.LogarithmPlugin=t.IsOddPlugin=t.IsEvenPlugin=t.InformationPlugin=t.HyperlinkPlugin=t.FormulaTextPlugin=t.FinancialPlugin=t.ExpPlugin=t.DeltaPlugin=t.DegreesPlugin=t.DateTimePlugin=t.CountUniquePlugin=t.CountBlankPlugin=t.ConditionalAggregationPlugin=t.ComplexPlugin=t.CodePlugin=t.CharPlugin=t.BooleanPlugin=t.BitwiseLogicOperationsPlugin=t.BitShiftPlugin=t.ArrayPlugin=t.AddressPlugin=t.AbsPlugin=void 0,t.AddressPlugin=r(218).AddressPlugin,t.ArrayPlugin=r(219).ArrayPlugin,t.AbsPlugin=r(220).AbsPlugin,t.BitShiftPlugin=r(221).BitShiftPlugin,t.BitwiseLogicOperationsPlugin=r(222).BitwiseLogicOperationsPlugin,t.BooleanPlugin=r(223).BooleanPlugin,t.CharPlugin=r(224).CharPlugin,t.CodePlugin=r(225).CodePlugin,t.CountBlankPlugin=r(226).CountBlankPlugin,t.CountUniquePlugin=r(227).CountUniquePlugin,t.DateTimePlugin=r(228).DateTimePlugin,t.DegreesPlugin=r(229).DegreesPlugin,t.DeltaPlugin=r(230).DeltaPlugin,t.ExpPlugin=r(231).ExpPlugin,t.FinancialPlugin=r(232).FinancialPlugin,t.FormulaTextPlugin=r(233).FormulaTextPlugin,t.HyperlinkPlugin=r(234).HyperlinkPlugin,t.InformationPlugin=r(235).InformationPlugin,t.IsEvenPlugin=r(236).IsEvenPlugin,t.IsOddPlugin=r(237).IsOddPlugin,t.LogarithmPlugin=r(238).LogarithmPlugin,t.MathConstantsPlugin=r(239).MathConstantsPlugin,t.MatrixPlugin=r(240).MatrixPlugin,t.MedianPlugin=r(241).MedianPlugin,t.ModuloPlugin=r(242).ModuloPlugin,t.NumericAggregationPlugin=r(243).NumericAggregationPlugin,t.PowerPlugin=r(244).PowerPlugin,t.RadiansPlugin=r(245).RadiansPlugin,t.RadixConversionPlugin=r(246).RadixConversionPlugin,t.RandomPlugin=r(247).RandomPlugin,t.RoundingPlugin=r(248).RoundingPlugin,t.SqrtPlugin=r(249).SqrtPlugin,t.ConditionalAggregationPlugin=r(250).ConditionalAggregationPlugin,t.SumprodPlugin=r(253).SumprodPlugin,t.TextPlugin=r(254).TextPlugin,t.TrigonometryPlugin=r(255).TrigonometryPlugin,t.LookupPlugin=r(256).LookupPlugin,t.RomanPlugin=r(258).RomanPlugin,t.SimpleArithmerticPlugin=r(259).SimpleArithmerticPlugin,t.StatisticalPlugin=r(260).StatisticalPlugin,t.MathPlugin=r(263).MathPlugin,t.ComplexPlugin=r(264).ComplexPlugin,t.StatisticalAggregationPlugin=r(265).StatisticalAggregationPlugin},function(e,t,r){"use strict";t.__esModule=!0,t.AddressPlugin=void 0;var n,i,a=r(78),s=r(167),o=r(73),u=r(131);(n=i||(i={}))[n.FullyAbsolute=1]="FullyAbsolute",n[n.RowAbsoluteColRelative=2]="RowAbsoluteColRelative",n[n.RowRelativeColAbsolute=3]="RowRelativeColAbsolute",n[n.FullyRelative=4]="FullyRelative";class l extends s.FunctionPlugin{verifyAddressArguments(e,t,r,n){if(n){if(e<1||t<1)return new o.CellError(o.ErrorType.VALUE,u.ErrorMessage.LessThanOne)}else if(i.FullyAbsolute==r){if(e<1||t<1)return new o.CellError(o.ErrorType.VALUE,u.ErrorMessage.LessThanOne)}else if(i.RowAbsoluteColRelative==r){if(e<1)return new o.CellError(o.ErrorType.VALUE,u.ErrorMessage.LessThanOne)}else if(i.RowRelativeColAbsolute==r&&t<1)return new o.CellError(o.ErrorType.VALUE,u.ErrorMessage.LessThanOne)}address(e,t){return this.runFunction(e.args,t,this.metadata("ADDRESS"),(e,t,r,n,s)=>{let o=this.verifyAddressArguments(e,t,r,n);if(void 0!==o)return o;let u=(0,a.columnIndexToLabel)(t-1),l="";null!=s&&(l=s+"!");let c=0==t?"C":`C[${t}]`,h=0==e?"R":`R[${e}]`;return i.FullyRelative==r?n?`${l}${u}${e}`:`${l}${h}${c}`:i.RowRelativeColAbsolute==r?n?`${l}$${u}${e}`:`${l}${h}C${t}`:i.RowAbsoluteColRelative==r?n?`${l}${u}$${e}`:`${l}R${e}${c}`:n?`${l}$${u}$${e}`:`${l}R${e}C${t}`})}}t.AddressPlugin=l,l.implementedFunctions={ADDRESS:{method:"address",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,defaultValue:1,minValue:1,maxValue:4},{argumentType:s.FunctionArgumentType.BOOLEAN,optionalArg:!0,defaultValue:!0},{argumentType:s.FunctionArgumentType.STRING,optionalArg:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ArrayPlugin=void 0,r(2);var n=r(1),i=r(73),a=r(131),s=r(77),o=r(168),u=r(165),l=r(139),c=r(167);class h extends c.FunctionPlugin{arrayformula(e,t){return this.runFunction(e.args,t,this.metadata("ARRAYFORMULA"),e=>e)}arrayformulaArraySize(e,t){if(1!==e.args.length)return n.ArraySize.error();let r=this.metadata("ARRAYFORMULA");return e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(n=null==r?void 0:r.arrayFunction)&&n))})[0]}arrayconstrain(e,t){return this.runFunction(e.args,t,this.metadata("ARRAY_CONSTRAIN"),(e,t,r)=>{t=Math.min(t,e.height()),r=Math.min(r,e.width());let n=e.data,i=[];for(let e=0;e<t;e++)i.push(n[e].slice(0,r));return l.SimpleRangeValue.onlyValues(i)})}arrayconstrainArraySize(e,t){if(3!==e.args.length)return n.ArraySize.error();let r=this.metadata("ARRAY_CONSTRAIN"),{height:i,width:a}=e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(n=null==r?void 0:r.arrayFunction)&&n))})[0];return e.args[1].type===s.AstNodeType.NUMBER&&(i=Math.min(i,e.args[1].value)),e.args[2].type===s.AstNodeType.NUMBER&&(a=Math.min(a,e.args[2].value)),i<1||a<1||!Number.isInteger(i)||!Number.isInteger(a)?n.ArraySize.error():new n.ArraySize(a,i)}filter(e,t){return this.runFunction(e.args,t,this.metadata("FILTER"),(e,...t)=>{for(let r of t)if(e.width()!==r.width()||e.height()!==r.height())return new i.CellError(i.ErrorType.NA,a.ErrorMessage.EqualLength);if(e.width()>1&&e.height()>1)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongDimension);let r=e.data,n=[];for(let i=0;i<e.height();i++){let a=[];for(let n=0;n<e.width();n++){let e=!0;for(let r of t)if(!0!==(0,o.coerceScalarToBoolean)(r.data[i][n])){e=!1;break}e&&a.push(r[i][n])}a.length>0&&n.push(a)}return n.length>0?l.SimpleRangeValue.onlyValues(n):new i.CellError(i.ErrorType.NA,a.ErrorMessage.EmptyRange)})}filterArraySize(e,t){if(e.args.length<=1)return n.ArraySize.error();let r=this.metadata("FILTER"),i=e.args.map(e=>{var n;return this.arraySizeForAst(e,new u.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(n=null==r?void 0:r.arrayFunction)&&n))}),a=Math.max(...i.map(e=>e.width)),s=Math.max(...i.map(e=>e.height));return new n.ArraySize(a,s)}}t.ArrayPlugin=h,h.implementedFunctions={ARRAYFORMULA:{method:"arrayformula",arraySizeMethod:"arrayformulaArraySize",arrayFunction:!0,parameters:[{argumentType:c.FunctionArgumentType.ANY}]},ARRAY_CONSTRAIN:{method:"arrayconstrain",arraySizeMethod:"arrayconstrainArraySize",parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.INTEGER,minValue:1},{argumentType:c.FunctionArgumentType.INTEGER,minValue:1}],vectorizationForbidden:!0},FILTER:{method:"filter",arraySizeMethod:"filterArraySize",arrayFunction:!0,parameters:[{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.AbsPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{abs(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}t.AbsPlugin=i,i.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BitShiftPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{bitlshift(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),o)}bitrshift(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),u)}}function o(e,t){return t<0?u(e,-t):l(e*Math.pow(2,t))}function u(e,t){return t<0?o(e,-t):l(Math.floor(e/Math.pow(2,t)))}function l(e){return e>0xffffffffffff?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.BitshiftLong):e}t.BitShiftPlugin=s,s.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:a.FunctionArgumentType.INTEGER,minValue:0},{argumentType:a.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:a.FunctionArgumentType.INTEGER,minValue:0},{argumentType:a.FunctionArgumentType.INTEGER,minValue:-53,maxValue:53}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BitwiseLogicOperationsPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{bitand(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(e,t)=>e&t)}bitor(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(e,t)=>e|t)}bitxor(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(e,t)=>e^t)}}t.BitwiseLogicOperationsPlugin=i,i.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:n.FunctionArgumentType.INTEGER,minValue:0},{argumentType:n.FunctionArgumentType.INTEGER,minValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.BooleanPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{literalTrue(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),()=>!0)}literalFalse(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),()=>!1)}conditionalIf(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(e,t,r)=>e?t:r)}ifs(e,t){return this.runFunction(e.args,t,this.metadata("IFS"),(...e)=>{for(let t=0;t<e.length;t+=2)if(e[t])return e[t+1];return new n.CellError(n.ErrorType.NA,i.ErrorMessage.NoConditionMet)})}and(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(...e)=>e.filter(e=>void 0!==e).every(e=>!!e))}or(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(...e)=>e.filter(e=>void 0!==e).some(e=>e))}not(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),e=>!e)}xor(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(...e)=>{let t=0;return e.filter(e=>void 0!==e).forEach(e=>{e&&t++}),t%2==1})}switch(e,t){return this.runFunction(e.args,t,this.metadata("SWITCH"),(e,...t)=>{let r=t.length,a=0;for(;a+1<r;a+=2)if(!(t[a]instanceof n.CellError)&&this.arithmeticHelper.eq(e,t[a]))return t[a+1];return a<r?t[a]:new n.CellError(n.ErrorType.NA,i.ErrorMessage.NoDefault)})}iferror(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(e,t)=>e instanceof n.CellError?t:e)}ifna(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(e,t)=>e instanceof n.CellError&&e.type===n.ErrorType.NA?t:e)}choose(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(e,...t)=>e>t.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.Selector):t[e-1])}}t.BooleanPlugin=s,s.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:a.FunctionArgumentType.SCALAR,defaultValue:!1,passSubtype:!0}]},IFS:{method:"ifs",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:2},AND:{method:"and",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:a.FunctionArgumentType.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:a.FunctionArgumentType.NOERROR},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:a.FunctionArgumentType.INTEGER,minValue:1},{argumentType:a.FunctionArgumentType.SCALAR,passSubtype:!0}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.CharPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{char(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||e>=256?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCharCode(Math.trunc(e)))}unichar(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),e=>e<1||e>=1114112?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e)))}}t.CharPlugin=s,s.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.CodePlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{code(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),e=>0===e.length?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString):e.charCodeAt(0))}unicode(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),e=>{var t;return null!=(t=e.codePointAt(0))?t:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EmptyString)})}}t.CodePlugin=s,s.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:a.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.CountBlankPlugin=void 0;var n=r(140),i=r(167);class a extends i.FunctionPlugin{countblank(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(...e)=>{let t=0;return e.forEach(e=>{e===n.EmptyValue&&t++}),t})}}t.CountBlankPlugin=a,a.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:i.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.CountUniquePlugin=void 0;var n=r(73),i=r(167);class a extends i.FunctionPlugin{countunique(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(...e)=>{let t=new Set,r=new Set;for(let i of e)i instanceof n.CellError?r.add(i.type):""!==i&&t.add(i);return t.size+r.size})}}t.CountUniquePlugin=a,a.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:i.FunctionArgumentType.SCALAR}],repeatLastArgs:1,expandRanges:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.DateTimePlugin=void 0,r(2);var n=r(73),i=r(174),a=r(131),s=r(176),o=r(140),u=r(167);class l extends u.FunctionPlugin{constructor(){super(...arguments),this.isoweeknumCore=e=>{let t=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),r=this.dateTimeHelper.numberToSimpleDate(e),n=this.dateTimeHelper.dateToNumber({year:r.year,month:1,day:1}),i=this.dateTimeHelper.relativeNumberToAbsoluteNumber(n),a=Math.floor((t-1)/7)-Math.floor((i+((4-i)%7+7)%7-1)/7)+1;return 0===a?this.isoweeknumCore(e-7)+1:a},this.days360Core=(e,t,r)=>{let n,a,s=this.dateTimeHelper.numberToSimpleDate(e),o=this.dateTimeHelper.numberToSimpleDate(t);return r?(n=(0,i.toBasisEU)(s),a=(0,i.toBasisEU)(o)):[n,a]=this.dateTimeHelper.toBasisUS(s,o),360*(a.year-n.year)+30*(a.month-n.month)+a.day-n.day}}date(e,t){return this.runFunction(e.args,t,this.metadata("DATE"),(e,t,r)=>{let i=Math.trunc(r),s=Math.trunc(t),o=Math.trunc(e);o<this.dateTimeHelper.getEpochYearZero()&&(o+=this.dateTimeHelper.getEpochYearZero());let u=Math.floor((s-1)/12),l={year:o+=u,month:s-=12*u,day:1};if(this.dateTimeHelper.isValidDate(l)){let e=this.dateTimeHelper.dateToNumber(l)+(i-1);return void 0===(e=this.dateTimeHelper.getWithinBounds(e))?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds):e}return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.InvalidDate)})}time(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(e,t,r)=>{let s=(0,i.timeToNumber)({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(r)});return s<0?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.NegativeTime):s%1})}eomonth(e,t){return this.runFunction(e.args,t,this.metadata("EOMONTH"),(e,t)=>{let r=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.dateToNumber(this.dateTimeHelper.endOfMonth((0,i.offsetMonth)(r,t)));return void 0===(s=this.dateTimeHelper.getWithinBounds(s))?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds):s})}day(e,t){return this.runFunction(e.args,t,this.metadata("DAY"),e=>this.dateTimeHelper.numberToSimpleDate(e).day)}days(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(e,t)=>Math.trunc(e)-Math.trunc(t))}month(e,t){return this.runFunction(e.args,t,this.metadata("MONTH"),e=>this.dateTimeHelper.numberToSimpleDate(e).month)}year(e,t){return this.runFunction(e.args,t,this.metadata("YEAR"),e=>this.dateTimeHelper.numberToSimpleDate(e).year)}hour(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),e=>(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).hours)}minute(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),e=>(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).minutes)}second(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),e=>(0,i.numberToSimpleTime)((0,i.roundToNearestSecond)(e)%1).seconds)}text(e,t){return this.runFunction(e.args,t,this.metadata("TEXT"),(e,t)=>(0,s.format)(e,t,this.config,this.dateTimeHelper))}weekday(e,t){return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(e,t)=>{let r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;let i=d.get(t);return void 0===i?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode):(r-i)%7+1})}weeknum(e,t){return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(e,t)=>{let r=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.dateToNumber({year:i.year,month:1,day:1}),o=this.dateTimeHelper.relativeNumberToAbsoluteNumber(s);if(21===t)return this.isoweeknumCore(e);let u=d.get(t);return void 0===u?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode):Math.floor((r-u)/7)-Math.floor((o-u)/7)+1})}isoweeknum(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}datevalue(e,t){return this.runFunction(e.args,t,this.metadata("DATEVALUE"),e=>{let{dateTime:t}=this.dateTimeHelper.parseDateTimeFromConfigFormats(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,i.instanceOfSimpleDate)(t)?((0,i.instanceOfSimpleTime)(t)?Math.trunc((0,i.timeToNumber)(t)):0)+this.dateTimeHelper.dateToNumber(t):0})}timevalue(e,t){return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),e=>{let t=this.dateTimeHelper.dateStringToDateNumber(e);return void 0===t?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.IncorrectDateTime):(0,o.getRawValue)(t)%1})}now(e,t){return this.runFunction(e.args,t,this.metadata("NOW"),()=>{let e=new Date(Date.now());return(0,i.timeToNumber)({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}today(e,t){return this.runFunction(e.args,t,this.metadata("TODAY"),()=>{let e=new Date(Date.now());return this.dateTimeHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()})})}edate(e,t){return this.runFunction(e.args,t,this.metadata("EDATE"),(e,t)=>{let r=this.dateTimeHelper.numberToSimpleDate(e),s=(0,i.truncateDayInMonth)((0,i.offsetMonth)(r,t)),o=this.dateTimeHelper.dateToNumber(s);return void 0===(o=this.dateTimeHelper.getWithinBounds(o))?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.DateBounds):o})}datedif(e,t){return this.runFunction(e.args,t,this.metadata("DATEDIF"),(e,t,r)=>{if(e>t)return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);let i=this.dateTimeHelper.numberToSimpleDate(e),s=this.dateTimeHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(s.year-i.year)+(s.month-i.month)-(s.day<i.day);case"YM":return(s.month-i.month+12-(s.day<i.day))%12;case"Y":return s.month>i.month||s.month===i.month&&s.day>=i.day?s.year-i.year:s.year-i.year-1;case"MD":if(s.day>=i.day)return s.day-i.day;{let e=1===s.month?12:s.month-1,t=1===s.month?s.year-1:s.year;return this.dateTimeHelper.daysInMonth(t,e)+s.day-i.day}case"YD":return s.month>i.month||s.month===i.month&&s.day>=i.day?Math.floor(t)-this.dateTimeHelper.dateToNumber({year:s.year,month:i.month,day:i.day}):Math.floor(t)-Math.floor(e)-365*(s.year-i.year-1)-this.dateTimeHelper.leapYearsCount(s.year-1)+this.dateTimeHelper.leapYearsCount(i.year);default:return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode)}})}days360(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}yearfrac(e,t){return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(e,t,r)=>{switch((e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e]),r){case 0:return this.days360Core(e,t,!1)/360;case 1:return(t-e)/this.dateTimeHelper.yearLengthForBasis(this.dateTimeHelper.numberToSimpleDate(e),this.dateTimeHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return this.days360Core(e,t,!0)/360}throw Error("Should not be reachable.")})}interval(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),e=>{let t=(e=Math.trunc(e))%60,r=(e=Math.trunc(e/60))%60,n=(e=Math.trunc(e/60))%24,i=(e=Math.trunc(e/24))%30,a=(e=Math.trunc(e/30))%12,s=Math.trunc(e/12);return"P"+(s>0?s+"Y":"")+(a>0?a+"M":"")+(i>0?i+"D":"")+"T"+(n>0?n+"H":"")+(r>0?r+"M":"")+(t>0?t+"S":"")})}networkdays(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(e,t,r)=>this.networkdayscore(e,t,1,r))}networkdaysintl(e,t){return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(e,t,r,n)=>this.networkdayscore(e,t,r,n))}workday(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY"),(e,t,r)=>this.workdaycore(e,t,1,r))}workdayintl(e,t){return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(e,t,r,n)=>this.workdaycore(e,t,r,n))}networkdayscore(e,t,r,i){let a=1;(e=Math.trunc(e))>(t=Math.trunc(t))&&([e,t]=[t,e],a=-1);let s=h(r);if(s instanceof n.CellError)return s;let o=this.simpleRangeToFilteredHolidays(s,i);return o instanceof n.CellError?o:a*this.countWorkdays(e,t,s,o)}workdaycore(e,t,r,i){e=Math.trunc(e),t=Math.trunc(t);let a=h(r);if(a instanceof n.CellError)return a;let s=this.simpleRangeToFilteredHolidays(a,i);if(s instanceof n.CellError)return s;if(t>0){let r=1;for(;this.countWorkdays(e+1,e+r,a,s)<t;)r*=2;let n=1;for(;n+1<r;){let i=Math.trunc((n+r)/2);this.countWorkdays(e+1,e+i,a,s)<t?n=i:r=i}return e+r}if(t<0){t*=-1;let r=1;for(;this.countWorkdays(e-r,e-1,a,s)<t;)r*=2;let n=1;for(;n+1<r;){let i=Math.trunc((n+r)/2);this.countWorkdays(e-i,e-1,a,s)<t?n=i:r=i}return e-r}return e}countWorkdays(e,t,r,n){let i=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)),a=Math.floor(this.dateTimeHelper.relativeNumberToAbsoluteNumber(e)),s=0;for(let e=0;e<7;e++)"0"===r.charAt(e)&&(s+=Math.floor((i+6-e)/7),s-=Math.floor((a-1+6-e)/7));return s-(c(t+1,n)-c(e,n))}simpleRangeToFilteredHolidays(e,t){var r;let i=null!=(r=null==t?void 0:t.valuesFromTopLeftCorner())?r:[];for(let e of i)if(e instanceof n.CellError)return e;let s=[];for(let e of i)if(e!==o.EmptyValue){if(!(0,o.isExtendedNumber)(e))return new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.WrongType);s.push(Math.trunc((0,o.getRawValue)(e)))}return[...new Set(s)].sort((e,t)=>e-t).filter(t=>{let r=(this.dateTimeHelper.relativeNumberToAbsoluteNumber(t)-1)%7;return"0"===e.charAt(r)})}}function c(e,t){if(0===t.length||e<=t[0])return 0;if(t[t.length-1]<e)return t.length;let r=0,n=t.length-1;for(;r+1<n;){let i=Math.floor((n+r)/2);t[i]>=e?n=i:r=i}return n}function h(e){var t;return"number"!=typeof e&&"string"!=typeof e?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.WeekendString):null!=(t=p.get(e))?t:new n.CellError(n.ErrorType.NUM,a.ErrorMessage.BadMode)}t.DateTimePlugin=l,l.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:o.NumberType.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:o.NumberType.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:o.NumberType.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:u.FunctionArgumentType.STRING}],returnNumberType:o.NumberType.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:u.FunctionArgumentType.STRING}],returnNumberType:o.NumberType.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:o.NumberType.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:o.NumberType.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER}],returnNumberType:o.NumberType.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:u.FunctionArgumentType.NUMBER,minValue:0},{argumentType:u.FunctionArgumentType.NUMBER},{argumentType:u.FunctionArgumentType.NOERROR,defaultValue:1},{argumentType:u.FunctionArgumentType.RANGE,optionalArg:!0}]}};let d=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),p=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]])},function(e,t,r){"use strict";t.__esModule=!0,t.DegreesPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{degrees(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),e=>180/Math.PI*e)}}t.DegreesPlugin=i,i.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.DeltaPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{delta(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(e,t)=>+(e===t))}}t.DeltaPlugin=i,i.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:n.FunctionArgumentType.NUMBER},{argumentType:n.FunctionArgumentType.NUMBER,defaultValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ExpPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{exp(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}t.ExpPlugin=i,i.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.FinancialPlugin=void 0,r(2);var n=r(73),i=r(131),a=r(140),s=r(167);class o extends s.FunctionPlugin{pmt(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),u)}ipmt(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),l)}ppmt(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),h)}fv(e,t){return this.runFunction(e.args,t,this.metadata("FV"),c)}cumipmt(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(e,t,r,a,s,o)=>{if(a>s)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EndStartPeriod);let u=0;for(let n=a;n<=s;n++)u+=l(e,n,t,r,0,o);return u})}cumprinc(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(e,t,r,a,s,o)=>{if(a>s)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EndStartPeriod);let u=0;for(let n=a;n<=s;n++)u+=h(e,n,t,r,0,o);return u})}db(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(e,t,r,a,s)=>{if(12===s&&a>r||a>r+1)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.PeriodLong);if(t>=e)return 0;let o=Math.round(1e3*(1-Math.pow(t/e,1/r)))/1e3,u=e*o*s/12;if(1===a)return u;let l=u;for(let t=0;t<a-2;t++)l+=(e-l)*o;return a===r+1?(e-l)*o*(12-s)/12:(e-l)*o})}ddb(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(e,t,r,i,a)=>{if(i>r)return new n.CellError(n.ErrorType.NUM);let s,o=a/r;return o>=1?(o=1,s=1===i?e:0):s=e*Math.pow(1-o,i-1),Math.max(s-Math.max(t,e*Math.pow(1-o,i)),0)})}dollarde(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(e,t)=>{if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t})}dollarfr(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(e,t)=>{if(t<1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10})}effect(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(e,t)=>Math.pow(1+e/(t=Math.trunc(t)),t)-1)}ispmt(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(e,t,r,i)=>0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):i*e*(t/r-1))}nominal(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(e,t)=>(Math.pow(e+1,1/(t=Math.trunc(t)))-1)*t)}nper(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(e,t,r,i,a)=>0===e?0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):(-r-i)/t:(a&&(t*=1+e),Math.log((t-i*e)/(r*e+t))/Math.log(1+e)))}rate(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(e,t,r,i,a,s)=>{if(s<=-1)return new n.CellError(n.ErrorType.VALUE);let o=s;a=+!!a;for(let n=0;n<50;n++){let n,s;if(o<=-1)break;if(1e-7>Math.abs(o))n=r*(1+e*o)+t*(1+o*a)*e+i;else{let s=Math.pow(1+o,e);n=r*s+t*(1/o+a)*(s-1)+i}if(1e-7>Math.abs(n))return o;if(1e-7>Math.abs(o))s=r*e+t*a*e;else{let n=Math.pow(1+o,e),i=e*Math.pow(1+o,e-1);s=r*i+t*(1/o+a)*i+-1/(o*o)*t*(n-1)}o-=n/s}return new n.CellError(n.ErrorType.NUM)})}pv(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(e,t,r,i,a)=>(a=+!!a,-1===e?new n.CellError(0===t?n.ErrorType.NUM:n.ErrorType.DIV_BY_ZERO):0===e?-r*t-i:((1-Math.pow(1+e,t))*r*(1+e*a)/e-i)/Math.pow(1+e,t)))}rri(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(e,t,r)=>0===t||r<0&&t>0||r>0&&t<0?new n.CellError(n.ErrorType.NUM):Math.pow(r/t,1/e)-1)}sln(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(e,t,r)=>0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):(e-t)/r)}syd(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(e,t,r,i)=>i>r?new n.CellError(n.ErrorType.NUM):(e-t)*(r-i+1)*2/(r*(r+1)))}tbilleq(e,t){return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);let i=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);if(a.year>i.year+1||a.year===i.year+1&&(a.month>i.month||a.month===i.month&&a.day>i.day))return new n.CellError(n.ErrorType.NUM);let s=360-r*(t-e);return 0===s?0:s<0?new n.CellError(n.ErrorType.NUM):365*r/s})}tbillprice(e,t){return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);let i=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);if(a.year>i.year+1||a.year===i.year+1&&(a.month>i.month||a.month===i.month&&a.day>i.day))return new n.CellError(n.ErrorType.NUM);let s=360-r*(t-e);return 0===s?0:s<0?new n.CellError(n.ErrorType.NUM):100*(1-r*(t-e)/360)})}tbillyield(e,t){return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(e,t,r)=>{if((e=Math.round(e))>=(t=Math.round(t)))return new n.CellError(n.ErrorType.NUM);let i=this.dateTimeHelper.numberToSimpleDate(e),a=this.dateTimeHelper.numberToSimpleDate(t);return a.year>i.year+1||a.year===i.year+1&&(a.month>i.month||a.month===i.month&&a.day>i.day)?new n.CellError(n.ErrorType.NUM):360*(100-r)/(r*(t-e))})}fvschedule(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(e,t)=>{let r=t.valuesFromTopLeftCorner();for(let e of r)if(e instanceof n.CellError)return e;for(let t of r)if((0,a.isExtendedNumber)(t))e*=1+(0,a.getRawValue)(t);else if(t!==a.EmptyValue)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected);return e})}npv(e,t){return this.runFunction(e.args,t,this.metadata("NPV"),(e,...t)=>{let r=this.arithmeticHelper.coerceNumbersExactRanges(t);return r instanceof n.CellError?r:d(e,r)})}mirr(e,t){return this.runFunction(e.args,t,this.metadata("MIRR"),(e,t,r)=>{let i=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(i instanceof n.CellError)return i;let a=!1,s=!1,o=[],u=[];for(let e of i)e>0?(a=!0,o.push(e),u.push(0)):(e<0?(s=!0,u.push(e)):u.push(0),o.push(0));if(!a||!s)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let l=i.length,c=d(r,o);if(c instanceof n.CellError)return c;let h=d(t,u);return h instanceof n.CellError?h:Math.pow(-c*Math.pow(1+r,l)/h/(1+t),1/(l-1))-1})}pduration(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(e,t,r)=>(Math.log(r)-Math.log(t))/Math.log(1+e))}xnpv(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(e,t,r)=>{let a=t.valuesFromTopLeftCorner();for(let e of a)if("number"!=typeof e)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected);let s=r.valuesFromTopLeftCorner();for(let e of s)if("number"!=typeof e)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NumberExpected);if(s.length!==a.length)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.EqualLength);let o=s.length,u=0;if(s[0]<0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);for(let t=0;t<o;t++){if(s[t]=Math.floor(s[t]),s[t]<s[0])return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);u+=a[t]/Math.pow(1+e,(s[t]-s[0])/365)}return u})}}function u(e,t,r,n,i){if(0===e)return(-r-n)/t;{let a=Math.pow(1+e,t);return(n*e+r*e*a)*(i?1/(1+e):1)/(1-a)}}function l(e,t,r,n,i,a){let s=u(e,r,n,i,a);return 1===t?e*(a?0:-n):e*(a?c(e,t-2,s,n,a)-s:c(e,t-1,s,n,a))}function c(e,t,r,n,i){if(0===e)return-n-r*t;{let a=Math.pow(1+e,t);return r*(i?1+e:1)*(1-a)/e-n*a}}function h(e,t,r,n,i,a){return u(e,r,n,i,a)-l(e,t,r,n,i,a)}function d(e,t){let r=0;for(let i=t.length-1;i>=0;i--){if(r+=t[i],-1===e){if(0===r)continue;return new n.CellError(n.ErrorType.DIV_BY_ZERO)}r/=1+e}return r}t.FinancialPlugin=o,o.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:1},{argumentType:s.FunctionArgumentType.INTEGER,minValue:1},{argumentType:s.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:a.NumberType.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:1},{argumentType:s.FunctionArgumentType.INTEGER,minValue:1},{argumentType:s.FunctionArgumentType.INTEGER,minValue:0,maxValue:1}],returnNumberType:a.NumberType.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:a.NumberType.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.INTEGER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:a.NumberType.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:a.NumberType.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:1}],returnNumberType:a.NumberType.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:s.FunctionArgumentType.NUMBER,defaultValue:.1}],returnNumberType:a.NumberType.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:a.NumberType.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:a.NumberType.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0}],returnNumberType:a.NumberType.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.RANGE}],returnNumberType:a.NumberType.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1,returnNumberType:a.NumberType.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER}],returnNumberType:a.NumberType.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,greaterThan:-1},{argumentType:s.FunctionArgumentType.RANGE},{argumentType:s.FunctionArgumentType.RANGE}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.FormulaTextPlugin=void 0;var n=r(73),i=r(131),a=r(166),s=r(167);class o extends a.FunctionPlugin{formulatext(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),()=>new n.CellError(n.ErrorType.NA,i.ErrorMessage.WrongArgNumber),e=>{var t;return null!=(t=this.serialization.getCellFormula(e))?t:new n.CellError(n.ErrorType.NA,i.ErrorMessage.Formula)})}}t.FormulaTextPlugin=o,o.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:s.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0,vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.HyperlinkPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{hyperlink(e,t){return this.runFunction(e.args,t,this.metadata("HYPERLINK"),(t,r)=>(e.hyperlink=t,null!=r?r:t))}}t.HyperlinkPlugin=i,i.implementedFunctions={HYPERLINK:{method:"hyperlink",parameters:[{argumentType:n.FunctionArgumentType.STRING},{argumentType:n.FunctionArgumentType.STRING,optionalArg:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.InformationPlugin=void 0;var n=r(73),i=r(150),a=r(131),s=r(77),o=r(140),u=r(139),l=r(167);class c extends l.FunctionPlugin{isbinary(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),e=>/^[01]{1,10}$/.test(e))}iserr(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),e=>e instanceof n.CellError&&e.type!==n.ErrorType.NA)}iserror(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),e=>e instanceof n.CellError)}isformula(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),()=>new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber),e=>this.dependencyGraph.addressMapping.getCell(e)instanceof i.FormulaVertex)}isblank(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),e=>e===o.EmptyValue)}isna(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),e=>e instanceof n.CellError&&e.type==n.ErrorType.NA)}isnumber(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),o.isExtendedNumber)}islogical(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),e=>"boolean"==typeof e)}isref(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),e=>e instanceof n.CellError&&(e.type==n.ErrorType.REF||e.type==n.ErrorType.CYCLE))}istext(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),e=>"string"==typeof e)}isnontext(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),e=>"string"!=typeof e)}column(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),()=>t.formulaAddress.col+1,e=>e.col+1)}columns(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===s.AstNodeType.PARENTHESIS;)r=r.expression;if(r.type===s.AstNodeType.CELL_RANGE||r.type===s.AstNodeType.COLUMN_RANGE)return r.end.col-r.start.col+1;if(r.type===s.AstNodeType.CELL_REFERENCE)return 1;if(r.type===s.AstNodeType.ROW_RANGE)return this.config.maxColumns;{let e=this.evaluateAst(r,t);return e instanceof u.SimpleRangeValue?e.width():e instanceof n.CellError?e:1}}row(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),()=>t.formulaAddress.row+1,e=>e.row+1)}rows(e,t){if(1!==e.args.length)return new n.CellError(n.ErrorType.NA,a.ErrorMessage.WrongArgNumber);if(e.args.some(e=>e.type===s.AstNodeType.EMPTY))return new n.CellError(n.ErrorType.NUM,a.ErrorMessage.EmptyArg);let r=e.args[0];for(;r.type===s.AstNodeType.PARENTHESIS;)r=r.expression;if(r.type===s.AstNodeType.CELL_RANGE||r.type===s.AstNodeType.ROW_RANGE)return r.end.row-r.start.row+1;if(r.type===s.AstNodeType.CELL_REFERENCE)return 1;if(r.type===s.AstNodeType.COLUMN_RANGE)return this.config.maxRows;{let e=this.evaluateAst(r,t);return e instanceof u.SimpleRangeValue?e.height():e instanceof n.CellError?e:1}}index(e,t){return this.runFunction(e.args,t,this.metadata("INDEX"),(e,t,r)=>{var i,s,o,u,l,c;return r<1||t<1?new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.LessThanOne):r>e.width()||t>e.height()?new n.CellError(n.ErrorType.NUM,a.ErrorMessage.ValueLarge):null!=(c=null!=(o=null==(s=null==(i=null==e?void 0:e.data)?void 0:i[t-1])?void 0:s[r-1])?o:null==(l=null==(u=null==e?void 0:e.data)?void 0:u[0])?void 0:l[0])?c:new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRangeExpected)})}na(e,t){return new n.CellError(n.ErrorType.NA)}sheet(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEET"),()=>t.formulaAddress.sheet+1,e=>e.sheet+1,e=>{let t=this.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new n.CellError(n.ErrorType.NA,a.ErrorMessage.SheetRef)})}sheets(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("SHEETS"),()=>this.dependencyGraph.sheetMapping.numberOfSheets(),()=>1,()=>new n.CellError(n.ErrorType.VALUE,a.ErrorMessage.CellRefExpected))}}t.InformationPlugin=c,c.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:l.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},COLUMNS:{method:"columns",parameters:[{argumentType:l.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:l.FunctionArgumentType.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:l.FunctionArgumentType.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ISNA:{method:"isna",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}],vectorizationForbidden:!0},ISERROR:{method:"iserror",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:l.FunctionArgumentType.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER},{argumentType:l.FunctionArgumentType.NUMBER,defaultValue:1}]},NA:{method:"na",parameters:[]},ROW:{method:"row",parameters:[{argumentType:l.FunctionArgumentType.NOERROR,optionalArg:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},ROWS:{method:"rows",parameters:[{argumentType:l.FunctionArgumentType.RANGE}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEET:{method:"sheet",parameters:[{argumentType:l.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0},SHEETS:{method:"sheets",parameters:[{argumentType:l.FunctionArgumentType.STRING}],doesNotNeedArgumentsToBeComputed:!0,vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.IsEvenPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{iseven(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),e=>e%2==0)}}t.IsEvenPlugin=i,i.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.IsOddPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{isodd(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),e=>e%2==1)}}t.IsOddPlugin=i,i.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.LogarithmPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{log10(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}log(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(e,t)=>Math.log(e)/Math.log(t))}ln(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}t.LogarithmPlugin=i,i.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:n.FunctionArgumentType.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.PI=t.MathConstantsPlugin=void 0;var n=r(167);let i=t.PI=parseFloat(Math.PI.toFixed(14));class a extends n.FunctionPlugin{pi(e,t){return this.runFunction(e.args,t,this.metadata("PI"),()=>i)}sqrtpi(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),e=>Math.sqrt(i*e))}}t.MathConstantsPlugin=a,a.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,minValue:0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.MatrixPlugin=void 0,r(2);var n=r(1),i=r(73),a=r(131),s=r(77),o=r(165),u=r(139),l=r(167);function c(e,t){return new n.ArraySize(t.width,e.height)}function h(e,t,r){return new n.ArraySize(1+(e.width-t)/r,1+(e.height-t)/r)}class d extends l.FunctionPlugin{mmult(e,t){return this.runFunction(e.args,t,this.metadata("MMULT"),(e,t)=>{if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.NumberRange);if(t.height()!==e.width())return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.ArrayDimensions);let r=c(e.size,t.size),n=this.createKernel(function(e,t,r){let n=0;for(let i=0;i<r;++i)n+=e[this.thread.y][i]*t[i][this.thread.x];return n},r)(e.rawNumbers(),t.rawNumbers(),e.width());return u.SimpleRangeValue.onlyNumbers(n)})}mmultArraySize(e,t){if(2!==e.args.length)return n.ArraySize.error();let r=this.metadata("MMULT"),[i,a]=e.args.map(e=>{var n;return this.arraySizeForAst(e,new o.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(n=null==r?void 0:r.arrayFunction)&&n))});return c(i,a)}maxpool(e,t){return this.runFunction(e.args,t,this.metadata("MAXPOOL"),(e,t,r=t)=>{if(!e.hasOnlyNumbers())return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.NumberRange);let n=h(e.size,t,r),s=this.createKernel(function(e,t,r){let n=this.thread.x*r,i=this.thread.y*r,a=e[i][n];for(let r=0;r<t;r++)for(let s=0;s<t;s++)a=Math.max(a,e[i+r][n+s]);return a},n)(e.rawNumbers(),t,r);return u.SimpleRangeValue.onlyNumbers(s)})}medianpool(e,t){return this.runFunction(e.args,t,this.metadata("MEDIANPOOL"),(e,t,r=t)=>{if(!e.hasOnlyNumbers())return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.NumberRange);let n=h(e.size,t,r),s=this.createKernel(function(e,t,r){let n=this.thread.x*r,i=this.thread.y*r,a=e[i][n];for(let r=0;r<t;r++)for(let s=0;s<t;s++)a=Math.max(a,e[i+r][n+s]);let s=e[i][n];for(let r=0;r<t;r++)for(let a=0;a<t;a++)s=Math.min(s,e[i+r][n+a]);let o=t*t,u=s,l=a,c=42;for(let r=0;r<32;r++){let r=(u+l)/2,a=0;for(let s=0;s<t;s++)for(let o=0;o<t;o++)e[i+s][n+o]>r&&a++;if(t%2==0){if(a===o/2){c=r;break}a>o/2?u=r:l=r}else{if(a===(o-1)/2){c=r;break}a>(o-1)/2?u=r:l=r}}return c},n)(e.rawNumbers(),t,r);return u.SimpleRangeValue.onlyNumbers(s)})}maxpoolArraySize(e,t){let r;if(e.args.length<2||e.args.length>3)return n.ArraySize.error();let i=this.metadata("MAXPOOL"),a=e.args.map(e=>{var r;return this.arraySizeForAst(e,new o.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(r=null==i?void 0:i.arrayFunction)&&r))})[0],u=e.args[1],l=r=u.type===s.AstNodeType.NUMBER?u.value:1;if(3===e.args.length){let t=e.args[2];l=t.type===s.AstNodeType.NUMBER?t.value:1}return r>a.width||r>a.height||l>r||(a.width-r)%l!=0||(a.height-r)%l!=0?n.ArraySize.error():h(a,r,l)}medianpoolArraySize(e,t){return this.maxpoolArraySize(e,t)}transpose(e,t){return this.runFunction(e.args,t,this.metadata("TRANSPOSE"),e=>{let t=e.rawData(),r=e.size,n=[];for(let e=0;e<r.width;++e){n[e]=[];for(let i=0;i<r.height;++i)n[e][i]=t[i][e]}return u.SimpleRangeValue.onlyValues(n)})}transposeArraySize(e,t){if(1!==e.args.length)return n.ArraySize.error();let r=this.metadata("TRANSPOSE"),[i]=e.args.map(e=>{var n;return this.arraySizeForAst(e,new o.InterpreterState(t.formulaAddress,t.arraysFlag||null!=(n=null==r?void 0:r.arrayFunction)&&n))});return new n.ArraySize(i.height,i.width)}createKernel(e,t){return function(...r){let n=[];for(let i=0;i<t.height;++i){n.push([]);for(let a=0;a<t.width;++a)n[i][a]=e.apply({thread:{x:a,y:i}},r)}return n}}}t.MatrixPlugin=d,d.implementedFunctions={MMULT:{method:"mmult",arraySizeMethod:"mmultArraySize",parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},TRANSPOSE:{method:"transpose",arraySizeMethod:"transposeArraySize",parameters:[{argumentType:l.FunctionArgumentType.RANGE}],vectorizationForbidden:!0},MAXPOOL:{method:"maxpool",arraySizeMethod:"maxpoolArraySize",parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER},{argumentType:l.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0},MEDIANPOOL:{method:"medianpool",arraySizeMethod:"medianpoolArraySize",parameters:[{argumentType:l.FunctionArgumentType.RANGE},{argumentType:l.FunctionArgumentType.NUMBER},{argumentType:l.FunctionArgumentType.NUMBER,optionalArg:!0}],vectorizationForbidden:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.MedianPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{median(e,t){return this.runFunction(e.args,t,this.metadata("MEDIAN"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof n.CellError?t:0===t.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.OneValue):(t.sort((e,t)=>e-t),t.length%2==0?(t[t.length/2-1]+t[t.length/2])/2:t[Math.floor(t.length/2)])})}large(e,t){return this.runFunction(e.args,t,this.metadata("LARGE"),(e,t)=>{let r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof n.CellError?r:(r.sort((e,t)=>e-t),(t=Math.trunc(t))>r.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):r[r.length-t])})}small(e,t){return this.runFunction(e.args,t,this.metadata("SMALL"),(e,t)=>{let r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof n.CellError?r:(r.sort((e,t)=>e-t),(t=Math.trunc(t))>r.length?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):r[t-1])})}}t.MedianPlugin=s,s.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.NUMBER,minValue:1}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ModuloPlugin=void 0;var n=r(73),i=r(167);class a extends i.FunctionPlugin{mod(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(e,t)=>0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e%t)}}t.ModuloPlugin=a,a.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:i.FunctionArgumentType.NUMBER},{argumentType:i.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.NumericAggregationPlugin=void 0,r(2);var n=r(72),i=r(73),a=r(131),s=r(147),o=r(77),u=r(168),l=r(140),c=r(139),h=r(167);function d(e){return(0,l.isExtendedNumber)(e)&&!Number.isFinite((0,l.getRawValue)(e))?0:e}class p{constructor(e,t,r){this.sumsq=e,this.sum=t,this.count=r}static single(e){return new p(e*e,e,1)}compose(e){return new p(this.sumsq+e.sumsq,this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}varSValue(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}varPValue(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}p.empty=new p(0,0,0);class m extends h.FunctionPlugin{constructor(){super(...arguments),this.addWithEpsilonRaw=(e,t)=>this.arithmeticHelper.addWithEpsilonRaw(e,t)}sum(e,t){return this.doSum(e.args,t)}sumsq(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,e=>Math.pow((0,l.getRawValue)(e),2),g)}max(e,t){return this.doMax(e.args,t)}maxa(e,t){return d(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(e,t)=>Math.max(e,t),l.getRawValue,f))}min(e,t){return this.doMin(e.args,t)}mina(e,t){return d(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(e,t)=>Math.min(e,t),l.getRawValue,f))}count(e,t){return this.doCount(e.args,t)}counta(e,t){return this.doCounta(e.args,t)}average(e,t){return this.doAverage(e.args,t)}averagea(e,t){var r;let n=this.reduce(e.args,t,p.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>p.single((0,l.getRawValue)(e)),f);return n instanceof i.CellError?n:null!=(r=n.averageValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}vars(e,t){return this.doVarS(e.args,t)}varp(e,t){return this.doVarP(e.args,t)}vara(e,t){var r;let n=this.reduceAggregateA(e.args,t);return n instanceof i.CellError?n:null!=(r=n.varSValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}varpa(e,t){var r;let n=this.reduceAggregateA(e.args,t);return n instanceof i.CellError?n:null!=(r=n.varPValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}stdevs(e,t){return this.doStdevS(e.args,t)}stdevp(e,t){return this.doStdevP(e.args,t)}stdeva(e,t){let r=this.reduceAggregateA(e.args,t);if(r instanceof i.CellError)return r;{let e=r.varSValue();return void 0===e?new i.CellError(i.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}stdevpa(e,t){let r=this.reduceAggregateA(e.args,t);if(r instanceof i.CellError)return r;{let e=r.varPValue();return void 0===e?new i.CellError(i.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}product(e,t){return this.doProduct(e.args,t)}subtotal(e,t){if(e.args.length<2)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongArgNumber);let r=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:h.FunctionArgumentType.NUMBER},t),n=e.args.slice(1);switch(r){case 1:case 101:return this.doAverage(n,t);case 2:case 102:return this.doCount(n,t);case 3:case 103:return this.doCounta(n,t);case 4:case 104:return this.doMax(n,t);case 5:case 105:return this.doMin(n,t);case 6:case 106:return this.doProduct(n,t);case 7:case 107:return this.doStdevS(n,t);case 8:case 108:return this.doStdevP(n,t);case 9:case 109:return this.doSum(n,t);case 10:case 110:return this.doVarS(n,t);case 11:case 111:return this.doVarP(n,t);default:return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.BadMode)}}reduceAggregate(e,t){return this.reduce(e,t,p.empty,"_AGGREGATE",(e,t)=>e.compose(t),e=>p.single((0,l.getRawValue)(e)),g)}reduceAggregateA(e,t){return this.reduce(e,t,p.empty,"_AGGREGATE_A",(e,t)=>e.compose(t),e=>p.single((0,l.getRawValue)(e)),f)}doAverage(e,t){var r;let n=this.reduceAggregate(e,t);return n instanceof i.CellError?n:null!=(r=n.averageValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}doVarS(e,t){var r;let n=this.reduceAggregate(e,t);return n instanceof i.CellError?n:null!=(r=n.varSValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}doVarP(e,t){var r;let n=this.reduceAggregate(e,t);return n instanceof i.CellError?n:null!=(r=n.varPValue())?r:new i.CellError(i.ErrorType.DIV_BY_ZERO)}doStdevS(e,t){let r=this.reduceAggregate(e,t);if(r instanceof i.CellError)return r;{let e=r.varSValue();return void 0===e?new i.CellError(i.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}doStdevP(e,t){let r=this.reduceAggregate(e,t);if(r instanceof i.CellError)return r;{let e=r.varPValue();return void 0===e?new i.CellError(i.ErrorType.DIV_BY_ZERO):Math.sqrt(e)}}doCount(e,t){return this.reduce(e,t,0,"COUNT",(e,t)=>e+t,l.getRawValue,e=>+!!(0,l.isExtendedNumber)(e))}doCounta(e,t){return this.reduce(e,t,0,"COUNTA",(e,t)=>e+t,l.getRawValue,e=>+(e!==l.EmptyValue))}doMax(e,t){return d(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(e,t)=>Math.max(e,t),l.getRawValue,g))}doMin(e,t){return d(this.reduce(e,t,Number.POSITIVE_INFINITY,"MIN",(e,t)=>Math.min(e,t),l.getRawValue,g))}doSum(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,l.getRawValue,g)}doProduct(e,t){return this.reduce(e,t,1,"PRODUCT",(e,t)=>e*t,l.getRawValue,g)}reduce(e,t,r,n,s,u,l){return e.length<1?new i.CellError(i.ErrorType.NA,a.ErrorMessage.WrongArgNumber):e.reduce((e,a)=>{let h;if(e instanceof i.CellError)return e;if(a.type===o.AstNodeType.CELL_RANGE||a.type===o.AstNodeType.COLUMN_RANGE||a.type===o.AstNodeType.ROW_RANGE){let o=this.evaluateRange(a,t,r,n,s,u,l);return o instanceof i.CellError?o:s(o,e)}if((h=this.evaluateAst(a,t))instanceof c.SimpleRangeValue)return Array.from(h.valuesFromTopLeftCorner()).map(l).filter(e=>void 0!==e).map(e=>e instanceof i.CellError?e:u(e)).reduce((e,t)=>e instanceof i.CellError?e:t instanceof i.CellError?t:s(e,t),e);if(a.type===o.AstNodeType.CELL_REFERENCE){if(void 0===(h=l(h)))return e}else if(void 0===(h=l(h=this.coerceScalarToNumberOrError(h))))return e;return h instanceof i.CellError?h:s(e,u(h))},r)}evaluateRange(e,t,r,o,u,l,c){let h;try{h=n.AbsoluteCellRange.fromAst(e,t.formulaAddress)}catch(e){if(e instanceof s.SheetsNotEqual)return new i.CellError(i.ErrorType.REF,a.ErrorMessage.RangeManySheets);throw e}let d=this.dependencyGraph.getRange(h.start,h.end);if(void 0===d)throw Error("Range does not exists in graph");let p=d.getFunctionValue(o);return void 0===p&&(p=this.getRangeValues(o,h,d,l,c).reduce((e,t)=>e instanceof i.CellError?e:t instanceof i.CellError?t:u(e,t),r),d.setFunctionValue(o,p)),p}getRangeValues(e,t,r,n,a){let s,o=[],{smallerRangeVertex:u,restRange:l}=this.dependencyGraph.rangeMapping.findSmallerRange(t);if(void 0!==u&&this.dependencyGraph.existsEdge(u,r)){let t=u.getFunctionValue(e);if(void 0!==t)o.push(t);else for(let e of u.range.addresses(this.dependencyGraph)){let t=a(this.dependencyGraph.getScalarValue(e));t instanceof i.CellError?o.push(t):void 0!==t&&o.push(n(t))}s=l}else s=t;for(let e of s.addresses(this.dependencyGraph)){let t=a(this.dependencyGraph.getScalarValue(e));t instanceof i.CellError?o.push(t):void 0!==t&&o.push(n(t))}return o}}function g(e){return(0,l.isExtendedNumber)(e)||e instanceof i.CellError?e:void 0}function f(e){return"boolean"==typeof e?(0,u.coerceBooleanToNumber)(e):(0,l.isExtendedNumber)(e)||e instanceof i.CellError?e:"string"==typeof e?0:void 0}t.NumericAggregationPlugin=m,m.implementedFunctions={SUM:{method:"sum",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},SUMSQ:{method:"sumsq",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MAX:{method:"max",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MIN:{method:"min",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MAXA:{method:"maxa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},MINA:{method:"mina",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNT:{method:"count",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},COUNTA:{method:"counta",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGE:{method:"average",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},AVERAGEA:{method:"averagea",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},PRODUCT:{method:"product",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.S":{method:"vars",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"VAR.P":{method:"varp",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},VARA:{method:"vara",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},VARPA:{method:"varpa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.S":{method:"stdevs",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},"STDEV.P":{method:"stdevp",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVA:{method:"stdeva",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},STDEVPA:{method:"stdevpa",parameters:[{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1},SUBTOTAL:{method:"subtotal",parameters:[{argumentType:h.FunctionArgumentType.NUMBER},{argumentType:h.FunctionArgumentType.ANY}],repeatLastArgs:1}},m.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"}},function(e,t,r){"use strict";t.__esModule=!0,t.PowerPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{power(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}t.PowerPlugin=i,i.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:n.FunctionArgumentType.NUMBER},{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RadiansPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{radians(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),e=>Math.PI/180*e)}}t.RadiansPlugin=i,i.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RadixConversionPlugin=void 0;var n=r(73),i=r(131),a=r(176),s=r(167);class o extends s.FunctionPlugin{dec2bin(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(e,t)=>l(e,2,t))}dec2oct(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(e,t)=>l(e,8,t))}dec2hex(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(e,t)=>l(e,16,t))}bin2dec(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),e=>{let t=u(e,2,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):p(t,2)})}bin2oct(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(e,t)=>{let r=u(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):l(p(r,2),8,t)})}bin2hex(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(e,t)=>{let r=u(e,2,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotBinary):l(p(r,2),16,t)})}oct2dec(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),e=>{let t=u(e,8,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):p(t,8)})}oct2bin(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(e,t)=>{let r=u(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):l(p(r,8),2,t)})}oct2hex(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(e,t)=>{let r=u(e,8,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotOctal):l(p(r,8),16,t)})}hex2dec(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),e=>{let t=u(e,16,10);return void 0===t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):p(t,16)})}hex2bin(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(e,t)=>{let r=u(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):l(p(r,16),2,t)})}hex2oct(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(e,t)=>{let r=u(e,16,10);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):l(p(r,16),8,t)})}base(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),h)}decimal(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(e,t)=>{let r=u(e,t,255);return void 0===r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NotHex):parseInt(r,t)})}}function u(e,t,r){let n=RegExp(`^[${"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t)}]+$`);if(!(e.length>r)&&n.test(e))return e}function l(e,t,r){if(e>-c(t)-1)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLarge);if(e<c(t))return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseSmall);let s=d(e,t);return void 0===r||e<0?s:s.length>r?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueBaseLong):(0,a.padLeft)(s,r)}function c(e){return-Math.pow(e,10)/2}function h(e,t,r){let n=d(e,t);return void 0!==r&&r>n.length?(0,a.padLeft)(n,r):n}function d(e,t){return(e+(e<0?Math.pow(t,10):0)).toString(t).toUpperCase()}function p(e,t){let r=parseInt(e,t),n=Math.pow(t,10);return r>=n/2?r-n:r}t.RadixConversionPlugin=o,o.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:s.FunctionArgumentType.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},DECIMAL:{method:"decimal",parameters:[{argumentType:s.FunctionArgumentType.STRING},{argumentType:s.FunctionArgumentType.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:0},{argumentType:s.FunctionArgumentType.NUMBER,minValue:2,maxValue:36},{argumentType:s.FunctionArgumentType.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RandomPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{rand(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}randbetween(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(e,t)=>t<e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e))))}}t.RandomPlugin=s,s.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}],isVolatile:!0}}},function(e,t,r){"use strict";t.__esModule=!0,t.RoundingPlugin=void 0,t.findNextEvenNumber=o,t.findNextOddNumber=s;var n=r(73),i=r(131),a=r(167);function s(e){let t=Math.ceil(e);return t%2==1?t:t+1}function o(e){let t=Math.ceil(e);return t%2==0?t:t+1}class u extends a.FunctionPlugin{roundup(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{let r=Math.pow(10,t);return e<0?-Math.ceil(-e*r)/r:Math.ceil(e*r)/r})}rounddown(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(e,t)=>{let r=Math.pow(10,t);return e<0?-Math.floor(-e*r)/r:Math.floor(e*r)/r})}round(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(e,t)=>{let r=Math.pow(10,t);return e<0?-Math.round(-e*r)/r:Math.round(e*r)/r})}intFunc(e,t){return this.runFunction(e.args,t,this.metadata("INT"),e=>e<0?-Math.floor(-e):Math.floor(e))}even(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),e=>e<0?-o(-e):o(e))}odd(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),e=>e<0?-s(-e):s(e))}ceilingmath(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t=-t),Math.ceil(e/t)*t))}ceiling(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e>0&&t<0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.ceil(e/t)*t)}ceilingprecise(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(e,t)=>0===t||0===e?0:Math.ceil(e/(t=Math.abs(t)))*t)}floormath(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(e,t,r)=>0===t||0===e?0:(t=Math.abs(t),1===r&&e<0&&(t*=-1),Math.floor(e/t)*t))}floor(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(e,t)=>0===e?0:0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):e>0&&t<0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.floor(e/t)*t)}floorprecise(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(e,t)=>0===t||0===e?0:Math.floor(e/(t=Math.abs(t)))*t)}}t.RoundingPlugin=u,u.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]}},u.aliases={"ISO.CEILING":"CEILING.PRECISE",TRUNC:"ROUNDDOWN"}},function(e,t,r){"use strict";t.__esModule=!0,t.SqrtPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{sqrt(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}t.SqrtPlugin=i,i.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:n.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ConditionalAggregationPlugin=void 0,r(2);var n=r(73),i=r(131),a=r(251),s=r(140),o=r(167);class u{constructor(e,t){this.sum=e,this.count=t}static single(e){return new u(e,1)}compose(e){return new u(this.sum+e.sum,this.count+e.count)}averageValue(){return this.count>0?this.sum/this.count:void 0}}function l(e){return(0,s.isExtendedNumber)(e)&&!Number.isFinite((0,s.getRawValue)(e))?0:e}function c(e){return e instanceof n.CellError?e:(0,s.isExtendedNumber)(e)?(0,s.getRawValue)(e):void 0}u.empty=new u(0,0);class h extends o.FunctionPlugin{sumif(e,t){return this.runFunction(e.args,t,this.metadata("SUMIF"),(e,t,r)=>this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],"SUMIF",0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),c))}sumifs(e,t){return this.runFunction(e.args,t,this.metadata("SUMIFS"),(e,...t)=>this.computeConditionalAggregationFunction(e,t,"SUMIFS",0,(e,t)=>this.arithmeticHelper.nonstrictadd(e,t),c))}averageif(e,t){return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(e,t,r)=>{let i=this.computeConditionalAggregationFunction(null!=r?r:e,[e,t],"AVERAGEIF",u.empty,(e,t)=>e.compose(t),e=>(0,s.isExtendedNumber)(e)?u.single((0,s.getRawValue)(e)):u.empty);return i instanceof n.CellError?i:i.averageValue()||new n.CellError(n.ErrorType.DIV_BY_ZERO)})}countif(e,t){return this.runFunction(e.args,t,this.metadata("COUNTIF"),(e,t)=>this.computeConditionalAggregationFunction(e,[e,t],"COUNTIF",0,(e,t)=>e+t,()=>1))}countifs(e,t){return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(...e)=>this.computeConditionalAggregationFunction(e[0],e,"COUNTIFS",0,(e,t)=>e+t,()=>1))}minifs(e,t){let r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.min(e,t);return this.runFunction(e.args,t,this.metadata("MINIFS"),(e,...t)=>l(this.computeConditionalAggregationFunction(e,t,"MINIFS",Number.POSITIVE_INFINITY,r,c)))}maxifs(e,t){let r=(e,t)=>void 0===t||void 0===e?void 0===t?e:t:Math.max(e,t);return this.runFunction(e.args,t,this.metadata("MAXIFS"),(e,...t)=>l(this.computeConditionalAggregationFunction(e,t,"MAXIFS",Number.NEGATIVE_INFINITY,r,c)))}computeConditionalAggregationFunction(e,t,r,s,o,u){let l=[];for(let e=0;e<t.length;e+=2){let r=t[e],s=this.interpreter.criterionBuilder.fromCellValue(t[e+1],this.arithmeticHelper);if(void 0===s)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.BadCriterion);l.push(new a.Condition(r,s))}return new a.CriterionFunctionCompute(this.interpreter,e=>[r,...e.map(e=>`${e.conditionRange.range.sheet},${e.conditionRange.range.start.col},${e.conditionRange.range.start.row}`)].join(","),s,o,u).compute(e,l)}}t.ConditionalAggregationPlugin=h,h.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR},{argumentType:o.FunctionArgumentType.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR},{argumentType:o.FunctionArgumentType.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MINIFS:{method:"minifs",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR}],repeatLastArgs:2},MAXIFS:{method:"maxifs",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NOERROR}],repeatLastArgs:2}}},function(e,t,r){"use strict";t.__esModule=!0,t.CriterionFunctionCompute=t.Condition=void 0,r(2);var n=r(73),i=r(131),a=r(252),s=r(140);function*o(e,t){for(let r of t.addresses(e))yield(0,s.getRawValue)(e.getScalarValue(r))}function*u(e,t,r){for(let n of r){let r=t.map(e=>(0,a.split)(e));if(!r.every(e=>Object.prototype.hasOwnProperty.call(e,"value")))return;(function(e,t){let r=[];for(let n=0;n<Math.min(e.length,t.length);n++)r.push([e[n],t[n]]);return r})(r.map(e=>(0,s.getRawValue)(e.value)),e).every(([e,t])=>t(e))&&(yield n),t=r.map(e=>e.rest)}}t.CriterionFunctionCompute=class{constructor(e,t,r,n,i){this.interpreter=e,this.cacheKey=t,this.reduceInitialValue=r,this.composeFunction=n,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}compute(e,t){for(let r of t)if(!r.conditionRange.sameDimensionsAs(e))return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EqualLength);let r=this.tryToGetRangeVertexForRangeValue(e),a=t.map(e=>this.tryToGetRangeVertexForRangeValue(e.conditionRange));if(r&&a.every(e=>void 0!==e)){let n=t.map(e=>e.criterionPackage.raw).join(","),i=this.findAlreadyComputedValueInCache(r,this.cacheKey(t),n);if(void 0!==i)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),i;let s=this.buildNewCriterionCache(this.cacheKey(t),t.map(e=>e.conditionRange.range),e.range);return s.has(n)||s.set(n,[this.evaluateRangeValue(e,t),t.map(e=>e.criterionPackage.lambda)]),r.setCriterionFunctionValues(this.cacheKey(t),s),a.forEach(e=>{void 0!==e&&e.addDependentCacheRange(r)}),s.get(n)[0]}return this.evaluateRangeValue(e,t)}tryToGetRangeVertexForRangeValue(e){let t=e.range;return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}reduceFunction(e){let t=this.reduceInitialValue;for(let r of e)t=this.composeFunction(t,r);return t}findAlreadyComputedValueInCache(e,t,r){return e.getCriterionFunctionValue(t,r)}evaluateRangeValue(e,t){let r=t.map(e=>e.criterionPackage.lambda),n=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),i=u(r,t.map(e=>e.conditionRange.iterateValuesFromTopLeftCorner()),n);return this.reduceFunction(i)}buildNewCriterionCache(e,t,r){let i,a=this.dependencyGraph.getRange(r.start,r.end),{smallerRangeVertex:s,restConditionRanges:l,restValuesRange:c}=((e,t,r)=>{if(r.end.row>r.start.row){let i=(0,n.simpleCellAddress)(r.end.sheet,r.end.col,r.end.row-1),a=e.getRange(r.start,i);if(void 0!==a)return{smallerRangeVertex:a,restValuesRange:r.withStart((0,n.simpleCellAddress)(r.start.sheet,r.start.col,r.end.row)),restConditionRanges:t.map(e=>e.withStart((0,n.simpleCellAddress)(e.start.sheet,e.start.col,e.end.row)))}}return{restValuesRange:r,restConditionRanges:t}})(this.dependencyGraph,t,r);i=void 0!==s&&this.dependencyGraph.existsEdge(s,a)?s.getCriterionFunctionValues(e):new Map;let h=new Map;return i.forEach(([e,t],r)=>{let n=u(t,l.map(e=>o(this.dependencyGraph,e)),Array.from(o(this.dependencyGraph,c)).map(this.mapFunction)[Symbol.iterator]()),i=this.composeFunction(e,this.reduceFunction(n));this.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),h.set(r,[i,t])}),h}},t.Condition=class{constructor(e,t){this.conditionRange=e,this.criterionPackage=t}}},function(e,t,r){"use strict";function*n(){}t.__esModule=!0,t.empty=n,t.first=function(e){let{done:t,value:r}=e[Symbol.iterator]().next();if(!t)return r},t.split=function(e){let t=e[Symbol.iterator](),{done:r,value:i}=t.next();return r?{rest:n()}:{value:i,rest:t}}},function(e,t,r){"use strict";t.__esModule=!0,t.SumprodPlugin=void 0;var n=r(73),i=r(131),a=r(140),s=r(167);class o extends s.FunctionPlugin{sumproduct(e,t){return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(...e)=>{let t=e[0].width(),r=e[0].height();for(let a of e)if(a.width()!==t||a.height()!==r)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.EqualLength);let s=0,o=e.map(e=>e.iterateValuesFromTopLeftCorner());for(let e=0;e<t*r;e++){let e=1;for(let t of o){let r=t.next().value;if(r instanceof n.CellError)return r;let i=this.coerceScalarToNumberOrError(r);(0,a.isExtendedNumber)(i)?e*=(0,a.getRawValue)(i):e=0}s+=e}return s})}}t.SumprodPlugin=o,o.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:s.FunctionArgumentType.RANGE}],repeatLastArgs:1}}},function(e,t,r){"use strict";t.__esModule=!0,t.TextPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{concatenate(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(...e)=>"".concat(...e))}split(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(e,t)=>{let r=e.split(" ");return t>=r.length||t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.IndexBounds):r[t]})}len(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),e=>e.length)}lower(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),e=>e.toLowerCase())}trim(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),e=>e.replace(/^ +| +$/g,"").replace(/ +/g," "))}proper(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),e=>e.replace(/\p{L}+/gu,e=>e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()))}clean(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),e=>e.replace(/[\u0000-\u001F]/g,""))}exact(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(e,t)=>e===t)}rept(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeCount):e.repeat(t))}right(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):0===t?"":e.slice(-t))}left(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(e,t)=>t<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.slice(0,t))}mid(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(e,t,r)=>t<1?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.substring(t-1,t+r-1))}replace(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(e,t,r,a)=>t<1?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne):r<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.NegativeLength):e.substring(0,t-1)+a+e.substring(t+r-1))}search(e,t){return this.runFunction(e.args,t,this.metadata("SEARCH"),(e,t,r)=>{if(r<1||r>t.length)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LengthBounds);let a=e.toLowerCase(),s=t.substring(r-1).toLowerCase(),o=this.arithmeticHelper.requiresRegex(a)?this.arithmeticHelper.searchString(a,s):s.indexOf(a);return o>-1?o+r:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.PatternNotFound)})}substitute(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(e,t,r,a)=>{let s=RegExp(this.escapeRegExpSpecialCharacters(t),"g");if(void 0===a)return e.replace(s,r);if(a<1)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.LessThanOne);let o,u=0;for(;null!==(o=s.exec(e));)if(a===++u)return e.substring(0,o.index)+r+e.substring(s.lastIndex);return e})}find(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(e,t,r)=>{if(r<1||r>t.length)return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.IndexBounds);let a=t.substring(r-1).indexOf(e)+r;return a>0?a:new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.PatternNotFound)})}t(e,t){return this.runFunction(e.args,t,this.metadata("T"),e=>e instanceof n.CellError||"string"==typeof e?e:"")}upper(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),e=>e.toUpperCase())}escapeRegExpSpecialCharacters(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}}t.TextPlugin=s,s.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:a.FunctionArgumentType.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},MID:{method:"mid",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},T:{method:"t",parameters:[{argumentType:a.FunctionArgumentType.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:a.FunctionArgumentType.STRING}]},REPT:{method:"rept",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.STRING},{argumentType:a.FunctionArgumentType.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:a.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.TrigonometryPlugin=void 0;var n=r(73),i=r(131),a=r(167),s=r(239);class o extends a.FunctionPlugin{acos(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}asin(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}cos(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}sin(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}tan(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}atan(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}atan2(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(e,t)=>0===e&&0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}cot(e,t){return this.runFunction(e.args,t,this.metadata("COT"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tan(e))}acot(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),e=>0===e?s.PI/2:Math.atan(1/e))}sec(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),e=>1/Math.cos(e))}csc(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sin(e))}sinh(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}asinh(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}cosh(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}acosh(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}tanh(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}atanh(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}coth(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.tanh(e))}acoth(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),e=>0===e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NonZero):Math.atanh(1/e))}sech(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),e=>1/Math.cosh(e))}csch(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),e=>0===e?new n.CellError(n.ErrorType.DIV_BY_ZERO):1/Math.sinh(e))}}t.TrigonometryPlugin=o,o.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.LookupPlugin=void 0;var n=r(72),i=r(73),a=r(131),s=r(257),o=r(142),u=r(168),l=r(139),c=r(167);class h extends c.FunctionPlugin{constructor(){super(...arguments),this.rowSearch=new s.RowSearchStrategy(this.dependencyGraph)}vlookup(e,t){return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(e,t,r,n)=>{let s=t.range;return void 0===s?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):r<1?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne):r>s.width()?new i.CellError(i.ErrorType.REF,a.ErrorMessage.IndexLarge):this.doVlookup((0,u.zeroIfEmpty)(e),t,r-1,n)})}hlookup(e,t){return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(e,t,r,n)=>{let s=t.range;return void 0===s?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):r<1?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.LessThanOne):r>s.height()?new i.CellError(i.ErrorType.REF,a.ErrorMessage.IndexLarge):this.doHlookup((0,u.zeroIfEmpty)(e),t,r-1,n)})}match(e,t){return this.runFunction(e.args,t,this.metadata("MATCH"),(e,t,r)=>this.doMatch((0,u.zeroIfEmpty)(e),t,r))}searchInRange(e,t,r,n){return!r&&"string"==typeof e&&this.arithmeticHelper.requiresRegex(e)?n.advancedFind(this.arithmeticHelper.eqMatcherFunction(e),t):n.find(e,t,r?{ordering:"asc"}:{ordering:"none",matchExactly:!0})}doVlookup(e,t,r,s){let u,c;this.dependencyGraph.stats.start(o.StatType.VLOOKUP);let h=t.range;u=void 0===h?l.SimpleRangeValue.onlyValues(t.data.map(e=>[e[0]])):l.SimpleRangeValue.onlyRange(n.AbsoluteCellRange.spanFrom(h.start,1,h.height()),this.dependencyGraph);let d=this.searchInRange(e,u,s,this.columnSearch);if(this.dependencyGraph.stats.end(o.StatType.VLOOKUP),-1===d)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound);if(void 0===h)c=t.data[d][r];else{let e=(0,i.simpleCellAddress)(h.sheet,h.start.col+r,h.start.row+d);c=this.dependencyGraph.getCellValue(e)}return c instanceof l.SimpleRangeValue?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):c}doHlookup(e,t,r,s){let o,u,c=t.range;o=void 0===c?l.SimpleRangeValue.onlyValues([t.data[0]]):l.SimpleRangeValue.onlyRange(n.AbsoluteCellRange.spanFrom(c.start,c.width(),1),this.dependencyGraph);let h=this.searchInRange(e,o,s,this.rowSearch);if(-1===h)return new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound);if(void 0===c)u=t.data[r][h];else{let e=(0,i.simpleCellAddress)(c.sheet,c.start.col+h,c.start.row+r);u=this.dependencyGraph.getCellValue(e)}return u instanceof l.SimpleRangeValue?new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.WrongType):u}doMatch(e,t,r){if(![-1,0,1].includes(r))return new i.CellError(i.ErrorType.VALUE,a.ErrorMessage.BadMode);if(t.width()>1&&t.height()>1)return new i.CellError(i.ErrorType.NA);let n=(1===t.width()?this.columnSearch:this.rowSearch).find(e,t,0===r?{ordering:"none",matchExactly:!0}:{ordering:-1===r?"desc":"asc"});return -1===n?new i.CellError(i.ErrorType.NA,a.ErrorMessage.ValueNotFound):n+1}}t.LookupPlugin=h,h.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:c.FunctionArgumentType.NOERROR},{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER},{argumentType:c.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:c.FunctionArgumentType.NOERROR},{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER},{argumentType:c.FunctionArgumentType.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:c.FunctionArgumentType.NOERROR},{argumentType:c.FunctionArgumentType.RANGE},{argumentType:c.FunctionArgumentType.NUMBER,defaultValue:1}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.RowSearchStrategy=void 0;var n=r(208);class i extends n.AdvancedFind{constructor(e){super(e),this.dependencyGraph=e}find(e,t,r){return this.basicFind(e,t,"col",r)}}t.RowSearchStrategy=i},function(e,t,r){"use strict";t.__esModule=!0,t.RomanPlugin=void 0;var n=r(73),i=r(131),a=r(140),s=r(167);class o extends s.FunctionPlugin{roman(e,t){return this.runFunction(e.args,t,this.metadata("ROMAN"),(e,t)=>(e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=(0,a.getRawValue)(this.coerceScalarToNumberOrError(t)))instanceof n.CellError?t:(t=Math.trunc(t))<0?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ValueSmall):t>4?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ValueLarge):function(e,t){let r={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(l(r,"IM",999,1e3),l(r,"ID",499,500)),t>=3&&(l(r,"VM",995,1e3),l(r,"VD",495,500)),t>=2&&(l(r,"XM",990,1e3),l(r,"XD",490,500)),t>=1&&(l(r,"LM",950,1e3),l(r,"LD",450,500)),l(r,"CM",900,1e3),l(r,"CD",400,500),l(r,"D",500,900),r.acc+="C".repeat(Math.floor(r.val/100)),r.val%=100,t>=2&&(l(r,"IC",99,100),l(r,"IL",49,50)),t>=1&&(l(r,"VC",95,100),l(r,"VL",45,50)),l(r,"XC",90,100),l(r,"XL",40,50),l(r,"L",50,90),r.acc+="X".repeat(Math.floor(r.val/10)),r.val%=10,l(r,"IX",9,10),l(r,"IV",4,5),l(r,"V",5,9),r.acc+="I".repeat(r.val),r.acc}(e,t)))}arabic(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),e=>{let t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.InvalidRoman);let r={input:e,acc:0};return u(r,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),u(r,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),u(r,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),u(r,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),u(r,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),u(r,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),u(r,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),u(r,{token:"IX",val:9}),u(r,{token:"V",val:5},{token:"IV",val:4}),u(r,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==r.input?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.InvalidRoman):t?-r.acc:r.acc})}}function u(e,...t){for(let r of t)if(e.input.startsWith(r.token)){e.input=e.input.slice(r.token.length),e.acc+=r.val;break}}function l(e,t,r,n){e.val>=r&&e.val<n&&(e.val-=r,e.acc+=t)}t.RomanPlugin=o,o.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:s.FunctionArgumentType.NUMBER,minValue:1,lessThan:4e3},{argumentType:s.FunctionArgumentType.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:s.FunctionArgumentType.STRING}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.SimpleArithmerticPlugin=void 0;var n=r(167);class i extends n.FunctionPlugin{add(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.arithmeticHelper.addWithEpsilon)}concat(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.arithmeticHelper.concat)}divide(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.arithmeticHelper.divide)}eq(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.arithmeticHelper.eq)}gt(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.arithmeticHelper.gt)}gte(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.arithmeticHelper.geq)}lt(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.arithmeticHelper.lt)}lte(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.arithmeticHelper.leq)}minus(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.arithmeticHelper.subtract)}multiply(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.arithmeticHelper.multiply)}ne(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.arithmeticHelper.neq)}pow(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.arithmeticHelper.pow)}uminus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.arithmeticHelper.unaryMinus)}upercent(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.arithmeticHelper.unaryPercent)}uplus(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.arithmeticHelper.unaryPlus)}}t.SimpleArithmerticPlugin=i,i.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:n.FunctionArgumentType.STRING,passSubtype:!0},{argumentType:n.FunctionArgumentType.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0},{argumentType:n.FunctionArgumentType.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0},{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:n.FunctionArgumentType.NUMBER,passSubtype:!0}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.StatisticalPlugin=void 0;var n=r(73),i=r(131),a=r(261),s=r(262),o=r(167);class u extends o.FunctionPlugin{erf(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(e,t)=>void 0===t?(0,s.erf)(e):(0,s.erf)(t)-(0,s.erf)(e))}erfc(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),s.erfc)}expondist(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(e,t,r)=>r?s.exponential.cdf(e,t):s.exponential.pdf(e,t))}fisher(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),e=>Math.log((1+e)/(1-e))/2)}fisherinv(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),e=>1-2/(Math.exp(2*e)+1))}gamma(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),s.gammafn)}gammadist(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(e,t,r,n)=>n?s.gamma.cdf(e,t,r):s.gamma.pdf(e,t,r))}gammaln(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),s.gammaln)}gammainv(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),s.gamma.inv)}gauss(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),e=>s.normal.cdf(e,0,1)-.5)}betadist(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(e,t,r,a,o,u)=>e<=o?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall):e>=u?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):(e=(e-o)/(u-o),a?s.beta.cdf(e,t,r):s.beta.pdf(e,t,r)))}betainv(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(e,t,r,a,o)=>a>=o?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.WrongOrder):s.beta.inv(e,t,r)*(o-a)+a)}binomialdist(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(e,t,r,a)=>e>t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),a?s.binomial.cdf(e,t,r):s.binomial.pdf(e,t,r)))}binomialinv(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(e,t,r)=>{let n=-1,i=e=Math.trunc(e);for(;i>n+1;){let a=Math.trunc((n+i)/2);s.binomial.cdf(a,e,t)>=r?i=a:n=a}return i})}besselifn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(e,t)=>(0,a.besseli)(e,Math.trunc(t)))}besseljfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(e,t)=>(0,a.besselj)(e,Math.trunc(t)))}besselkfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(e,t)=>(0,a.besselk)(e,Math.trunc(t)))}besselyfn(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(e,t)=>(0,a.bessely)(e,Math.trunc(t)))}chisqdist(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(e,t,r)=>(t=Math.trunc(t),r?s.chisquare.cdf(e,t):s.chisquare.pdf(e,t)))}chisqdistrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(e,t)=>1-s.chisquare.cdf(e,Math.trunc(t)))}chisqinv(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(e,t)=>s.chisquare.inv(e,Math.trunc(t)))}chisqinvrt(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(e,t)=>s.chisquare.inv(1-e,Math.trunc(t)))}fdist(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(e,t,r,n)=>(t=Math.trunc(t),r=Math.trunc(r),n?s.centralF.cdf(e,t,r):s.centralF.pdf(e,t,r)))}fdistrt(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(e,t,r)=>1-s.centralF.cdf(e,Math.trunc(t),Math.trunc(r)))}finv(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(e,t,r)=>s.centralF.inv(e,Math.trunc(t),Math.trunc(r)))}finvrt(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(e,t,r)=>s.centralF.inv(1-e,Math.trunc(t),Math.trunc(r)))}weibulldist(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(e,t,r,n)=>n?s.weibull.cdf(e,r,t):s.weibull.pdf(e,r,t))}poissondist(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(e,t,r)=>(e=Math.trunc(e),r?s.poisson.cdf(e,t):s.poisson.pdf(e,t)))}hypgeomdist(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(e,t,r,a,o)=>e>t||e>r||t>a||r>a||e+a<r+t?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),r=Math.trunc(r),a=Math.trunc(a),o?s.hypgeom.cdf(e,a,r,t):s.hypgeom.pdf(e,a,r,t)))}tdist(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(e,t,r)=>(t=Math.trunc(t),r?s.studentt.cdf(e,t):s.studentt.pdf(e,t)))}tdist2t(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(e,t)=>2*(1-s.studentt.cdf(e,Math.trunc(t))))}tdistrt(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(e,t)=>1-s.studentt.cdf(e,Math.trunc(t)))}tdistold(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(e,t,r)=>r*(1-s.studentt.cdf(e,Math.trunc(t))))}tinv(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(e,t)=>s.studentt.inv(e,Math.trunc(t)))}tinv2t(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(e,t)=>s.studentt.inv(1-e/2,Math.trunc(t)))}lognormdist(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(e,t,r,n)=>n?s.lognormal.cdf(e,t,r):s.lognormal.pdf(e,t,r))}lognorminv(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(e,t,r)=>s.lognormal.inv(e,t,r))}normdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(e,t,r,n)=>n?s.normal.cdf(e,t,r):s.normal.pdf(e,t,r))}norminv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(e,t,r)=>s.normal.inv(e,t,r))}normsdist(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(e,t)=>t?s.normal.cdf(e,0,1):s.normal.pdf(e,0,1))}normsinv(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),e=>s.normal.inv(e,0,1))}phi(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),e=>s.normal.pdf(e,0,1))}negbinomdist(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(e,t,r,n)=>(e=Math.trunc(e),t=Math.trunc(t),n?s.negbin.cdf(e,t,r):s.negbin.pdf(e,t,r)))}confidencenorm(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(e,t,r)=>(0,s.normalci)(1,e,t,Math.trunc(r))[1]-1)}confidencet(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(e,t,r)=>1===(r=Math.trunc(r))?new n.CellError(n.ErrorType.DIV_BY_ZERO):(0,s.tci)(1,e,t,r)[1]-1)}standardize(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(e,t,r)=>(e-t)/r)}}t.StatisticalPlugin=u,u.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:o.FunctionArgumentType.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:o.FunctionArgumentType.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:o.FunctionArgumentType.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN},{argumentType:o.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:o.FunctionArgumentType.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,defaultValue:0},{argumentType:o.FunctionArgumentType.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,maxValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:o.FunctionArgumentType.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,minValue:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1},{argumentType:o.FunctionArgumentType.NUMBER,minValue:0,maxValue:1},{argumentType:o.FunctionArgumentType.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0,lessThan:1},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0},{argumentType:o.FunctionArgumentType.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,greaterThan:0}]}},u.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"}},function(e,t,r){"use strict";t.__esModule=!0,t.bessely=t.besselk=t.besselj=t.besseli=void 0;var n,i,a,s,o=Math;function u(e,t){for(var r=0,n=0;r<e.length;++r)n=t*n+e[r];return n}function l(e,t,r,n,i){if(0===t)return r;if(1===t)return n;for(var a=2/e,s=n,o=1;o<t;++o)s=n*o*a+i*r,r=n,n=s;return s}function c(e,t,r,n,i){return function(r,a){if(n){if(0===r)return 1==n?-1/0:1/0;if(r<0)return NaN}return 0===a?e(r):1===a?t(r):a<0?NaN:l(r,a|=0,e(r),t(r),i)}}var h,d,p,m,g,f,E,T,y,A,R,N,S=t.besselj=function(){var e=[0xd6759744e,-0x31c78f292,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),t=[0xd675973ab,0x3d5d6d39,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),n=[-.01562499995,1430488765e-13,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function i(i){var a=0,s=0,l=0,c=i*i;if(i<8)a=(s=u(e,c))/(l=u(t,c));else{var h=i-.785398164;s=u(r,c=64/c),l=u(n,c),a=o.sqrt(.636619772/i)*(o.cos(h)*s-o.sin(h)*l*8/i)}return a}var a=[0x10d925ddd8,-0x1d6950b23,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),s=[0x21b24bbb9a,0x891f618a,18583304.74,99447.43394,376.9991397,1].reverse(),c=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),h=[.04687499995,-2002690873e-13,8449199096e-15,-88228987e-14,105787412e-15].reverse();function d(e){var t=0,r=0,n=0,i=e*e,l=o.abs(e)-2.356194491;return 8>Math.abs(e)?t=(r=e*u(a,i))/(n=u(s,i)):(r=u(c,i=64/i),n=u(h,i),t=o.sqrt(.636619772/o.abs(e))*(o.cos(l)*r-o.sin(l)*n*8/o.abs(e)),e<0&&(t=-t)),t}return function e(t,r){if(r=Math.round(r),!isFinite(t))return isNaN(t)?t:0;if(r<0)return(r%2?-1:1)*e(t,-r);if(t<0)return(r%2?-1:1)*e(-t,r);if(0===r)return i(t);if(1===r)return d(t);if(0===t)return 0;var n=0;if(t>r)n=l(t,r,i(t),d(t),-1);else{for(var a=!1,s=0,u=0,c=1,h=0,p=2/t,m=2*o.floor((r+o.floor(o.sqrt(40*r)))/2);m>0;m--)h=m*p*c-s,s=c,c=h,o.abs(c)>1e10&&(c*=1e-10,s*=1e-10,n*=1e-10,u*=1e-10),a&&(u+=c),a=!a,m==r&&(n=s);n/=u=2*u-c}return n}}(),C=(h=[-0xb04cc5cd,0x1a4fa4b91,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),d=[0x954bf890d,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),p=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),m=[-.01562499995,1430488765e-13,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),g=[-4900604943e3,127527439e4,-0xbffb0414e,734926455.1,-4237922.726,8511.937935].reverse(),f=[249958057e5,0x62d2b66f40,0xde8afbbf,22459040.02,102042.605,354.9632885,1].reverse(),E=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),T=[.04687499995,-2002690873e-13,8449199096e-15,-88228987e-14,105787412e-15].reverse(),t.bessely=c(function(e){var t=0,r=0,n=0,i=e*e,a=e-.785398164;return e<8?t=(r=u(h,i))/(n=u(d,i))+.636619772*S(e,0)*o.log(e):(r=u(p,i=64/i),n=u(m,i),t=o.sqrt(.636619772/e)*(o.sin(a)*r+o.cos(a)*n*8/e)),t},function(e){var t=0,r=0,n=0,i=e*e,a=e-2.356194491;return e<8?t=(r=e*u(g,i))/(n=u(f,i))+.636619772*(S(e,1)*o.log(e)-1/e):(r=u(E,i=64/i),n=u(T,i),t=o.sqrt(.636619772/e)*(o.sin(a)*r+o.cos(a)*n*8/e)),t},0,1,-1),y=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),A=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),R=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),N=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),t.besseli=function e(t,r){if(0===(r=Math.round(r)))return t<=3.75?u(y,t*t/14.0625):o.exp(o.abs(t))/o.sqrt(o.abs(t))*u(A,3.75/o.abs(t));if(1===r)return t<3.75?t*u(R,t*t/14.0625):(t<0?-1:1)*o.exp(o.abs(t))/o.sqrt(o.abs(t))*u(N,3.75/o.abs(t));if(r<0)return NaN;if(0===o.abs(t))return 0;if(t==1/0)return 1/0;var n,i=0,a=2/o.abs(t),s=0,l=1,c=0;for(n=2*o.round((r+o.round(o.sqrt(40*r)))/2);n>0;n--)c=n*a*l+s,s=l,l=c,o.abs(l)>1e10&&(l*=1e-10,s*=1e-10,i*=1e-10),n==r&&(i=s);return i*=e(t,0)/l,t<0&&r%2?-i:i});n=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),i=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),a=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),s=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse(),t.besselk=c(function(e){return e<=2?-o.log(e/2)*C(e,0)+u(n,e*e/4):o.exp(-e)/o.sqrt(e)*u(i,2/e)},function(e){return e<=2?o.log(e/2)*C(e,1)+1/e*u(a,e*e/4):o.exp(-e)/o.sqrt(e)*u(s,2/e)},0,2,1)},function(e,t,r){"use strict";function n(e){let t=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-946595344482036e-18,366839497852761e-18,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],r,n,i,a,s=t.length-1,o=!1,u=0,l=0;if(0===e)return 0;for(e<0&&(e=-e,o=!0),n=4*(r=2/(2+e))-2;s>0;s--)i=u,u=n*u-l+t[s],l=i;return a=r*Math.exp(-e*e+.5*(t[0]+n*u)-l),o?a-1:1-a}function i(e){return 1-n(e)}function a(e){let t,r,n,a,s=0;if(e>=2)return -100;if(e<=0)return 100;for(t=-.70711*((2.30753+.27061*(n=Math.sqrt(-2*Math.log((a=e<1?e:2-e)/2))))/(1+n*(.99229+.04481*n))-n);s<2;s++)r=i(t)-a,t+=r/(1.1283791670955126*Math.exp(-t*t)-t*r);return e<1?t:-t}function s(e){let t=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],r=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],n,i,a,s,o=!1,u=0,l=0,c=0,h=e;if(e>171.6243769536076)return 1/0;if(h<=0){if(!(s=h%1))return 1/0;o=(1&h?-1:1)*Math.PI/Math.sin(Math.PI*s),h=1-h}for(a=h,i=h<1?h++:(h-=u=(0|h)-1)-1,n=0;n<8;++n)c=(c+t[n])*i,l=l*i+r[n];if(s=c/l+1,a<h)s/=a;else if(a>h)for(n=0;n<u;++n)s*=h,h++;return o&&(s=o/s),s}function o(e){let t=0,r=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],n,i,a=1.000000000190015;for(i=(n=e)+5.5,i-=(e+.5)*Math.log(i);t<6;t++)a+=r[t]/++n;return Math.log(2.5066282746310007*a/e)-i}function u(e,t){let r,n=o(e),i=e,a=1/e,s=a,u=t+1-e,l=1/1e-30,c=1/u,h=c,d=1,p=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;d<=p;d++)a+=s*=t/++i;return a*Math.exp(-t+e*Math.log(t)-n)}for(;d<=p;d++)u+=2,h*=(c=1/(c=(r=-d*(d-e))*c+u))*(l=u+r/l);return 1-h*Math.exp(-t+e*Math.log(t)-n)}function l(e,t){let r,n,i,a,s,l=0,c=t-1,h=o(t);if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(a=Math.log(c),s=Math.exp(c*(a-1)-h),r=(2.30753+.27061*(n=Math.sqrt(-2*Math.log(e<.5?e:1-e))))/(1+n*(.99229+.04481*n))-n,e<.5&&(r=-r),r=Math.max(.001,t*Math.pow(1-1/(9*t)-r/(3*Math.sqrt(t)),3))):r=e<(n=1-t*(.253+.12*t))?Math.pow(e/n,1/t):1-Math.log(1-(e-n)/(1-n));l<12;l++){if(r<=0)return 0;if(i=(u(t,r)-e)/(n=t>1?s*Math.exp(-(r-c)+c*(Math.log(r)-a)):Math.exp(-r+c*Math.log(r)-h)),(r-=n=i/(1-.5*Math.min(1,i*((t-1)/r-1))))<=0&&(r=.5*(r+n)),Math.abs(n)<1e-8*r)break}return r}t.__esModule=!0,t.chisquare=t.centralF=t.binomial=t.beta=void 0,t.corrcoeff=function(e,t){return F(e,t)/b(e,1)/b(t,1)},t.covariance=F,t.erf=n,t.erfc=i,t.exponential=void 0,t.factorial=A,t.factorialln=y,t.gamma=void 0,t.gammafn=s,t.gammaln=o,t.geomean=function(e){return Math.pow(function(e){for(var t=1,r=e.length;--r>=0;)t*=e[r];return t}(e),1/e.length)},t.lognormal=t.hypgeom=void 0,t.mean=v,t.normal=t.negbin=void 0,t.normalci=function(){var e,t=[].slice.call(arguments),r=[,,];return e=4===t.length?Math.abs(c.inv(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(c.inv(t[1]/2,0,1)*b(t[2])/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.poisson=void 0,t.stdev=b,t.studentt=void 0,t.sumsqerr=I,t.tci=function(){var e,t=[].slice.call(arguments),r=[,,];return e=4===t.length?Math.abs(S.inv(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(S.inv(t[1]/2,t[2].length-1)*b(t[2],!0)/Math.sqrt(t[2].length)),r[0]=t[0]-e,r[1]=t[0]+e,r},t.variance=M,t.weibull=void 0,t.exponential={pdf:(e,t)=>e<0?0:t*Math.exp(-t*e),cdf:(e,t)=>e<0?0:1-Math.exp(-t*e)},t.gamma={pdf:function(e,t,r){return e<0?0:0===e&&1===t?1/r:Math.exp((t-1)*Math.log(e)-e/r-o(t)-t*Math.log(r))},cdf:function(e,t,r){return e<0?0:u(t,e/r)},inv:function(e,t,r){return l(e,t)*r}};let c=t.normal={pdf:function(e,t,r){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(e-t,2)/(2*r*r))},cdf:function(e,t,r){return .5*(1+n((e-t)/Math.sqrt(2*r*r)))},inv:function(e,t,r){return -1.4142135623730951*r*a(2*e)+t}};function h(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(d(e,t)):s(e)*s(t)/s(e+t)}function d(e,t){return o(e)+o(t)-o(e+t)}function p(e,t,r){var n,i,a,s,u,l,c,h,d,p=t-1,g=r-1,f=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&r>=1?(u=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(e<.5?e:1-e))))/(1+a*(.99229+.04481*a))-a,e<.5&&(u=-u),l=(u*u-3)/6,h=u*Math.sqrt(l+(c=2/(1/(2*t-1)+1/(2*r-1))))/c-(1/(2*r-1)-1/(2*t-1))*(l+5/6-2/(3*c)),u=t/(t+r*Math.exp(2*h))):(n=Math.log(t/(t+r)),i=Math.log(r/(t+r)),u=e<(a=Math.exp(t*n)/t)/(h=a+(s=Math.exp(r*i)/r))?Math.pow(t*h*e,1/t):1-Math.pow(r*h*(1-e),1/r)),d=-o(t)-o(r)+o(t+r);f<10&&!(0===u||1===u||((u-=a=(s=(m(u,t,r)-e)/(a=Math.exp(p*Math.log(u)+g*Math.log(1-u)+d)))/(1-.5*Math.min(1,s*(p/u-g/(1-u)))))<=0&&(u=.5*(u+a)),u>=1&&(u=.5*(u+a+1)),Math.abs(a)<1e-8*u&&f>0));f++);return u}function m(e,t,r){var n=0===e||1===e?0:Math.exp(o(t+r)-o(t)-o(r)+t*Math.log(e)+r*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+r+2)?n*g(e,t,r)/t:1-n*g(1-e,r,t)/r)}function g(e,t,r){var n,i,a,s,o=1,u=t+r,l=t+1,c=t-1,h=1,d=1-u*e/l;for(1e-30>Math.abs(d)&&(d=1e-30),s=d=1/d;o<=100&&(1e-30>Math.abs(d=1+(i=o*(r-o)*e/((c+(n=2*o))*(t+n)))*d)&&(d=1e-30),1e-30>Math.abs(h=1+i/h)&&(h=1e-30),s*=(d=1/d)*h,1e-30>Math.abs(d=1+(i=-(t+o)*(u+o)*e/((t+n)*(l+n)))*d)&&(d=1e-30),1e-30>Math.abs(h=1+i/h)&&(h=1e-30),s*=a=(d=1/d)*h,!(3e-7>Math.abs(a-1)));o++);return s}t.beta={pdf:function(e,t,r){return e>1||e<0?0:1==t&&1==r?1:t<512&&r<512?Math.pow(e,t-1)*Math.pow(1-e,r-1)/h(t,r):Math.exp((t-1)*Math.log(e)+(r-1)*Math.log(1-e)-d(t,r))},cdf:function(e,t,r){return e>1||e<0?+(e>1):m(e,t,r)},inv:function(e,t,r){return p(e,t,r)}};let f=t.binomial={pdf:function(e,t,r){return 0===r||1===r?+(t*r===e):T(t,e)*Math.pow(r,e)*Math.pow(1-r,t-e)},cdf:function(e,t,r){if(e<0)return 0;if(e>=t)return 1;if(r<0||r>1||t<=0)return NaN;var n=(e=Math.floor(e))+1,i=t-e,a=n+i,s=Math.exp(o(a)-o(i)-o(n)+n*Math.log(r)+i*Math.log(1-r));return Math.round(1/1e-10*(1-(r<(n+1)/(a+2)?s*E(r,n,i,1e-10):1-s*E(1-r,i,n,1e-10))))/(1/1e-10)}};function E(e,t,r,n){for(var i,a=0,s=1,o=1,u=1,l=0,c=0;Math.abs((o-c)/o)>n;)c=o,s=u+(i=-(t+l)*(t+r+l)*e/(t+2*l)/(t+2*l+1))*s,o=(a=o+i*a)+(i=(l+=1)*(r-l)*e/(t+2*l-1)/(t+2*l))*o,a/=u=s+i*u,s/=u,o/=u,u=1;return o/t}function T(e,t){return e>170||t>170?Math.exp(y(e)-y(t)-y(e-t)):A(e)/A(t)/A(e-t)}function y(e){return e<0?NaN:o(e+1)}function A(e){return e<0?NaN:s(e+1)}t.chisquare={pdf:function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-o(t/2))},cdf:function(e,t){return e<0?0:u(t/2,e/2)},inv:function(e,t){return 2*l(e,.5*t)}},t.centralF={pdf:function(e,t,r){var n;return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/h(t/2,r/2)*Math.pow(t/r,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/r*e,-(t+r)/2):(n=t*e/(r+e*t),r/(r+e*t)*t/2*f.pdf((t-2)/2,(t+r-2)/2,n))},cdf:function(e,t,r){return e<0?0:m(t*e/(t*e+r),t/2,r/2)},inv:function(e,t,r){return r/(t*(1/p(e,t/2,r/2)-1))}},t.weibull={pdf:function(e,t,r){return e<0||t<0||r<0?0:r/t*Math.pow(e/t,r-1)*Math.exp(-Math.pow(e/t,r))},cdf:function(e,t,r){return e<0?0:1-Math.exp(-Math.pow(e/t,r))}};let R=t.poisson={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/A(e)},cdf:function(e,t){var r=0;if(e<0)return 0;for(var n=0;r<=e;r++)n+=R.pdf(r,t);return n}},N=t.hypgeom={pdf:function(e,t,r,n){if(e<0||e<r-(t-n)||e>n||e>r)return 0;if(2*r>t)return 2*n>t?N.pdf(t-r-n+e,t,t-r,t-n):N.pdf(n-e,t,t-r,n);if(2*n>t)return N.pdf(r-e,t,r,t-n);if(r<n)return N.pdf(e,t,n,r);for(var i=1,a=0,s=0;s<e;s++){for(;i>1&&a<n;)i*=1-r/(t-a),a++;i*=(n-s)*(r-s)/((s+1)*(t-r-n+s+1))}for(;a<n;a++)i*=1-r/(t-a);return Math.min(1,Math.max(0,i))},cdf:function e(t,r,n,i){if(t<0||t<n-(r-i))return 0;if(t>=i||t>=n)return 1;if(2*n>r)return 2*i>r?e(r-n-i+t,r,r-n,r-i):1-N.cdf(i-t-1,r,r-n,i);if(2*i>r)return 1-N.cdf(n-t-1,r,n,r-i);if(n<i)return N.cdf(t,r,i,n);for(var a=1,s=1,o=0,u=0;u<t;u++){for(;a>1&&o<i;){var l=1-n/(r-o);s*=l,a*=l,o++}a+=s*=(i-u)*(n-u)/((u+1)*(r-n-i+u+1))}for(;o<i;o++)a*=1-n/(r-o);return Math.min(1,Math.max(0,a))}},S=t.studentt={pdf:function(e,t){return 1/(Math.sqrt(t=t>1e100?1e100:t)*h(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},cdf:function(e,t){var r=t/2;return m((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),r,r)},inv:function(e,t){var r=p(2*Math.min(e,1-e),.5*t,.5);return r=Math.sqrt(t*(1-r)/r),e>.5?r:-r}},C=(t.lognormal={pdf:function(e,t,r){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(r)-Math.pow(Math.log(e)-t,2)/(2*r*r))},cdf:function(e,t,r){return e<0?0:.5+.5*n((Math.log(e)-t)/Math.sqrt(2*r*r))},inv:function(e,t,r){return Math.exp(-1.4142135623730951*r*a(2*e)+t)}},t.negbin={pdf:function(e,t,r){return e===e>>>0&&(e<0?0:T(e+t-1,t-1)*Math.pow(1-r,e)*Math.pow(r,t))},cdf:function(e,t,r){var n=0,i=0;if(e<0)return 0;for(;i<=e;i++)n+=C.pdf(i,t,r);return n}});function O(e){for(var t=0,r=e.length;--r>=0;)t+=e[r];return t}function v(e){return O(e)/e.length}function I(e){for(var t,r=v(e),n=0,i=e.length;--i>=0;)n+=(t=e[i]-r)*t;return n}function M(e,t){return I(e)/(e.length-!!t)}function b(e,t){return Math.sqrt(M(e,t))}function F(e,t){var r,n=v(e),i=v(t),a=e.length,s=Array(a);for(r=0;r<a;r++)s[r]=(e[r]-n)*(t[r]-i);return O(s)/(a-1)}},function(e,t,r){"use strict";t.__esModule=!0,t.MathPlugin=void 0;var n=r(73),i=r(131),a=r(167);class s extends a.FunctionPlugin{fact(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),e=>{e=Math.trunc(e);let t=1;for(let r=1;r<=e;r++)t*=r;return t})}factdouble(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),e=>{let t=1;for(let r=e=Math.trunc(e);r>=1;r-=2)t*=r;return t})}combin(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(e,t)=>t>e?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.WrongOrder):o(e=Math.trunc(e),t=Math.trunc(t)))}combina(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(e,t)=>(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):0===e&&0===t?1:o(e+t-1,t))}gcd(e,t){return this.runFunction(e.args,t,this.metadata("GCD"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof n.CellError)return t;let r=0;for(let e of t){if(e<0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);r=u(r,Math.trunc(e))}return r>Number.MAX_SAFE_INTEGER?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):r})}lcm(e,t){return this.runFunction(e.args,t,this.metadata("LCM"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(e);if(t instanceof n.CellError)return t;let r=1;for(let e of t){var a,s;if(e<0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);a=r,s=Math.trunc(e),r=0===a||0===s?0:a*(s/u(a,s))}return r>Number.MAX_SAFE_INTEGER?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueLarge):r})}mround(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(e,t)=>0===t?0:e>0&&t<0||e<0&&t>0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.DistinctSigns):Math.round(e/t)*t)}multinomial(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(...e)=>{let t=0,r=1;for(let a of e){if(a<0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);a=Math.trunc(a);for(let e=1;e<=a;e++)r*=(t+e)/e;t+=a}return Math.round(r)})}quotient(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(e,t)=>0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.trunc(e/t))}seriessum(e,t){return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(e,t,r,i)=>{let a=this.arithmeticHelper.manyToOnlyNumbersDropNulls(i.valuesFromTopLeftCorner());if(a instanceof n.CellError)return a;let s=0;for(let t of(a.reverse(),a))s*=Math.pow(e,r),s+=t;return s*Math.pow(e,t)})}sign(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),e=>e>0?1:e<0?-1:0)}sumx2my2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(e,t)=>{let r=e.valuesFromTopLeftCorner(),a=t.valuesFromTopLeftCorner();if(r.length!==a.length)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let s=r.length,o=0;for(let e=0;e<s;e++){let t=r[e],i=a[e];if(t instanceof n.CellError)return t;if(i instanceof n.CellError)return i;"number"==typeof t&&"number"==typeof i&&(o+=Math.pow(t,2)-Math.pow(i,2))}return o})}sumx2py2(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(e,t)=>{let r=e.valuesFromTopLeftCorner(),a=t.valuesFromTopLeftCorner();if(r.length!==a.length)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let s=r.length,o=0;for(let e=0;e<s;e++){let t=r[e],i=a[e];if(t instanceof n.CellError)return t;if(i instanceof n.CellError)return i;"number"==typeof t&&"number"==typeof i&&(o+=Math.pow(t,2)+Math.pow(i,2))}return o})}sumxmy2(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(e,t)=>{let r=e.valuesFromTopLeftCorner(),a=t.valuesFromTopLeftCorner();if(r.length!==a.length)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let s=r.length,o=0;for(let e=0;e<s;e++){let t=r[e],i=a[e];if(t instanceof n.CellError)return t;if(i instanceof n.CellError)return i;"number"==typeof t&&"number"==typeof i&&(o+=Math.pow(t-i,2))}return o})}}function o(e,t){2*t>e&&(t=e-t);let r=1;for(let n=1;n<=t;n++)r*=(e-t+n)/n;return Math.round(r)}function u(e,t){for(e<t&&([e,t]=[t,e]);t>0;)[e,t]=[t,e%t];return e}t.MathPlugin=s,s.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0,lessThan:1030},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:a.FunctionArgumentType.NUMBER,minValue:0},{argumentType:a.FunctionArgumentType.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:a.FunctionArgumentType.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.NUMBER},{argumentType:a.FunctionArgumentType.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:a.FunctionArgumentType.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:a.FunctionArgumentType.RANGE},{argumentType:a.FunctionArgumentType.RANGE}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.ComplexPlugin=void 0;var n=r(73),i=r(131),a=r(168),s=r(167);class o extends s.FunctionPlugin{complex(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(e,t,r)=>"i"!==r&&"j"!==r?new n.CellError(n.ErrorType.VALUE,i.ErrorMessage.ShouldBeIorJ):(0,a.coerceComplexToString)([e,t],r))}imabs(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),g)}imaginary(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),([e,t])=>t)}imreal(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),([e,t])=>e)}imargument(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),([e,t])=>0===e&&0===t?new n.CellError(n.ErrorType.DIV_BY_ZERO):Math.atan2(t,e))}imconjugate(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),([e,t])=>(0,a.coerceComplexToString)([e,-t]))}imcos(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),e=>(0,a.coerceComplexToString)(c(e)))}imcosh(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),e=>(0,a.coerceComplexToString)(h(e)))}imcot(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),e=>(0,a.coerceComplexToString)(l(c(e),d(e))))}imcsc(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),e=>(0,a.coerceComplexToString)(l([1,0],d(e))))}imcsch(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),e=>(0,a.coerceComplexToString)(l([1,0],p(e))))}imsec(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),e=>(0,a.coerceComplexToString)(l([1,0],c(e))))}imsech(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),e=>(0,a.coerceComplexToString)(l([1,0],h(e))))}imsin(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),e=>(0,a.coerceComplexToString)(d(e)))}imsinh(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),e=>(0,a.coerceComplexToString)(p(e)))}imtan(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),e=>(0,a.coerceComplexToString)(l(d(e),c(e))))}imdiv(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(e,t)=>(0,a.coerceComplexToString)(l(e,t)))}improduct(e,t){return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(...e)=>{let t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof n.CellError)return t;let r=[1,0];for(let e of t)r=u(r,e);return(0,a.coerceComplexToString)(r)})}imsum(e,t){return this.runFunction(e.args,t,this.metadata("IMSUM"),(...e)=>{let t=this.arithmeticHelper.coerceComplexExactRanges(e);if(t instanceof n.CellError)return t;let r=[0,0];for(let e of t)r=function([e,t],[r,n]){return[e+r,t+n]}(r,e);return(0,a.coerceComplexToString)(r)})}imsub(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(e,t)=>(0,a.coerceComplexToString)(function([e,t],[r,n]){return[e-r,t-n]}(e,t)))}imexp(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),e=>(0,a.coerceComplexToString)(m(e)))}imln(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),e=>(0,a.coerceComplexToString)(f(e)))}imlog10(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),e=>{let[t,r]=f(e),n=Math.log(10);return(0,a.coerceComplexToString)([t/n,r/n])})}imlog2(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),e=>{let[t,r]=f(e),n=Math.log(2);return(0,a.coerceComplexToString)([t/n,r/n])})}impower(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(e,t)=>(0,a.coerceComplexToString)(E(e,t)))}imsqrt(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),e=>(0,a.coerceComplexToString)(E(e,.5)))}}function u([e,t],[r,n]){return[e*r-t*n,e*n+r*t]}function l([e,t],[r,n]){let i=Math.pow(r,2)+Math.pow(n,2),[a,s]=u([e,t],[r,-n]);return[a/i,s/i]}function c([e,t]){return[Math.cos(e)*Math.cosh(t),-Math.sin(e)*Math.sinh(t)]}function h([e,t]){return[Math.cosh(e)*Math.cos(t),Math.sinh(e)*Math.sin(t)]}function d([e,t]){return[Math.sin(e)*Math.cosh(t),Math.cos(e)*Math.sinh(t)]}function p([e,t]){return[Math.sinh(e)*Math.cos(t),Math.cosh(e)*Math.sin(t)]}function m([e,t]){return[Math.exp(e)*Math.cos(t),Math.exp(e)*Math.sin(t)]}function g([e,t]){return Math.sqrt(e*e+t*t)}function f([e,t]){return[Math.log(g([e,t])),Math.atan2(t,e)]}function E(e,t){let[r,n]=f(e);return m([t*r,t*n])}t.ComplexPlugin=o,o.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.NUMBER},{argumentType:s.FunctionArgumentType.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX},{argumentType:s.FunctionArgumentType.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:s.FunctionArgumentType.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX},{argumentType:s.FunctionArgumentType.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX},{argumentType:s.FunctionArgumentType.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:s.FunctionArgumentType.COMPLEX}]}}},function(e,t,r){"use strict";t.__esModule=!0,t.StatisticalAggregationPlugin=void 0,r(2);var n=r(73),i=r(131),a=r(140),s=r(262),o=r(167);class u extends o.FunctionPlugin{avedev(e,t){return this.runFunction(e.args,t,this.metadata("AVEDEV"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let r=(0,s.mean)(t);return t.reduce((e,t)=>e+Math.abs(t-r),0)/t.length})}devsq(e,t){return this.runFunction(e.args,t,this.metadata("DEVSQ"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);return t instanceof n.CellError?t:0===t.length?0:(0,s.sumsqerr)(t)})}geomean(e,t){return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.OneValue);for(let e of t)if(e<=0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);return(0,s.geomean)(t)})}harmean(e,t){return this.runFunction(e.args,t,this.metadata("HARMEAN"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;if(0===t.length)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.OneValue);for(let e of t)if(e<=0)return new n.CellError(n.ErrorType.NUM,i.ErrorMessage.ValueSmall);return t.length/t.reduce((e,t)=>e+1/t,0)})}correl(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues):(0,s.corrcoeff)(r[0],r[1])})}rsq(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues):Math.pow((0,s.corrcoeff)(r[0],r[1]),2)})}covariancep(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);if(r instanceof n.CellError)return r;let a=r[0].length;return a<1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.OneValue):1===a?0:(0,s.covariance)(r[0],r[1])*(a-1)/a})}covariances(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);return r instanceof n.CellError?r:r[0].length<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues):(0,s.covariance)(r[0],r[1])})}ztest(e,t){return this.runFunction(e.args,t,this.metadata("Z.TEST"),(e,t,r)=>{let a=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(a instanceof n.CellError)return a;let o=a.length;if(void 0===r){if(o<2)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues);r=(0,s.stdev)(a,!0)}return o<1?new n.CellError(n.ErrorType.NA,i.ErrorMessage.OneValue):0===r?new n.CellError(n.ErrorType.DIV_BY_ZERO):1-s.normal.cdf(((0,s.mean)(a)-t)/(r/Math.sqrt(o)),0,1)})}ftest(e,t){return this.runFunction(e.args,t,this.metadata("F.TEST"),(e,t)=>{let r=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),i=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof n.CellError)return r;if(i instanceof n.CellError)return i;if(r.length<=1||i.length<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let a=(0,s.variance)(r,!0),o=(0,s.variance)(i,!0);if(0===a||0===o)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let u=s.centralF.cdf(a/o,r.length-1,i.length-1);return 2*Math.min(u,1-u)})}steyx(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);if(r instanceof n.CellError)return r;let a=r[0].length;return a<=2?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.ThreeValues):Math.sqrt(((0,s.sumsqerr)(r[0])-Math.pow((0,s.covariance)(r[0],r[1])*(a-1),2)/(0,s.sumsqerr)(r[1]))/(a-2))})}slope(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(e,t)=>{if(e.numberOfElements()!==t.numberOfElements())return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let r=l(e,t);if(r instanceof n.CellError)return r;let a=r[0].length;return a<=1?new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues):(0,s.covariance)(r[0],r[1])*(a-1)/(0,s.sumsqerr)(r[1])})}chisqtest(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(e,t)=>{let r=e.height(),a=e.width();if(t.height()!==r||t.width()!==a)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);let o=l(e,t);if(o instanceof n.CellError)return o;if(o[0].length<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues);let u=0;for(let e=0;e<o[0].length;e++){if(0===o[1][e])return new n.CellError(n.ErrorType.DIV_BY_ZERO);u+=Math.pow(o[0][e]-o[1][e],2)/o[1][e]}return u<0?new n.CellError(n.ErrorType.NUM,i.ErrorMessage.NaN):1-s.chisquare.cdf(u,r>1&&a>1?(r-1)*(a-1):r*a-1)})}ttest(e,t){return this.runFunction(e.args,t,this.metadata("T.TEST"),(e,t,r,a)=>{let o=this.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),u=this.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(o instanceof n.CellError)return o;if(u instanceof n.CellError)return u;let l=o.length,c=u.length;if(1===a){if(c!==l)return new n.CellError(n.ErrorType.NA,i.ErrorMessage.EqualLength);if(l<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues);let e=Array(l);for(let t=0;t<l;t++)e[t]=o[t]-u[t];let t=(0,s.stdev)(e,!0);if(0===t)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let a=Math.abs(Math.sqrt(l)*(0,s.mean)(e)/t);return r*(1-s.studentt.cdf(a,l-1))}if(2===a){if(l<=1||c<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues);let e=((0,s.sumsqerr)(o)+(0,s.sumsqerr)(u))/(l+c-2);if(0===e)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let t=Math.abs(((0,s.mean)(o)-(0,s.mean)(u))/Math.sqrt(e*(1/l+1/c)));return r*(1-s.studentt.cdf(t,l+c-2))}{if(l<=1||c<=1)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.TwoValues);let e=(0,s.variance)(o,!0),t=(0,s.variance)(u,!0);if(0===e&&0===t)return new n.CellError(n.ErrorType.DIV_BY_ZERO);let a=Math.abs(((0,s.mean)(o)-(0,s.mean)(u))/Math.sqrt(e/l+t/c)),h=Math.pow(e/l+t/c,2)/(Math.pow(e/l,2)/(l-1)+Math.pow(t/c,2)/(c-1));return r*(1-s.studentt.cdf(a,h))}})}skew(e,t){return this.runFunction(e.args,t,this.metadata("SKEW"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;let r=t.length;if(r<3)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.ThreeValues);let a=(0,s.mean)(t),o=(0,s.stdev)(t,!0);return 0===o?new n.CellError(n.ErrorType.DIV_BY_ZERO):t.reduce((e,t)=>e+Math.pow((t-a)/o,3),0)*r/(r-1)/(r-2)})}skewp(e,t){return this.runFunction(e.args,t,this.metadata("SKEW.P"),(...e)=>{let t=this.arithmeticHelper.coerceNumbersExactRanges(e);if(t instanceof n.CellError)return t;let r=t.length;if(r<3)return new n.CellError(n.ErrorType.DIV_BY_ZERO,i.ErrorMessage.ThreeValues);let a=(0,s.mean)(t),o=(0,s.stdev)(t,!1);return 0===o?new n.CellError(n.ErrorType.DIV_BY_ZERO):t.reduce((e,t)=>e+Math.pow((t-a)/o,3),0)/r})}}function l(e,t){let r,i,s=e.iterateValuesFromTopLeftCorner(),o=t.iterateValuesFromTopLeftCorner(),u=[],l=[];for(;r=s.next(),i=o.next(),!r.done&&!i.done;){let e=r.value,t=i.value;if(e instanceof n.CellError)return e;if(t instanceof n.CellError)return t;(0,a.isExtendedNumber)(e)&&(0,a.isExtendedNumber)(t)&&(u.push((0,a.getRawValue)(e)),l.push((0,a.getRawValue)(t)))}return[u,l]}t.StatisticalAggregationPlugin=u,u.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.NUMBER},{argumentType:o.FunctionArgumentType.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.RANGE},{argumentType:o.FunctionArgumentType.INTEGER,minValue:1,maxValue:2},{argumentType:o.FunctionArgumentType.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:o.FunctionArgumentType.ANY}],repeatLastArgs:1}},u.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"}}]).default});
//# sourceMappingURL=buy_or_rent.bf328fb2.js.map
